
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>FrEIA.modules package &#8212; FrEIA v0.2 documentation</title>
    
  <link rel="stylesheet" href="_static/css/index.f658d18f9b420779cfdf24aa0a7e2d77.css">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/basic.css" type="text/css" />
    
  <link rel="preload" as="script" href="_static/js/index.d3f166471bb80abb5163.js">

    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="FrEIA.framework package" href="FrEIA.framework.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <nav class="navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main">
<div class="container-xl">

    <a class="navbar-brand" href="index.html">
    
      <p class="title">FrEIA</p>
    
    </a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-menu" aria-controls="navbar-menu" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar-menu" class="col-lg-9 collapse navbar-collapse">
      <ul id="navbar-main-elements" class="navbar-nav mr-auto">
        
        
        <li class="nav-item ">
            <a class="nav-link" href="FrEIA.framework.html">FrEIA.framework package</a>
        </li>
        
        <li class="nav-item active">
            <a class="nav-link" href="">FrEIA.modules package</a>
        </li>
        
        
      </ul>


      

      <ul class="navbar-nav">
        
        
      </ul>
    </div>
</div>
    </nav>
    

    <div class="container-xl">
      <div class="row">
          
          <div class="col-12 col-md-3 bd-sidebar"><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form>
<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">

    <div class="bd-toc-item active">
    
  
    <ul class="nav bd-sidenav">
        
        
        
        
          
        
        
      </ul>
  
  </nav>
          </div>
          

          
          <div class="d-none d-xl-block col-xl-2 bd-toc">
              
<div class="tocsection onthispage pt-5 pb-3">
    <i class="fas fa-list"></i> On this page
</div>

<nav id="bd-toc-nav">
    <ul class="nav section-nav flex-column">
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#abstract-template" class="nav-link">Abstract template</a>
        </li>
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#coupling-blocks" class="nav-link">Coupling blocks</a>
        </li>
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#other-learned-transforms" class="nav-link">Other learned transforms</a>
        </li>
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#fixed-non-learned-transforms" class="nav-link">Fixed (non-learned) transforms</a>
        </li>
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#graph-topology" class="nav-link">Graph topology</a>
        </li>
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#reshaping" class="nav-link">Reshaping</a>
        </li>
    
    </ul>
</nav>


              
          </div>
          

          
          <main class="col-12 col-md-9 col-xl-7 py-md-5 pl-md-5 pr-md-4 bd-content" role="main">
              
              <div>
                
  <div class="section" id="module-FrEIA.modules">
<span id="freia-modules-package"></span><h1>FrEIA.modules package<a class="headerlink" href="#module-FrEIA.modules" title="Permalink to this headline">¶</a></h1>
<p>Subclasses of torch.nn.Module, that are reversible and can be used in the
nodes of the GraphINN class. The only additional things that are
needed compared to the base class is an &#64;staticmethod otuput_dims, and the
‘rev’-argument of the forward-method.</p>
<p>Abstract template:</p>
<ul class="simple">
<li><p>InvertibleModule</p></li>
</ul>
<p>Coupling blocks:</p>
<ul class="simple">
<li><p>InvertibleModule</p></li>
<li><p>AllInOneBlock</p></li>
<li><p>NICECouplingBlock</p></li>
<li><p>RNVPCouplingBlock</p></li>
<li><p>GLOWCouplingBlock</p></li>
<li><p>GINCouplingBlock</p></li>
<li><p>AffineCouplingOneSided</p></li>
<li><p>ConditionalAffineTransform</p></li>
</ul>
<p>Other learned transforms:</p>
<ul class="simple">
<li><p>ActNorm</p></li>
<li><p>IResNetLayer</p></li>
<li><p>InvAutoAct</p></li>
<li><p>InvAutoActFixed</p></li>
<li><p>InvAutoActTwoSided</p></li>
<li><p>InvAutoConv2D</p></li>
<li><p>InvAutoFC</p></li>
<li><p>LearnedElementwiseScaling</p></li>
<li><p>OrthogonalTransform</p></li>
<li><p>HouseholderPerm</p></li>
</ul>
<p>Fixed (non-learned) transforms:</p>
<ul class="simple">
<li><p>PermuteRandom</p></li>
<li><p>FixedLinearTransform</p></li>
<li><p>Fixed1x1Conv</p></li>
</ul>
<p>Graph topology:</p>
<ul class="simple">
<li><p>SplitChannel</p></li>
<li><p>ConcatChannel</p></li>
<li><p>Split1D</p></li>
<li><p>Concat1d</p></li>
</ul>
<p>Reshaping:</p>
<ul class="simple">
<li><p>IRevNetDownsampling</p></li>
<li><p>IRevNetUpsampling</p></li>
<li><p>HaarDownsampling</p></li>
<li><p>HaarUpsampling’,</p></li>
<li><p>Flatten</p></li>
<li><p>Reshape</p></li>
</ul>
<dl class="py class">
<dt id="FrEIA.modules.ActNorm">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">FrEIA.modules.</span></code><code class="sig-name descname"><span class="pre">ActNorm</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dims_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dims_c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/invertible_resnet.html#ActNorm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#FrEIA.modules.ActNorm" title="Permalink to this definition">¶</a></dt>
<dd><dl class="py method">
<dt id="FrEIA.modules.ActNorm.__init__">
<code class="sig-name descname"><span class="pre">__init__</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dims_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dims_c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/invertible_resnet.html#ActNorm.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#FrEIA.modules.ActNorm.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Parameters:
dims_in: list of tuples specifying the shape of the inputs to this</p>
<blockquote>
<div><p>operator: dims_in = [shape_x_0, shape_x_1, …]</p>
</div></blockquote>
<dl class="simple">
<dt>dims_c:  list of tuples specifying the shape of the conditions to</dt><dd><p>this operator.</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="FrEIA.modules.ActNorm.__module__">
<code class="sig-name descname"><span class="pre">__module__</span></code><em class="property"> <span class="pre">=</span> <span class="pre">'FrEIA.modules.invertible_resnet'</span></em><a class="headerlink" href="#FrEIA.modules.ActNorm.__module__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="FrEIA.modules.ActNorm.forward">
<code class="sig-name descname"><span class="pre">forward</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jac</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/invertible_resnet.html#ActNorm.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#FrEIA.modules.ActNorm.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform a forward (default, <cite>rev=False</cite>) or backward pass (<cite>rev=True</cite>)
through this module/operator.</p>
<p><em>Note to implementers:</em>
- Subclasses MUST return a Jacobian when jac=True, but CAN return a</p>
<blockquote>
<div><p>valid Jacobian when jac=False (not punished). The latter is only recommended
if the computation of the Jacobian is trivial.</p>
</div></blockquote>
<ul class="simple">
<li><p>Subclasses MUST follow the convention that the returned Jacobian be
consistent with the evaluation direction. Let’s make this more precise:
Let $f$ be the function that the subclass represents. Then:
$$$
J = log det</p></li>
</ul>
<dl class="simple">
<dt>rac{partial f}{partial x} </dt><dd><p>-J = log det</p>
</dd>
<dt>rac{partial f^{-1}}{partial z}.</dt><dd><p>$$$
Any subclass MUST return $J$ for forward evaluation (<cite>rev=False</cite>),
and $-J$ for backward evaluation (<cite>rev=True</cite>).</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x_or_z</strong> – input data (array-like of one or more tensors)</p></li>
<li><p><strong>c</strong> – conditioning data (array-like of none or more tensors)</p></li>
<li><p><strong>rev</strong> – perform backward pass</p></li>
<li><p><strong>jac</strong> – return Jacobian associated to the direction</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="FrEIA.modules.ActNorm.initialize_with_data">
<code class="sig-name descname"><span class="pre">initialize_with_data</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/invertible_resnet.html#ActNorm.initialize_with_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#FrEIA.modules.ActNorm.initialize_with_data" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="FrEIA.modules.ActNorm.output_dims">
<code class="sig-name descname"><span class="pre">output_dims</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_dims</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/invertible_resnet.html#ActNorm.output_dims"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#FrEIA.modules.ActNorm.output_dims" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="FrEIA.modules.ActNorm.training">
<code class="sig-name descname"><span class="pre">training</span></code><em class="property"><span class="pre">:</span> <span class="pre">bool</span></em><a class="headerlink" href="#FrEIA.modules.ActNorm.training" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="FrEIA.modules.AffineCouplingOneSided">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">FrEIA.modules.</span></code><code class="sig-name descname"><span class="pre">AffineCouplingOneSided</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dims_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dims_c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subnet_constructor</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Callable</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clamp</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">2.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clamp_activation</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span> </span><span class="pre">Callable</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">'ATAN'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/coupling_layers.html#AffineCouplingOneSided"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#FrEIA.modules.AffineCouplingOneSided" title="Permalink to this definition">¶</a></dt>
<dd><p>Half of a coupling block following the GLOWCouplingBlock design.  This
means only one affine transformation on half the inputs.  In the case where
random permutations or orthogonal transforms are used after every block,
this is not a restriction and simplifies the design.</p>
<dl class="py method">
<dt id="FrEIA.modules.AffineCouplingOneSided.__init__">
<code class="sig-name descname"><span class="pre">__init__</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dims_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dims_c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subnet_constructor</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Callable</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clamp</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">2.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clamp_activation</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span> </span><span class="pre">Callable</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">'ATAN'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/coupling_layers.html#AffineCouplingOneSided.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#FrEIA.modules.AffineCouplingOneSided.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Additional args in docstring of base class.
:param subnet_constructor: function or class, with signature</p>
<blockquote>
<div><p>constructor(dims_in, dims_out).  The result should be a torch
nn.Module, that takes dims_in input channels, and dims_out output
channels. See tutorial for examples. One subnetwork will be
initialized in the block.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>clamp</strong> – Soft clamping for the multiplicative component. The
amplification or attenuation of each input dimension can be at most
exp(±clamp).</p></li>
<li><p><strong>clamp_activation</strong> – Function to perform the clamping. String values
“ATAN”, “TANH”, and “SIGMOID” are recognized, or a function of
object can be passed. TANH behaves like the original realNVP paper.
A custom function should take tensors and map -inf to -1 and +inf to +1.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="FrEIA.modules.AffineCouplingOneSided.__module__">
<code class="sig-name descname"><span class="pre">__module__</span></code><em class="property"> <span class="pre">=</span> <span class="pre">'FrEIA.modules.coupling_layers'</span></em><a class="headerlink" href="#FrEIA.modules.AffineCouplingOneSided.__module__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="FrEIA.modules.AffineCouplingOneSided.forward">
<code class="sig-name descname"><span class="pre">forward</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jac</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/coupling_layers.html#AffineCouplingOneSided.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#FrEIA.modules.AffineCouplingOneSided.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>See base class docstring</p>
</dd></dl>

<dl class="py attribute">
<dt id="FrEIA.modules.AffineCouplingOneSided.training">
<code class="sig-name descname"><span class="pre">training</span></code><em class="property"><span class="pre">:</span> <span class="pre">bool</span></em><a class="headerlink" href="#FrEIA.modules.AffineCouplingOneSided.training" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="FrEIA.modules.AllInOneBlock">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">FrEIA.modules.</span></code><code class="sig-name descname"><span class="pre">AllInOneBlock</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dims_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dims_c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subnet_constructor</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Callable</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">affine_clamping</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">2.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gin_block</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">global_affine_init</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">global_affine_type</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">'SOFTPLUS'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">permute_soft</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">learned_householder_permutation</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reverse_permutation</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/all_in_one_block.html#AllInOneBlock"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#FrEIA.modules.AllInOneBlock" title="Permalink to this definition">¶</a></dt>
<dd><p>Module combining the most common operations in a normalizing flow or similar model.</p>
<p>It combines affine coupling, permutation, and global affine transformation
(‘ActNorm’). It can also be used as GIN coupling block, perform learned
householder permutations, and use an inverted pre-permutation (see
constructor docstring for details).</p>
<dl class="py method">
<dt id="FrEIA.modules.AllInOneBlock.__init__">
<code class="sig-name descname"><span class="pre">__init__</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dims_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dims_c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subnet_constructor</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Callable</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">affine_clamping</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">2.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gin_block</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">global_affine_init</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">global_affine_type</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">'SOFTPLUS'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">permute_soft</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">learned_householder_permutation</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reverse_permutation</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/all_in_one_block.html#AllInOneBlock.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#FrEIA.modules.AllInOneBlock.__init__" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>subnet_constructor</strong> – class or callable f, called as f(channels_in, channels_out) and
should return a torch.nn.Module</p></li>
<li><p><strong>affine_clamping</strong> – clamp the output of the multiplicative coefficients (before
exponentiation) to +/- affine_clamping.</p></li>
<li><p><strong>gin_block</strong> – Turn the block into a GIN block from Sorrenson et al, 2019</p></li>
<li><p><strong>global_affine_init</strong> – Initial value for the global affine scaling beta</p></li>
<li><p><strong>global_affine_init</strong> – ‘SIGMOID’, ‘SOFTPLUS’, or ‘EXP’. Defines the activation to be used
on the beta for the global affine scaling.</p></li>
<li><p><strong>permute_soft</strong> – bool, whether to sample the permutation matrices from SO(N), or to
use hard permutations in stead. Note, permute_soft=True is very slow
when working with &gt;512 dimensions.</p></li>
<li><p><strong>learned_householder_permutation</strong> – Int, if &gt;0,  use that many learned householder reflections. Slow if
large number. Dubious whether it actually helps.</p></li>
<li><p><strong>reverse_permutation</strong> – Reverse the permutation before the block, as introduced by Putzky
et al, 2019.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="FrEIA.modules.AllInOneBlock.__module__">
<code class="sig-name descname"><span class="pre">__module__</span></code><em class="property"> <span class="pre">=</span> <span class="pre">'FrEIA.modules.all_in_one_block'</span></em><a class="headerlink" href="#FrEIA.modules.AllInOneBlock.__module__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="FrEIA.modules.AllInOneBlock.forward">
<code class="sig-name descname"><span class="pre">forward</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jac</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/all_in_one_block.html#AllInOneBlock.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#FrEIA.modules.AllInOneBlock.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>See base class docstring</p>
</dd></dl>

<dl class="py method">
<dt id="FrEIA.modules.AllInOneBlock.output_dims">
<code class="sig-name descname"><span class="pre">output_dims</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_dims</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/all_in_one_block.html#AllInOneBlock.output_dims"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#FrEIA.modules.AllInOneBlock.output_dims" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="FrEIA.modules.AllInOneBlock.training">
<code class="sig-name descname"><span class="pre">training</span></code><em class="property"><span class="pre">:</span> <span class="pre">bool</span></em><a class="headerlink" href="#FrEIA.modules.AllInOneBlock.training" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="FrEIA.modules.Concat">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">FrEIA.modules.</span></code><code class="sig-name descname"><span class="pre">Concat</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dims_in</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/graph_topology.html#Concat"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#FrEIA.modules.Concat" title="Permalink to this definition">¶</a></dt>
<dd><p>Invertible merge operation.</p>
<p>Concatenates a list of incoming tensors along a given dimension and passes
on the result. Inverse is the corresponding split operation.</p>
<dl class="py attribute">
<dt id="FrEIA.modules.Concat.dims_in">
<code class="sig-name descname"><span class="pre">dims_in</span></code><a class="headerlink" href="#FrEIA.modules.Concat.dims_in" title="Permalink to this definition">¶</a></dt>
<dd><p>A list of tuples containing the non-batch dimensionality of all
incoming tensors. Handled automatically during compute graph setup.
Dimensionality of incoming tensors must be identical, except in the
merge dimension <cite>dim</cite>. Concat only makes sense with multiple input
tensors.</p>
</dd></dl>

<dl class="py attribute">
<dt id="FrEIA.modules.Concat.dim">
<code class="sig-name descname"><span class="pre">dim</span></code><a class="headerlink" href="#FrEIA.modules.Concat.dim" title="Permalink to this definition">¶</a></dt>
<dd><p>Index of the dimension along which to concatenate, not counting the
batch dimension. Defaults to 0, i.e. the channel dimension in structured
data.</p>
</dd></dl>

<dl class="py method">
<dt id="FrEIA.modules.Concat.__init__">
<code class="sig-name descname"><span class="pre">__init__</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dims_in</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/graph_topology.html#Concat.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#FrEIA.modules.Concat.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Inits the Concat module with the attributes described above and
checks that all dimensions are compatible.</p>
</dd></dl>

<dl class="py attribute">
<dt id="FrEIA.modules.Concat.__module__">
<code class="sig-name descname"><span class="pre">__module__</span></code><em class="property"> <span class="pre">=</span> <span class="pre">'FrEIA.modules.graph_topology'</span></em><a class="headerlink" href="#FrEIA.modules.Concat.__module__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="FrEIA.modules.Concat.forward">
<code class="sig-name descname"><span class="pre">forward</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jac</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/graph_topology.html#Concat.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#FrEIA.modules.Concat.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>See super class InvertibleModule.
Jacobian log-det of concatenation is always zero.</p>
</dd></dl>

<dl class="py method">
<dt id="FrEIA.modules.Concat.output_dims">
<code class="sig-name descname"><span class="pre">output_dims</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_dims</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/graph_topology.html#Concat.output_dims"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#FrEIA.modules.Concat.output_dims" title="Permalink to this definition">¶</a></dt>
<dd><p>See super class InvertibleModule.</p>
</dd></dl>

<dl class="py attribute">
<dt id="FrEIA.modules.Concat.training">
<code class="sig-name descname"><span class="pre">training</span></code><em class="property"><span class="pre">:</span> <span class="pre">bool</span></em><a class="headerlink" href="#FrEIA.modules.Concat.training" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py attribute">
<dt id="FrEIA.modules.ConcatChannel">
<code class="sig-prename descclassname"><span class="pre">FrEIA.modules.</span></code><code class="sig-name descname"><span class="pre">ConcatChannel</span></code><a class="headerlink" href="#FrEIA.modules.ConcatChannel" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of <code class="xref py py-class docutils literal notranslate"><span class="pre">FrEIA.modules.graph_topology._deprecated_by.&lt;locals&gt;.deprecated_class</span></code></p>
</dd></dl>

<dl class="py class">
<dt id="FrEIA.modules.ConditionalAffineTransform">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">FrEIA.modules.</span></code><code class="sig-name descname"><span class="pre">ConditionalAffineTransform</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dims_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dims_c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subnet_constructor</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Callable</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clamp</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">2.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clamp_activation</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span> </span><span class="pre">Callable</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">'ATAN'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/coupling_layers.html#ConditionalAffineTransform"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#FrEIA.modules.ConditionalAffineTransform" title="Permalink to this definition">¶</a></dt>
<dd><p>Similar to the conditioning layers from SPADE (Park et al, 2019): Perform
an affine transformation on the whole input, where the affine coefficients
are predicted from only the condition.</p>
<dl class="py method">
<dt id="FrEIA.modules.ConditionalAffineTransform.__init__">
<code class="sig-name descname"><span class="pre">__init__</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dims_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dims_c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subnet_constructor</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Callable</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clamp</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">2.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clamp_activation</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span> </span><span class="pre">Callable</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">'ATAN'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/coupling_layers.html#ConditionalAffineTransform.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#FrEIA.modules.ConditionalAffineTransform.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Additional args in docstring of base class.
:param subnet_constructor: function or class, with signature</p>
<blockquote>
<div><p>constructor(dims_in, dims_out).  The result should be a torch
nn.Module, that takes dims_in input channels, and dims_out output
channels. See tutorial for examples. One subnetwork will be
initialized in the block.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>clamp</strong> – Soft clamping for the multiplicative component. The
amplification or attenuation of each input dimension can be at most
exp(±clamp).</p></li>
<li><p><strong>clamp_activation</strong> – Function to perform the clamping. String values
“ATAN”, “TANH”, and “SIGMOID” are recognized, or a function of
object can be passed. TANH behaves like the original realNVP paper.
A custom function should take tensors and map -inf to -1 and +inf to +1.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="FrEIA.modules.ConditionalAffineTransform.__module__">
<code class="sig-name descname"><span class="pre">__module__</span></code><em class="property"> <span class="pre">=</span> <span class="pre">'FrEIA.modules.coupling_layers'</span></em><a class="headerlink" href="#FrEIA.modules.ConditionalAffineTransform.__module__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="FrEIA.modules.ConditionalAffineTransform.forward">
<code class="sig-name descname"><span class="pre">forward</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jac</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/coupling_layers.html#ConditionalAffineTransform.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#FrEIA.modules.ConditionalAffineTransform.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>See base class docstring</p>
</dd></dl>

<dl class="py attribute">
<dt id="FrEIA.modules.ConditionalAffineTransform.training">
<code class="sig-name descname"><span class="pre">training</span></code><em class="property"><span class="pre">:</span> <span class="pre">bool</span></em><a class="headerlink" href="#FrEIA.modules.ConditionalAffineTransform.training" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="FrEIA.modules.Fixed1x1Conv">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">FrEIA.modules.</span></code><code class="sig-name descname"><span class="pre">Fixed1x1Conv</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dims_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dims_c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">M</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/fixed_transforms.html#Fixed1x1Conv"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#FrEIA.modules.Fixed1x1Conv" title="Permalink to this definition">¶</a></dt>
<dd><p>Fixed 1x1 conv transformation with matrix M.</p>
<dl class="py method">
<dt id="FrEIA.modules.Fixed1x1Conv.__init__">
<code class="sig-name descname"><span class="pre">__init__</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dims_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dims_c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">M</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/fixed_transforms.html#Fixed1x1Conv.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#FrEIA.modules.Fixed1x1Conv.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Parameters:
dims_in: list of tuples specifying the shape of the inputs to this</p>
<blockquote>
<div><p>operator: dims_in = [shape_x_0, shape_x_1, …]</p>
</div></blockquote>
<dl class="simple">
<dt>dims_c:  list of tuples specifying the shape of the conditions to</dt><dd><p>this operator.</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="FrEIA.modules.Fixed1x1Conv.__module__">
<code class="sig-name descname"><span class="pre">__module__</span></code><em class="property"> <span class="pre">=</span> <span class="pre">'FrEIA.modules.fixed_transforms'</span></em><a class="headerlink" href="#FrEIA.modules.Fixed1x1Conv.__module__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="FrEIA.modules.Fixed1x1Conv.forward">
<code class="sig-name descname"><span class="pre">forward</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jac</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/fixed_transforms.html#Fixed1x1Conv.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#FrEIA.modules.Fixed1x1Conv.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform a forward (default, <cite>rev=False</cite>) or backward pass (<cite>rev=True</cite>)
through this module/operator.</p>
<p><em>Note to implementers:</em>
- Subclasses MUST return a Jacobian when jac=True, but CAN return a</p>
<blockquote>
<div><p>valid Jacobian when jac=False (not punished). The latter is only recommended
if the computation of the Jacobian is trivial.</p>
</div></blockquote>
<ul class="simple">
<li><p>Subclasses MUST follow the convention that the returned Jacobian be
consistent with the evaluation direction. Let’s make this more precise:
Let $f$ be the function that the subclass represents. Then:
$$$
J = log det</p></li>
</ul>
<dl class="simple">
<dt>rac{partial f}{partial x} </dt><dd><p>-J = log det</p>
</dd>
<dt>rac{partial f^{-1}}{partial z}.</dt><dd><p>$$$
Any subclass MUST return $J$ for forward evaluation (<cite>rev=False</cite>),
and $-J$ for backward evaluation (<cite>rev=True</cite>).</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x_or_z</strong> – input data (array-like of one or more tensors)</p></li>
<li><p><strong>c</strong> – conditioning data (array-like of none or more tensors)</p></li>
<li><p><strong>rev</strong> – perform backward pass</p></li>
<li><p><strong>jac</strong> – return Jacobian associated to the direction</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="FrEIA.modules.Fixed1x1Conv.output_dims">
<code class="sig-name descname"><span class="pre">output_dims</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_dims</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/fixed_transforms.html#Fixed1x1Conv.output_dims"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#FrEIA.modules.Fixed1x1Conv.output_dims" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="FrEIA.modules.Fixed1x1Conv.training">
<code class="sig-name descname"><span class="pre">training</span></code><em class="property"><span class="pre">:</span> <span class="pre">bool</span></em><a class="headerlink" href="#FrEIA.modules.Fixed1x1Conv.training" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="FrEIA.modules.FixedLinearTransform">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">FrEIA.modules.</span></code><code class="sig-name descname"><span class="pre">FixedLinearTransform</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dims_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dims_c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">M</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/fixed_transforms.html#FixedLinearTransform"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#FrEIA.modules.FixedLinearTransform" title="Permalink to this definition">¶</a></dt>
<dd><p>Fixed transformation according to y = Mx + b, with invertible
matrix M.</p>
<dl class="py method">
<dt id="FrEIA.modules.FixedLinearTransform.__init__">
<code class="sig-name descname"><span class="pre">__init__</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dims_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dims_c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">M</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/fixed_transforms.html#FixedLinearTransform.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#FrEIA.modules.FixedLinearTransform.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Parameters:
dims_in: list of tuples specifying the shape of the inputs to this</p>
<blockquote>
<div><p>operator: dims_in = [shape_x_0, shape_x_1, …]</p>
</div></blockquote>
<dl class="simple">
<dt>dims_c:  list of tuples specifying the shape of the conditions to</dt><dd><p>this operator.</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="FrEIA.modules.FixedLinearTransform.__module__">
<code class="sig-name descname"><span class="pre">__module__</span></code><em class="property"> <span class="pre">=</span> <span class="pre">'FrEIA.modules.fixed_transforms'</span></em><a class="headerlink" href="#FrEIA.modules.FixedLinearTransform.__module__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="FrEIA.modules.FixedLinearTransform.forward">
<code class="sig-name descname"><span class="pre">forward</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jac</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/fixed_transforms.html#FixedLinearTransform.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#FrEIA.modules.FixedLinearTransform.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform a forward (default, <cite>rev=False</cite>) or backward pass (<cite>rev=True</cite>)
through this module/operator.</p>
<p><em>Note to implementers:</em>
- Subclasses MUST return a Jacobian when jac=True, but CAN return a</p>
<blockquote>
<div><p>valid Jacobian when jac=False (not punished). The latter is only recommended
if the computation of the Jacobian is trivial.</p>
</div></blockquote>
<ul class="simple">
<li><p>Subclasses MUST follow the convention that the returned Jacobian be
consistent with the evaluation direction. Let’s make this more precise:
Let $f$ be the function that the subclass represents. Then:
$$$
J = log det</p></li>
</ul>
<dl class="simple">
<dt>rac{partial f}{partial x} </dt><dd><p>-J = log det</p>
</dd>
<dt>rac{partial f^{-1}}{partial z}.</dt><dd><p>$$$
Any subclass MUST return $J$ for forward evaluation (<cite>rev=False</cite>),
and $-J$ for backward evaluation (<cite>rev=True</cite>).</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x_or_z</strong> – input data (array-like of one or more tensors)</p></li>
<li><p><strong>c</strong> – conditioning data (array-like of none or more tensors)</p></li>
<li><p><strong>rev</strong> – perform backward pass</p></li>
<li><p><strong>jac</strong> – return Jacobian associated to the direction</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="FrEIA.modules.FixedLinearTransform.output_dims">
<code class="sig-name descname"><span class="pre">output_dims</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_dims</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/fixed_transforms.html#FixedLinearTransform.output_dims"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#FrEIA.modules.FixedLinearTransform.output_dims" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="FrEIA.modules.FixedLinearTransform.training">
<code class="sig-name descname"><span class="pre">training</span></code><em class="property"><span class="pre">:</span> <span class="pre">bool</span></em><a class="headerlink" href="#FrEIA.modules.FixedLinearTransform.training" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="FrEIA.modules.Flatten">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">FrEIA.modules.</span></code><code class="sig-name descname"><span class="pre">Flatten</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dims_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dims_c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/reshapes.html#Flatten"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#FrEIA.modules.Flatten" title="Permalink to this definition">¶</a></dt>
<dd><p>Flattens N-D tensors into 1-D tensors.</p>
<dl class="py method">
<dt id="FrEIA.modules.Flatten.__init__">
<code class="sig-name descname"><span class="pre">__init__</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dims_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dims_c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/reshapes.html#Flatten.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#FrEIA.modules.Flatten.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>See docstring of base class (FrEIA.modules.InvertibleModule).</p>
</dd></dl>

<dl class="py attribute">
<dt id="FrEIA.modules.Flatten.__module__">
<code class="sig-name descname"><span class="pre">__module__</span></code><em class="property"> <span class="pre">=</span> <span class="pre">'FrEIA.modules.reshapes'</span></em><a class="headerlink" href="#FrEIA.modules.Flatten.__module__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="FrEIA.modules.Flatten.forward">
<code class="sig-name descname"><span class="pre">forward</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jac</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/reshapes.html#Flatten.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#FrEIA.modules.Flatten.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>See docstring of base class (FrEIA.modules.InvertibleModule).</p>
</dd></dl>

<dl class="py method">
<dt id="FrEIA.modules.Flatten.output_dims">
<code class="sig-name descname"><span class="pre">output_dims</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_dims</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/reshapes.html#Flatten.output_dims"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#FrEIA.modules.Flatten.output_dims" title="Permalink to this definition">¶</a></dt>
<dd><p>See docstring of base class (FrEIA.modules.InvertibleModule).</p>
</dd></dl>

<dl class="py attribute">
<dt id="FrEIA.modules.Flatten.training">
<code class="sig-name descname"><span class="pre">training</span></code><em class="property"><span class="pre">:</span> <span class="pre">bool</span></em><a class="headerlink" href="#FrEIA.modules.Flatten.training" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="FrEIA.modules.GINCouplingBlock">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">FrEIA.modules.</span></code><code class="sig-name descname"><span class="pre">GINCouplingBlock</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dims_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dims_c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subnet_constructor</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Callable</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clamp</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">2.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clamp_activation</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span> </span><span class="pre">Callable</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">'ATAN'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/coupling_layers.html#GINCouplingBlock"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#FrEIA.modules.GINCouplingBlock" title="Permalink to this definition">¶</a></dt>
<dd><p>Coupling Block following the GIN design. The difference from
GLOWCouplingBlock (and other affine coupling blocks) is that the Jacobian
determinant is constrained to be 1.  This constrains the block to be
volume-preserving. Volume preservation is achieved by subtracting the mean
of the output of the s subnetwork from itself.  While volume preserving, GIN
is still more powerful than NICE, as GIN is not volume preserving within
each dimension.
Note: this implementation differs slightly from the originally published
implementation, which scales the final component of the s subnetwork so the
sum of the outputs of s is zero. There was no difference found between the
implementations in practice, but subtracting the mean guarantees that all
outputs of s are at most ±exp(clamp), which might be more stable in certain
cases.</p>
<dl class="py method">
<dt id="FrEIA.modules.GINCouplingBlock.__init__">
<code class="sig-name descname"><span class="pre">__init__</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dims_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dims_c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subnet_constructor</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Callable</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clamp</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">2.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clamp_activation</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span> </span><span class="pre">Callable</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">'ATAN'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/coupling_layers.html#GINCouplingBlock.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#FrEIA.modules.GINCouplingBlock.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Additional args in docstring of base class.
:param subnet_constructor: function or class, with signature</p>
<blockquote>
<div><p>constructor(dims_in, dims_out).  The result should be a torch
nn.Module, that takes dims_in input channels, and dims_out output
channels. See tutorial for examples. Two of these subnetworks will be
initialized in the block.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>clamp</strong> – Soft clamping for the multiplicative component. The
amplification or attenuation of each input dimension can be at most
exp(±clamp).</p></li>
<li><p><strong>clamp_activation</strong> – Function to perform the clamping. String values
“ATAN”, “TANH”, and “SIGMOID” are recognized, or a function of
object can be passed. TANH behaves like the original realNVP paper.
A custom function should take tensors and map -inf to -1 and +inf to +1.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="FrEIA.modules.GINCouplingBlock.__module__">
<code class="sig-name descname"><span class="pre">__module__</span></code><em class="property"> <span class="pre">=</span> <span class="pre">'FrEIA.modules.coupling_layers'</span></em><a class="headerlink" href="#FrEIA.modules.GINCouplingBlock.__module__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="FrEIA.modules.GINCouplingBlock.training">
<code class="sig-name descname"><span class="pre">training</span></code><em class="property"><span class="pre">:</span> <span class="pre">bool</span></em><a class="headerlink" href="#FrEIA.modules.GINCouplingBlock.training" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="FrEIA.modules.GLOWCouplingBlock">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">FrEIA.modules.</span></code><code class="sig-name descname"><span class="pre">GLOWCouplingBlock</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dims_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dims_c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subnet_constructor</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Callable</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clamp</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">2.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clamp_activation</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span> </span><span class="pre">Callable</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">'ATAN'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/coupling_layers.html#GLOWCouplingBlock"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#FrEIA.modules.GLOWCouplingBlock" title="Permalink to this definition">¶</a></dt>
<dd><p>Coupling Block following the GLOW design. Note, this is only the coupling
part itself, and does not include ActNorm, invertible 1x1 convolutions, etc.
See AllInOneBlock for a block combining these functions at once.
The only difference to the RNVPCouplingBlock coupling blocks
is that it uses a single subnetwork to jointly predict [s_i, t_i], instead of two separate
subnetworks. This reduces computational cost and speeds up learning.</p>
<dl class="py method">
<dt id="FrEIA.modules.GLOWCouplingBlock.__init__">
<code class="sig-name descname"><span class="pre">__init__</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dims_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dims_c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subnet_constructor</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Callable</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clamp</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">2.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clamp_activation</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span> </span><span class="pre">Callable</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">'ATAN'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/coupling_layers.html#GLOWCouplingBlock.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#FrEIA.modules.GLOWCouplingBlock.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Additional args in docstring of base class.
:param subnet_constructor: function or class, with signature</p>
<blockquote>
<div><p>constructor(dims_in, dims_out).  The result should be a torch
nn.Module, that takes dims_in input channels, and dims_out output
channels. See tutorial for examples. Two of these subnetworks will be
initialized in the block.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>clamp</strong> – Soft clamping for the multiplicative component. The
amplification or attenuation of each input dimension can be at most
exp(±clamp).</p></li>
<li><p><strong>clamp_activation</strong> – Function to perform the clamping. String values
“ATAN”, “TANH”, and “SIGMOID” are recognized, or a function of
object can be passed. TANH behaves like the original realNVP paper.
A custom function should take tensors and map -inf to -1 and +inf to +1.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="FrEIA.modules.GLOWCouplingBlock.__module__">
<code class="sig-name descname"><span class="pre">__module__</span></code><em class="property"> <span class="pre">=</span> <span class="pre">'FrEIA.modules.coupling_layers'</span></em><a class="headerlink" href="#FrEIA.modules.GLOWCouplingBlock.__module__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="FrEIA.modules.GLOWCouplingBlock.training">
<code class="sig-name descname"><span class="pre">training</span></code><em class="property"><span class="pre">:</span> <span class="pre">bool</span></em><a class="headerlink" href="#FrEIA.modules.GLOWCouplingBlock.training" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="FrEIA.modules.GaussianMixtureModel">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">FrEIA.modules.</span></code><code class="sig-name descname"><span class="pre">GaussianMixtureModel</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dims_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dims_c</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/gaussian_mixture.html#GaussianMixtureModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#FrEIA.modules.GaussianMixtureModel" title="Permalink to this definition">¶</a></dt>
<dd><p>An invertible Gaussian mixture model. The weights, means, covariance
parameterization and component index must be supplied as conditional inputs
to the module and can come from an external feed-forward network, which may
be trained by backpropagating through the GMM. Weights should first be
normalized via GaussianMixtureModel.normalize_weights(w) and component
indices can be sampled via GaussianMixtureModel.pick_mixture_component(w).
If component indices are specified, the model reduces to that Gaussian
mixture component and maps between data x and standard normal latent
variable z. Components can also be chosen consistently at random, by
supplying an integer random seed instead of indices. If a None value is
supplied instead of indices, the model maps between K data points x and K
latent codes z simultaneously, where K is the number of mixture components.
Mathematical derivations are found in the technical report “Training Mixture
Density Networks with full covariance matrices” on arXiv.</p>
<dl class="py method">
<dt id="FrEIA.modules.GaussianMixtureModel.__init__">
<code class="sig-name descname"><span class="pre">__init__</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dims_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dims_c</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/gaussian_mixture.html#GaussianMixtureModel.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#FrEIA.modules.GaussianMixtureModel.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Parameters:
dims_in: list of tuples specifying the shape of the inputs to this</p>
<blockquote>
<div><p>operator: dims_in = [shape_x_0, shape_x_1, …]</p>
</div></blockquote>
<dl class="simple">
<dt>dims_c:  list of tuples specifying the shape of the conditions to</dt><dd><p>this operator.</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="FrEIA.modules.GaussianMixtureModel.__module__">
<code class="sig-name descname"><span class="pre">__module__</span></code><em class="property"> <span class="pre">=</span> <span class="pre">'FrEIA.modules.gaussian_mixture'</span></em><a class="headerlink" href="#FrEIA.modules.GaussianMixtureModel.__module__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="FrEIA.modules.GaussianMixtureModel.forward">
<code class="sig-name descname"><span class="pre">forward</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jac</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/gaussian_mixture.html#GaussianMixtureModel.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#FrEIA.modules.GaussianMixtureModel.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Map between data distribution and standard normal latent distribution
of mixture components or entire mixture, in an invertible way.</p>
<dl class="simple">
<dt>x:  Data during forward pass or latent codes during backward pass. Size</dt><dd><p>must be [batch_size, n_dims] if component indices i are specified
and should be [batch_size, n_components, n_dims] if not.</p>
</dd>
</dl>
<p>The conditional input c must be a list [w, mu, U, i] of parameters for
the Gaussian mixture model with the following properties:</p>
<dl class="simple">
<dt>w:  Weights of the mixture components, must be positive and sum to one</dt><dd><p>and have size [batch_size, n_components].</p>
</dd>
<dt>mu: Means of the mixture components, must have size [batch_size,</dt><dd><p>n_components, n_dims].</p>
</dd>
<dt>U:  Entries for the (upper triangular) Cholesky factors for the</dt><dd><p>precision matrices of the mixture components. These are needed to
parameterize the covariance of the mixture components and must have
size [batch_size, n_components, n_dims * (n_dims + 1) / 2].</p>
</dd>
<dt>i:  Tensor of component indices (size [batch_size]), or a single integer</dt><dd><p>to be used as random number generator seed for component selection,
or None to indicate that all mixture components are modelled.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="FrEIA.modules.GaussianMixtureModel.nll_loss">
<em class="property"><span class="pre">static</span> </em><code class="sig-name descname"><span class="pre">nll_loss</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">w</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_jacobian</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/gaussian_mixture.html#GaussianMixtureModel.nll_loss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#FrEIA.modules.GaussianMixtureModel.nll_loss" title="Permalink to this definition">¶</a></dt>
<dd><p>Negative log-likelihood loss for training a Mixture Density Network.</p>
<dl class="simple">
<dt>w:              Mixture component weights, must be positive and sum to</dt><dd><p>one. Tensor must be of size [batch_size, n_components].</p>
</dd>
<dt>z:              Latent codes for all mixture components. Tensor must be</dt><dd><p>of size [batch, n_components, n_dims].</p>
</dd>
<dt>log_jacobian:   Jacobian log-determinants for each precision matrix.</dt><dd><p>Tensor size must be [batch_size, n_components].</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="FrEIA.modules.GaussianMixtureModel.nll_upper_bound">
<em class="property"><span class="pre">static</span> </em><code class="sig-name descname"><span class="pre">nll_upper_bound</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">w</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_jacobian</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/gaussian_mixture.html#GaussianMixtureModel.nll_upper_bound"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#FrEIA.modules.GaussianMixtureModel.nll_upper_bound" title="Permalink to this definition">¶</a></dt>
<dd><p>Numerically more stable upper bound of the negative log-likelihood
loss for training a Mixture Density Network.</p>
<dl class="simple">
<dt>w:              Mixture component weights, must be positive and sum to</dt><dd><p>one. Tensor must be of size [batch_size, n_components].</p>
</dd>
<dt>z:              Latent codes for all mixture components. Tensor must be</dt><dd><p>of size [batch, n_components, n_dims].</p>
</dd>
<dt>log_jacobian:   Jacobian log-determinants for each precision matrix.</dt><dd><p>Tensor size must be [batch_size, n_components].</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="FrEIA.modules.GaussianMixtureModel.normalize_weights">
<em class="property"><span class="pre">static</span> </em><code class="sig-name descname"><span class="pre">normalize_weights</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">w</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/gaussian_mixture.html#GaussianMixtureModel.normalize_weights"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#FrEIA.modules.GaussianMixtureModel.normalize_weights" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply softmax to ensure component weights are positive and sum to
one. Works on batches of component weights.</p>
<dl class="simple">
<dt>w:  Unnormalized weights for Gaussian mixture components, must be of</dt><dd><p>size [batch_size, n_components]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="FrEIA.modules.GaussianMixtureModel.output_dims">
<code class="sig-name descname"><span class="pre">output_dims</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_dims</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/gaussian_mixture.html#GaussianMixtureModel.output_dims"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#FrEIA.modules.GaussianMixtureModel.output_dims" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="FrEIA.modules.GaussianMixtureModel.pick_mixture_component">
<em class="property"><span class="pre">static</span> </em><code class="sig-name descname"><span class="pre">pick_mixture_component</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">w</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/gaussian_mixture.html#GaussianMixtureModel.pick_mixture_component"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#FrEIA.modules.GaussianMixtureModel.pick_mixture_component" title="Permalink to this definition">¶</a></dt>
<dd><p>Randomly choose mixture component indices with probability given by
the component weights w. Works on batches of component weights.</p>
<p>w:      Weights of the mixture components, must be positive and sum to one
seed:   Optional RNG seed for consistent decisions</p>
</dd></dl>

<dl class="py attribute">
<dt id="FrEIA.modules.GaussianMixtureModel.training">
<code class="sig-name descname"><span class="pre">training</span></code><em class="property"><span class="pre">:</span> <span class="pre">bool</span></em><a class="headerlink" href="#FrEIA.modules.GaussianMixtureModel.training" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="FrEIA.modules.HaarDownsampling">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">FrEIA.modules.</span></code><code class="sig-name descname"><span class="pre">HaarDownsampling</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dims_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dims_c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order_by_wavelet</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rebalance</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/reshapes.html#HaarDownsampling"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#FrEIA.modules.HaarDownsampling" title="Permalink to this definition">¶</a></dt>
<dd><p>Uses Haar wavelets to split each channel into 4 channels, with half the
width and height dimensions.</p>
<dl class="py method">
<dt id="FrEIA.modules.HaarDownsampling.__init__">
<code class="sig-name descname"><span class="pre">__init__</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dims_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dims_c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order_by_wavelet</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rebalance</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/reshapes.html#HaarDownsampling.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#FrEIA.modules.HaarDownsampling.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>See docstring of base class (FrEIA.modules.InvertibleModule) for more.
:param order_by_wavelet: Whether to group the output by original channels or</p>
<blockquote>
<div><p>by wavelet. E.g. if the average, vertical, horizontal and diagonal
wavelets for channel 1 are a1, v1, h1, d1, those for channel 2 are
a2, v2, h2, d2, etc, then the output channels will be structured as
follows:
set to True: a1, a2, …, v1, v2, …, h1, h2, …, d1, d2, …
set to False: a1, v1, h1, d1, a2, v2, h2, d2, …
The True option is slightly slower to compute than the False option.
The option is useful if e.g. the average channels should be split
off by a FrEIA.modules.Split. Then, setting order_by_wavelet=True
allows to split off the first quarter of channels to isolate the
average wavelets only.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>rebalance</strong> – Must !=0. There exist different conventions how to define
the Haar wavelets. The wavelet components in the forward direction
are multiplied with this factor, and those in the inverse direction
are adjusted accordingly, so that the module as a whole is
invertible.  Stability of the network may be increased for rebalance
&lt; 1 (e.g. 0.5).</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="FrEIA.modules.HaarDownsampling.__module__">
<code class="sig-name descname"><span class="pre">__module__</span></code><em class="property"> <span class="pre">=</span> <span class="pre">'FrEIA.modules.reshapes'</span></em><a class="headerlink" href="#FrEIA.modules.HaarDownsampling.__module__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="FrEIA.modules.HaarDownsampling.forward">
<code class="sig-name descname"><span class="pre">forward</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jac</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/reshapes.html#HaarDownsampling.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#FrEIA.modules.HaarDownsampling.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>See docstring of base class (FrEIA.modules.InvertibleModule).</p>
</dd></dl>

<dl class="py method">
<dt id="FrEIA.modules.HaarDownsampling.output_dims">
<code class="sig-name descname"><span class="pre">output_dims</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_dims</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/reshapes.html#HaarDownsampling.output_dims"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#FrEIA.modules.HaarDownsampling.output_dims" title="Permalink to this definition">¶</a></dt>
<dd><p>See docstring of base class (FrEIA.modules.InvertibleModule).</p>
</dd></dl>

<dl class="py attribute">
<dt id="FrEIA.modules.HaarDownsampling.training">
<code class="sig-name descname"><span class="pre">training</span></code><em class="property"><span class="pre">:</span> <span class="pre">bool</span></em><a class="headerlink" href="#FrEIA.modules.HaarDownsampling.training" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="FrEIA.modules.HaarUpsampling">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">FrEIA.modules.</span></code><code class="sig-name descname"><span class="pre">HaarUpsampling</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dims_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dims_c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order_by_wavelet</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rebalance</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/reshapes.html#HaarUpsampling"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#FrEIA.modules.HaarUpsampling" title="Permalink to this definition">¶</a></dt>
<dd><p>The inverted operation of HaarDownsampling (see that docstring for details).</p>
<dl class="py method">
<dt id="FrEIA.modules.HaarUpsampling.__init__">
<code class="sig-name descname"><span class="pre">__init__</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dims_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dims_c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order_by_wavelet</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rebalance</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/reshapes.html#HaarUpsampling.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#FrEIA.modules.HaarUpsampling.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>See docstring of base class (FrEIA.modules.InvertibleModule) for more.
:param order_by_wavelet: Whether to group the output by original channels or</p>
<blockquote>
<div><p>by wavelet. E.g. if the average, vertical, horizontal and diagonal
wavelets for channel 1 are a1, v1, h1, d1, those for channel 2 are
a2, v2, h2, d2, etc, then the output channels will be structured as
follows:
set to True: a1, a2, …, v1, v2, …, h1, h2, …, d1, d2, …
set to False: a1, v1, h1, d1, a2, v2, h2, d2, …
The True option is slightly slower to compute than the False option.
The option is useful if e.g. the average channels should be split
off by a FrEIA.modules.Split. Then, setting order_by_wavelet=True
allows to split off the first quarter of channels to isolate the
average wavelets only.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>rebalance</strong> – Must !=0. There exist different conventions how to define
the Haar wavelets. The wavelet components in the forward direction
are multiplied with this factor, and those in the inverse direction
are adjusted accordingly, so that the module as a whole is
invertible.  Stability of the network may be increased for rebalance
&lt; 1 (e.g. 0.5).</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="FrEIA.modules.HaarUpsampling.__module__">
<code class="sig-name descname"><span class="pre">__module__</span></code><em class="property"> <span class="pre">=</span> <span class="pre">'FrEIA.modules.reshapes'</span></em><a class="headerlink" href="#FrEIA.modules.HaarUpsampling.__module__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="FrEIA.modules.HaarUpsampling.forward">
<code class="sig-name descname"><span class="pre">forward</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jac</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/reshapes.html#HaarUpsampling.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#FrEIA.modules.HaarUpsampling.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>See docstring of base class (FrEIA.modules.InvertibleModule).</p>
</dd></dl>

<dl class="py method">
<dt id="FrEIA.modules.HaarUpsampling.output_dims">
<code class="sig-name descname"><span class="pre">output_dims</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_dims</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/reshapes.html#HaarUpsampling.output_dims"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#FrEIA.modules.HaarUpsampling.output_dims" title="Permalink to this definition">¶</a></dt>
<dd><p>See docstring of base class (FrEIA.modules.InvertibleModule).</p>
</dd></dl>

<dl class="py attribute">
<dt id="FrEIA.modules.HaarUpsampling.training">
<code class="sig-name descname"><span class="pre">training</span></code><em class="property"><span class="pre">:</span> <span class="pre">bool</span></em><a class="headerlink" href="#FrEIA.modules.HaarUpsampling.training" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="FrEIA.modules.HouseholderPerm">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">FrEIA.modules.</span></code><code class="sig-name descname"><span class="pre">HouseholderPerm</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dims_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dims_c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_reflections</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fixed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/orthogonal.html#HouseholderPerm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#FrEIA.modules.HouseholderPerm" title="Permalink to this definition">¶</a></dt>
<dd><dl class="py method">
<dt id="FrEIA.modules.HouseholderPerm.__init__">
<code class="sig-name descname"><span class="pre">__init__</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dims_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dims_c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_reflections</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fixed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/orthogonal.html#HouseholderPerm.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#FrEIA.modules.HouseholderPerm.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Parameters:
dims_in: list of tuples specifying the shape of the inputs to this</p>
<blockquote>
<div><p>operator: dims_in = [shape_x_0, shape_x_1, …]</p>
</div></blockquote>
<dl class="simple">
<dt>dims_c:  list of tuples specifying the shape of the conditions to</dt><dd><p>this operator.</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="FrEIA.modules.HouseholderPerm.__module__">
<code class="sig-name descname"><span class="pre">__module__</span></code><em class="property"> <span class="pre">=</span> <span class="pre">'FrEIA.modules.orthogonal'</span></em><a class="headerlink" href="#FrEIA.modules.HouseholderPerm.__module__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="FrEIA.modules.HouseholderPerm.forward">
<code class="sig-name descname"><span class="pre">forward</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jac</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/orthogonal.html#HouseholderPerm.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#FrEIA.modules.HouseholderPerm.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform a forward (default, <cite>rev=False</cite>) or backward pass (<cite>rev=True</cite>)
through this module/operator.</p>
<p><em>Note to implementers:</em>
- Subclasses MUST return a Jacobian when jac=True, but CAN return a</p>
<blockquote>
<div><p>valid Jacobian when jac=False (not punished). The latter is only recommended
if the computation of the Jacobian is trivial.</p>
</div></blockquote>
<ul class="simple">
<li><p>Subclasses MUST follow the convention that the returned Jacobian be
consistent with the evaluation direction. Let’s make this more precise:
Let $f$ be the function that the subclass represents. Then:
$$$
J = log det</p></li>
</ul>
<dl class="simple">
<dt>rac{partial f}{partial x} </dt><dd><p>-J = log det</p>
</dd>
<dt>rac{partial f^{-1}}{partial z}.</dt><dd><p>$$$
Any subclass MUST return $J$ for forward evaluation (<cite>rev=False</cite>),
and $-J$ for backward evaluation (<cite>rev=True</cite>).</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x_or_z</strong> – input data (array-like of one or more tensors)</p></li>
<li><p><strong>c</strong> – conditioning data (array-like of none or more tensors)</p></li>
<li><p><strong>rev</strong> – perform backward pass</p></li>
<li><p><strong>jac</strong> – return Jacobian associated to the direction</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="FrEIA.modules.HouseholderPerm.output_dims">
<code class="sig-name descname"><span class="pre">output_dims</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_dims</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/orthogonal.html#HouseholderPerm.output_dims"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#FrEIA.modules.HouseholderPerm.output_dims" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="FrEIA.modules.HouseholderPerm.training">
<code class="sig-name descname"><span class="pre">training</span></code><em class="property"><span class="pre">:</span> <span class="pre">bool</span></em><a class="headerlink" href="#FrEIA.modules.HouseholderPerm.training" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="FrEIA.modules.IResNetLayer">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">FrEIA.modules.</span></code><code class="sig-name descname"><span class="pre">IResNetLayer</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dims_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dims_c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">internal_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_internal_layers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jacobian_iterations</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hutchinson_samples</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fixed_point_iterations</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lipschitz_iterations</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lipschitz_batchsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spectral_norm_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.8</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/invertible_resnet.html#IResNetLayer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#FrEIA.modules.IResNetLayer" title="Permalink to this definition">¶</a></dt>
<dd><p>Implementation of the i-ResNet architecture as proposed in
<a class="reference external" href="https://arxiv.org/pdf/1811.00995.pdf">https://arxiv.org/pdf/1811.00995.pdf</a></p>
<dl class="py method">
<dt id="FrEIA.modules.IResNetLayer.__init__">
<code class="sig-name descname"><span class="pre">__init__</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dims_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dims_c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">internal_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_internal_layers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jacobian_iterations</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hutchinson_samples</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fixed_point_iterations</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lipschitz_iterations</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lipschitz_batchsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spectral_norm_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.8</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/invertible_resnet.html#IResNetLayer.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#FrEIA.modules.IResNetLayer.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Parameters:
dims_in: list of tuples specifying the shape of the inputs to this</p>
<blockquote>
<div><p>operator: dims_in = [shape_x_0, shape_x_1, …]</p>
</div></blockquote>
<dl class="simple">
<dt>dims_c:  list of tuples specifying the shape of the conditions to</dt><dd><p>this operator.</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="FrEIA.modules.IResNetLayer.__module__">
<code class="sig-name descname"><span class="pre">__module__</span></code><em class="property"> <span class="pre">=</span> <span class="pre">'FrEIA.modules.invertible_resnet'</span></em><a class="headerlink" href="#FrEIA.modules.IResNetLayer.__module__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="FrEIA.modules.IResNetLayer.forward">
<code class="sig-name descname"><span class="pre">forward</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jac</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/invertible_resnet.html#IResNetLayer.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#FrEIA.modules.IResNetLayer.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform a forward (default, <cite>rev=False</cite>) or backward pass (<cite>rev=True</cite>)
through this module/operator.</p>
<p><em>Note to implementers:</em>
- Subclasses MUST return a Jacobian when jac=True, but CAN return a</p>
<blockquote>
<div><p>valid Jacobian when jac=False (not punished). The latter is only recommended
if the computation of the Jacobian is trivial.</p>
</div></blockquote>
<ul class="simple">
<li><p>Subclasses MUST follow the convention that the returned Jacobian be
consistent with the evaluation direction. Let’s make this more precise:
Let $f$ be the function that the subclass represents. Then:
$$$
J = log det</p></li>
</ul>
<dl class="simple">
<dt>rac{partial f}{partial x} </dt><dd><p>-J = log det</p>
</dd>
<dt>rac{partial f^{-1}}{partial z}.</dt><dd><p>$$$
Any subclass MUST return $J$ for forward evaluation (<cite>rev=False</cite>),
and $-J$ for backward evaluation (<cite>rev=True</cite>).</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x_or_z</strong> – input data (array-like of one or more tensors)</p></li>
<li><p><strong>c</strong> – conditioning data (array-like of none or more tensors)</p></li>
<li><p><strong>rev</strong> – perform backward pass</p></li>
<li><p><strong>jac</strong> – return Jacobian associated to the direction</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="FrEIA.modules.IResNetLayer.lipschitz_correction">
<code class="sig-name descname"><span class="pre">lipschitz_correction</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/invertible_resnet.html#IResNetLayer.lipschitz_correction"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#FrEIA.modules.IResNetLayer.lipschitz_correction" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="FrEIA.modules.IResNetLayer.output_dims">
<code class="sig-name descname"><span class="pre">output_dims</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_dims</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/invertible_resnet.html#IResNetLayer.output_dims"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#FrEIA.modules.IResNetLayer.output_dims" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="FrEIA.modules.IResNetLayer.training">
<code class="sig-name descname"><span class="pre">training</span></code><em class="property"><span class="pre">:</span> <span class="pre">bool</span></em><a class="headerlink" href="#FrEIA.modules.IResNetLayer.training" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="FrEIA.modules.IRevNetDownsampling">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">FrEIA.modules.</span></code><code class="sig-name descname"><span class="pre">IRevNetDownsampling</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dims_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dims_c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">legacy_backend</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/reshapes.html#IRevNetDownsampling"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#FrEIA.modules.IRevNetDownsampling" title="Permalink to this definition">¶</a></dt>
<dd><p>The invertible spatial downsampling used in i-RevNet.
Each group of four neighboring pixels is reordered into one pixel with four times
the channels in a checkerboard-like pattern. See i-RevNet, Jacobsen 2018 et al.</p>
<dl class="py method">
<dt id="FrEIA.modules.IRevNetDownsampling.__init__">
<code class="sig-name descname"><span class="pre">__init__</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dims_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dims_c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">legacy_backend</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/reshapes.html#IRevNetDownsampling.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#FrEIA.modules.IRevNetDownsampling.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>See docstring of base class (FrEIA.modules.InvertibleModule) for more.
:param legacy_backend: If True, uses the splitting and concatenating method,</p>
<blockquote>
<div><p>adapted from
github.com/jhjacobsen/pytorch-i-revnet/blob/master/models/model_utils.py
for the use in FrEIA. Is usually slower on GPU.
If False, uses a 2d strided convolution with a kernel representing
the downsampling.  Note that the ordering of the output channels
will be different.  If pixels in each patch in channel 1
are a1, b1, …, and in channel 2 are a2, b2, …
Then the output channels will be the following:
legacy_backend=True: a1, a2, …, b1, b2, …, c1, c2, …
legacy_backend=False: a1, b1, …, a2, b2, …, a3, b3, …
(see also order_by_wavelet in module HaarDownsampling)
Usually this difference is completely irrelevant.</p>
</div></blockquote>
</dd></dl>

<dl class="py attribute">
<dt id="FrEIA.modules.IRevNetDownsampling.__module__">
<code class="sig-name descname"><span class="pre">__module__</span></code><em class="property"> <span class="pre">=</span> <span class="pre">'FrEIA.modules.reshapes'</span></em><a class="headerlink" href="#FrEIA.modules.IRevNetDownsampling.__module__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="FrEIA.modules.IRevNetDownsampling.forward">
<code class="sig-name descname"><span class="pre">forward</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jac</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/reshapes.html#IRevNetDownsampling.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#FrEIA.modules.IRevNetDownsampling.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>See docstring of base class (FrEIA.modules.InvertibleModule).</p>
</dd></dl>

<dl class="py method">
<dt id="FrEIA.modules.IRevNetDownsampling.output_dims">
<code class="sig-name descname"><span class="pre">output_dims</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_dims</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/reshapes.html#IRevNetDownsampling.output_dims"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#FrEIA.modules.IRevNetDownsampling.output_dims" title="Permalink to this definition">¶</a></dt>
<dd><p>See docstring of base class (FrEIA.modules.InvertibleModule).</p>
</dd></dl>

<dl class="py attribute">
<dt id="FrEIA.modules.IRevNetDownsampling.training">
<code class="sig-name descname"><span class="pre">training</span></code><em class="property"><span class="pre">:</span> <span class="pre">bool</span></em><a class="headerlink" href="#FrEIA.modules.IRevNetDownsampling.training" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="FrEIA.modules.IRevNetUpsampling">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">FrEIA.modules.</span></code><code class="sig-name descname"><span class="pre">IRevNetUpsampling</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dims_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dims_c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">legacy_backend</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/reshapes.html#IRevNetUpsampling"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#FrEIA.modules.IRevNetUpsampling" title="Permalink to this definition">¶</a></dt>
<dd><p>The inverted operation of IRevNetDownsampling (see that docstring for details).</p>
<dl class="py method">
<dt id="FrEIA.modules.IRevNetUpsampling.__init__">
<code class="sig-name descname"><span class="pre">__init__</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dims_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dims_c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">legacy_backend</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/reshapes.html#IRevNetUpsampling.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#FrEIA.modules.IRevNetUpsampling.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>See docstring of base class (FrEIA.modules.InvertibleModule) for more.
:param legacy_backend: If True, uses the splitting and concatenating method,</p>
<blockquote>
<div><p>adapted from
github.com/jhjacobsen/pytorch-i-revnet/blob/master/models/model_utils.py
for the use in FrEIA. Is usually slower on GPU.
If False, uses a 2d strided convolution with a kernel representing
the downsampling.  Note that the ordering of the output channels
will be different.  If pixels in each patch in channel 1
are a1, b1, …, and in channel 2 are a2, b2, …
Then the output channels will be the following:
legacy_backend=True: a1, a2, …, b1, b2, …, c1, c2, …
legacy_backend=False: a1, b1, …, a2, b2, …, a3, b3, …
(see also order_by_wavelet in module HaarDownsampling)
Usually this difference is completely irrelevant.</p>
</div></blockquote>
</dd></dl>

<dl class="py attribute">
<dt id="FrEIA.modules.IRevNetUpsampling.__module__">
<code class="sig-name descname"><span class="pre">__module__</span></code><em class="property"> <span class="pre">=</span> <span class="pre">'FrEIA.modules.reshapes'</span></em><a class="headerlink" href="#FrEIA.modules.IRevNetUpsampling.__module__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="FrEIA.modules.IRevNetUpsampling.forward">
<code class="sig-name descname"><span class="pre">forward</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jac</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/reshapes.html#IRevNetUpsampling.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#FrEIA.modules.IRevNetUpsampling.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>See docstring of base class (FrEIA.modules.InvertibleModule).</p>
</dd></dl>

<dl class="py method">
<dt id="FrEIA.modules.IRevNetUpsampling.output_dims">
<code class="sig-name descname"><span class="pre">output_dims</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_dims</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/reshapes.html#IRevNetUpsampling.output_dims"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#FrEIA.modules.IRevNetUpsampling.output_dims" title="Permalink to this definition">¶</a></dt>
<dd><p>See docstring of base class (FrEIA.modules.InvertibleModule).</p>
</dd></dl>

<dl class="py attribute">
<dt id="FrEIA.modules.IRevNetUpsampling.training">
<code class="sig-name descname"><span class="pre">training</span></code><em class="property"><span class="pre">:</span> <span class="pre">bool</span></em><a class="headerlink" href="#FrEIA.modules.IRevNetUpsampling.training" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="FrEIA.modules.InvAutoAct">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">FrEIA.modules.</span></code><code class="sig-name descname"><span class="pre">InvAutoAct</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dims_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dims_c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/inv_auto_layers.html#InvAutoAct"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#FrEIA.modules.InvAutoAct" title="Permalink to this definition">¶</a></dt>
<dd><dl class="py method">
<dt id="FrEIA.modules.InvAutoAct.__init__">
<code class="sig-name descname"><span class="pre">__init__</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dims_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dims_c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/inv_auto_layers.html#InvAutoAct.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#FrEIA.modules.InvAutoAct.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Parameters:
dims_in: list of tuples specifying the shape of the inputs to this</p>
<blockquote>
<div><p>operator: dims_in = [shape_x_0, shape_x_1, …]</p>
</div></blockquote>
<dl class="simple">
<dt>dims_c:  list of tuples specifying the shape of the conditions to</dt><dd><p>this operator.</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="FrEIA.modules.InvAutoAct.__module__">
<code class="sig-name descname"><span class="pre">__module__</span></code><em class="property"> <span class="pre">=</span> <span class="pre">'FrEIA.modules.inv_auto_layers'</span></em><a class="headerlink" href="#FrEIA.modules.InvAutoAct.__module__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="FrEIA.modules.InvAutoAct.forward">
<code class="sig-name descname"><span class="pre">forward</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jac</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/inv_auto_layers.html#InvAutoAct.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#FrEIA.modules.InvAutoAct.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform a forward (default, <cite>rev=False</cite>) or backward pass (<cite>rev=True</cite>)
through this module/operator.</p>
<p><em>Note to implementers:</em>
- Subclasses MUST return a Jacobian when jac=True, but CAN return a</p>
<blockquote>
<div><p>valid Jacobian when jac=False (not punished). The latter is only recommended
if the computation of the Jacobian is trivial.</p>
</div></blockquote>
<ul class="simple">
<li><p>Subclasses MUST follow the convention that the returned Jacobian be
consistent with the evaluation direction. Let’s make this more precise:
Let $f$ be the function that the subclass represents. Then:
$$$
J = log det</p></li>
</ul>
<dl class="simple">
<dt>rac{partial f}{partial x} </dt><dd><p>-J = log det</p>
</dd>
<dt>rac{partial f^{-1}}{partial z}.</dt><dd><p>$$$
Any subclass MUST return $J$ for forward evaluation (<cite>rev=False</cite>),
and $-J$ for backward evaluation (<cite>rev=True</cite>).</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x_or_z</strong> – input data (array-like of one or more tensors)</p></li>
<li><p><strong>c</strong> – conditioning data (array-like of none or more tensors)</p></li>
<li><p><strong>rev</strong> – perform backward pass</p></li>
<li><p><strong>jac</strong> – return Jacobian associated to the direction</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="FrEIA.modules.InvAutoAct.output_dims">
<code class="sig-name descname"><span class="pre">output_dims</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_dims</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/inv_auto_layers.html#InvAutoAct.output_dims"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#FrEIA.modules.InvAutoAct.output_dims" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="FrEIA.modules.InvAutoAct.training">
<code class="sig-name descname"><span class="pre">training</span></code><em class="property"><span class="pre">:</span> <span class="pre">bool</span></em><a class="headerlink" href="#FrEIA.modules.InvAutoAct.training" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="FrEIA.modules.InvAutoActFixed">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">FrEIA.modules.</span></code><code class="sig-name descname"><span class="pre">InvAutoActFixed</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dims_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dims_c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/inv_auto_layers.html#InvAutoActFixed"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#FrEIA.modules.InvAutoActFixed" title="Permalink to this definition">¶</a></dt>
<dd><dl class="py method">
<dt id="FrEIA.modules.InvAutoActFixed.__init__">
<code class="sig-name descname"><span class="pre">__init__</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dims_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dims_c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/inv_auto_layers.html#InvAutoActFixed.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#FrEIA.modules.InvAutoActFixed.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Initializes internal Module state, shared by both nn.Module and ScriptModule.</p>
</dd></dl>

<dl class="py attribute">
<dt id="FrEIA.modules.InvAutoActFixed.__module__">
<code class="sig-name descname"><span class="pre">__module__</span></code><em class="property"> <span class="pre">=</span> <span class="pre">'FrEIA.modules.inv_auto_layers'</span></em><a class="headerlink" href="#FrEIA.modules.InvAutoActFixed.__module__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="FrEIA.modules.InvAutoActFixed.forward">
<code class="sig-name descname"><span class="pre">forward</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jac</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/inv_auto_layers.html#InvAutoActFixed.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#FrEIA.modules.InvAutoActFixed.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

<dl class="py method">
<dt id="FrEIA.modules.InvAutoActFixed.output_dims">
<code class="sig-name descname"><span class="pre">output_dims</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_dims</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/inv_auto_layers.html#InvAutoActFixed.output_dims"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#FrEIA.modules.InvAutoActFixed.output_dims" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="FrEIA.modules.InvAutoActFixed.training">
<code class="sig-name descname"><span class="pre">training</span></code><em class="property"><span class="pre">:</span> <span class="pre">bool</span></em><a class="headerlink" href="#FrEIA.modules.InvAutoActFixed.training" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="FrEIA.modules.InvAutoActTwoSided">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">FrEIA.modules.</span></code><code class="sig-name descname"><span class="pre">InvAutoActTwoSided</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dims_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dims_c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clamp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/inv_auto_layers.html#InvAutoActTwoSided"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#FrEIA.modules.InvAutoActTwoSided" title="Permalink to this definition">¶</a></dt>
<dd><dl class="py method">
<dt id="FrEIA.modules.InvAutoActTwoSided.__init__">
<code class="sig-name descname"><span class="pre">__init__</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dims_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dims_c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clamp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/inv_auto_layers.html#InvAutoActTwoSided.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#FrEIA.modules.InvAutoActTwoSided.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Parameters:
dims_in: list of tuples specifying the shape of the inputs to this</p>
<blockquote>
<div><p>operator: dims_in = [shape_x_0, shape_x_1, …]</p>
</div></blockquote>
<dl class="simple">
<dt>dims_c:  list of tuples specifying the shape of the conditions to</dt><dd><p>this operator.</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="FrEIA.modules.InvAutoActTwoSided.__module__">
<code class="sig-name descname"><span class="pre">__module__</span></code><em class="property"> <span class="pre">=</span> <span class="pre">'FrEIA.modules.inv_auto_layers'</span></em><a class="headerlink" href="#FrEIA.modules.InvAutoActTwoSided.__module__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="FrEIA.modules.InvAutoActTwoSided.e">
<code class="sig-name descname"><span class="pre">e</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/inv_auto_layers.html#InvAutoActTwoSided.e"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#FrEIA.modules.InvAutoActTwoSided.e" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="FrEIA.modules.InvAutoActTwoSided.forward">
<code class="sig-name descname"><span class="pre">forward</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jac</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/inv_auto_layers.html#InvAutoActTwoSided.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#FrEIA.modules.InvAutoActTwoSided.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform a forward (default, <cite>rev=False</cite>) or backward pass (<cite>rev=True</cite>)
through this module/operator.</p>
<p><em>Note to implementers:</em>
- Subclasses MUST return a Jacobian when jac=True, but CAN return a</p>
<blockquote>
<div><p>valid Jacobian when jac=False (not punished). The latter is only recommended
if the computation of the Jacobian is trivial.</p>
</div></blockquote>
<ul class="simple">
<li><p>Subclasses MUST follow the convention that the returned Jacobian be
consistent with the evaluation direction. Let’s make this more precise:
Let $f$ be the function that the subclass represents. Then:
$$$
J = log det</p></li>
</ul>
<dl class="simple">
<dt>rac{partial f}{partial x} </dt><dd><p>-J = log det</p>
</dd>
<dt>rac{partial f^{-1}}{partial z}.</dt><dd><p>$$$
Any subclass MUST return $J$ for forward evaluation (<cite>rev=False</cite>),
and $-J$ for backward evaluation (<cite>rev=True</cite>).</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x_or_z</strong> – input data (array-like of one or more tensors)</p></li>
<li><p><strong>c</strong> – conditioning data (array-like of none or more tensors)</p></li>
<li><p><strong>rev</strong> – perform backward pass</p></li>
<li><p><strong>jac</strong> – return Jacobian associated to the direction</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="FrEIA.modules.InvAutoActTwoSided.log_e">
<code class="sig-name descname"><span class="pre">log_e</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/inv_auto_layers.html#InvAutoActTwoSided.log_e"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#FrEIA.modules.InvAutoActTwoSided.log_e" title="Permalink to this definition">¶</a></dt>
<dd><p>log of the nonlinear function e</p>
</dd></dl>

<dl class="py method">
<dt id="FrEIA.modules.InvAutoActTwoSided.output_dims">
<code class="sig-name descname"><span class="pre">output_dims</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_dims</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/inv_auto_layers.html#InvAutoActTwoSided.output_dims"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#FrEIA.modules.InvAutoActTwoSided.output_dims" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="FrEIA.modules.InvAutoActTwoSided.training">
<code class="sig-name descname"><span class="pre">training</span></code><em class="property"><span class="pre">:</span> <span class="pre">bool</span></em><a class="headerlink" href="#FrEIA.modules.InvAutoActTwoSided.training" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="FrEIA.modules.InvAutoConv2D">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">FrEIA.modules.</span></code><code class="sig-name descname"><span class="pre">InvAutoConv2D</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dims_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dims_c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dims_out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padding</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/inv_auto_layers.html#InvAutoConv2D"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#FrEIA.modules.InvAutoConv2D" title="Permalink to this definition">¶</a></dt>
<dd><dl class="py method">
<dt id="FrEIA.modules.InvAutoConv2D.__init__">
<code class="sig-name descname"><span class="pre">__init__</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dims_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dims_c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dims_out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padding</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/inv_auto_layers.html#InvAutoConv2D.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#FrEIA.modules.InvAutoConv2D.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Parameters:
dims_in: list of tuples specifying the shape of the inputs to this</p>
<blockquote>
<div><p>operator: dims_in = [shape_x_0, shape_x_1, …]</p>
</div></blockquote>
<dl class="simple">
<dt>dims_c:  list of tuples specifying the shape of the conditions to</dt><dd><p>this operator.</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="FrEIA.modules.InvAutoConv2D.__module__">
<code class="sig-name descname"><span class="pre">__module__</span></code><em class="property"> <span class="pre">=</span> <span class="pre">'FrEIA.modules.inv_auto_layers'</span></em><a class="headerlink" href="#FrEIA.modules.InvAutoConv2D.__module__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="FrEIA.modules.InvAutoConv2D.forward">
<code class="sig-name descname"><span class="pre">forward</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jac</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/inv_auto_layers.html#InvAutoConv2D.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#FrEIA.modules.InvAutoConv2D.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform a forward (default, <cite>rev=False</cite>) or backward pass (<cite>rev=True</cite>)
through this module/operator.</p>
<p><em>Note to implementers:</em>
- Subclasses MUST return a Jacobian when jac=True, but CAN return a</p>
<blockquote>
<div><p>valid Jacobian when jac=False (not punished). The latter is only recommended
if the computation of the Jacobian is trivial.</p>
</div></blockquote>
<ul class="simple">
<li><p>Subclasses MUST follow the convention that the returned Jacobian be
consistent with the evaluation direction. Let’s make this more precise:
Let $f$ be the function that the subclass represents. Then:
$$$
J = log det</p></li>
</ul>
<dl class="simple">
<dt>rac{partial f}{partial x} </dt><dd><p>-J = log det</p>
</dd>
<dt>rac{partial f^{-1}}{partial z}.</dt><dd><p>$$$
Any subclass MUST return $J$ for forward evaluation (<cite>rev=False</cite>),
and $-J$ for backward evaluation (<cite>rev=True</cite>).</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x_or_z</strong> – input data (array-like of one or more tensors)</p></li>
<li><p><strong>c</strong> – conditioning data (array-like of none or more tensors)</p></li>
<li><p><strong>rev</strong> – perform backward pass</p></li>
<li><p><strong>jac</strong> – return Jacobian associated to the direction</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="FrEIA.modules.InvAutoConv2D.output_dims">
<code class="sig-name descname"><span class="pre">output_dims</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_dims</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/inv_auto_layers.html#InvAutoConv2D.output_dims"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#FrEIA.modules.InvAutoConv2D.output_dims" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="FrEIA.modules.InvAutoConv2D.training">
<code class="sig-name descname"><span class="pre">training</span></code><em class="property"><span class="pre">:</span> <span class="pre">bool</span></em><a class="headerlink" href="#FrEIA.modules.InvAutoConv2D.training" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="FrEIA.modules.InvAutoFC">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">FrEIA.modules.</span></code><code class="sig-name descname"><span class="pre">InvAutoFC</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dims_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dims_c</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dims_out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/inv_auto_layers.html#InvAutoFC"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#FrEIA.modules.InvAutoFC" title="Permalink to this definition">¶</a></dt>
<dd><dl class="py method">
<dt id="FrEIA.modules.InvAutoFC.__init__">
<code class="sig-name descname"><span class="pre">__init__</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dims_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dims_c</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dims_out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/inv_auto_layers.html#InvAutoFC.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#FrEIA.modules.InvAutoFC.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Parameters:
dims_in: list of tuples specifying the shape of the inputs to this</p>
<blockquote>
<div><p>operator: dims_in = [shape_x_0, shape_x_1, …]</p>
</div></blockquote>
<dl class="simple">
<dt>dims_c:  list of tuples specifying the shape of the conditions to</dt><dd><p>this operator.</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="FrEIA.modules.InvAutoFC.__module__">
<code class="sig-name descname"><span class="pre">__module__</span></code><em class="property"> <span class="pre">=</span> <span class="pre">'FrEIA.modules.inv_auto_layers'</span></em><a class="headerlink" href="#FrEIA.modules.InvAutoFC.__module__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="FrEIA.modules.InvAutoFC.forward">
<code class="sig-name descname"><span class="pre">forward</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jac</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/inv_auto_layers.html#InvAutoFC.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#FrEIA.modules.InvAutoFC.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform a forward (default, <cite>rev=False</cite>) or backward pass (<cite>rev=True</cite>)
through this module/operator.</p>
<p><em>Note to implementers:</em>
- Subclasses MUST return a Jacobian when jac=True, but CAN return a</p>
<blockquote>
<div><p>valid Jacobian when jac=False (not punished). The latter is only recommended
if the computation of the Jacobian is trivial.</p>
</div></blockquote>
<ul class="simple">
<li><p>Subclasses MUST follow the convention that the returned Jacobian be
consistent with the evaluation direction. Let’s make this more precise:
Let $f$ be the function that the subclass represents. Then:
$$$
J = log det</p></li>
</ul>
<dl class="simple">
<dt>rac{partial f}{partial x} </dt><dd><p>-J = log det</p>
</dd>
<dt>rac{partial f^{-1}}{partial z}.</dt><dd><p>$$$
Any subclass MUST return $J$ for forward evaluation (<cite>rev=False</cite>),
and $-J$ for backward evaluation (<cite>rev=True</cite>).</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x_or_z</strong> – input data (array-like of one or more tensors)</p></li>
<li><p><strong>c</strong> – conditioning data (array-like of none or more tensors)</p></li>
<li><p><strong>rev</strong> – perform backward pass</p></li>
<li><p><strong>jac</strong> – return Jacobian associated to the direction</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="FrEIA.modules.InvAutoFC.output_dims">
<code class="sig-name descname"><span class="pre">output_dims</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_dims</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/inv_auto_layers.html#InvAutoFC.output_dims"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#FrEIA.modules.InvAutoFC.output_dims" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="FrEIA.modules.InvAutoFC.training">
<code class="sig-name descname"><span class="pre">training</span></code><em class="property"><span class="pre">:</span> <span class="pre">bool</span></em><a class="headerlink" href="#FrEIA.modules.InvAutoFC.training" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="FrEIA.modules.InvertibleModule">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">FrEIA.modules.</span></code><code class="sig-name descname"><span class="pre">InvertibleModule</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dims_in</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Iterable</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dims_c</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Iterable</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/base.html#InvertibleModule"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#FrEIA.modules.InvertibleModule" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Base class for all invertible modules in FrEIA.</p>
<p>Given <cite>module</cite>, an instance of some InvertibleOperator.
This <cite>module</cite> shall be invertible in its input dimensions,
so that the input can be recovered by applying the module
in backwards mode (<cite>rev=True</cite>), not to be confused with
<cite>pytorch.backward()</cite> which computes the gradient of an operation.
<a href="#id1"><span class="problematic" id="id2">``</span></a>`
x = torch.randn(BATCH_SIZE, DIM_COUNT)
c = torch.randn(BATCH_SIZE, CONDITION_DIM)</p>
<p># Forward mode
z, jac = module([x], [c], jac=True)</p>
<p># Backward mode
x_rev, jac_rev = module(z, [c], rev=True, jac=True)
<a href="#id3"><span class="problematic" id="id4">``</span></a>`
The <cite>module</cite> returns $log det J = log det</p>
</div></blockquote>
<dl class="simple">
<dt>rac{partial f}{partial x}$</dt><dd><p>of the operation in forward mode, and
$-log det J = log det</p>
</dd>
</dl>
<p>rac{partial f^{-1}}{partial z} = -log det
rac{partial f}{partial x}$</p>
<blockquote>
<div><p>in backward mode (<cite>rev=True</cite>).</p>
<p>Then, <cite>torch.allclose(x, x_rev[0]) == True</cite> and <cite>jac == -jac_rev</cite>.</p>
</div></blockquote>
<dl class="py method">
<dt id="FrEIA.modules.InvertibleModule.__init__">
<code class="sig-name descname"><span class="pre">__init__</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dims_in</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Iterable</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dims_c</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Iterable</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/base.html#InvertibleModule.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#FrEIA.modules.InvertibleModule.__init__" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dims_in</strong> – list of tuples specifying the shape of the inputs to this
operator: dims_in = [shape_x_0, shape_x_1, …]</p></li>
<li><p><strong>dims_c</strong> – list of tuples specifying the shape of the conditions to
this operator.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="FrEIA.modules.InvertibleModule.__module__">
<code class="sig-name descname"><span class="pre">__module__</span></code><em class="property"> <span class="pre">=</span> <span class="pre">'FrEIA.modules.base'</span></em><a class="headerlink" href="#FrEIA.modules.InvertibleModule.__module__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="FrEIA.modules.InvertibleModule.forward">
<code class="sig-name descname"><span class="pre">forward</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_or_z</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Iterable</span><span class="p"><span class="pre">[</span></span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Iterable</span><span class="p"><span class="pre">[</span></span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rev</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jac</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span> </span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span><a class="reference internal" href="_modules/FrEIA/modules/base.html#InvertibleModule.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#FrEIA.modules.InvertibleModule.forward" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Perform a forward (default, <cite>rev=False</cite>) or backward pass (<cite>rev=True</cite>)
through this module/operator.</p>
<p><em>Note to implementers:</em>
- Subclasses MUST return a Jacobian when jac=True, but CAN return a</p>
<blockquote>
<div><p>valid Jacobian when jac=False (not punished). The latter is only recommended
if the computation of the Jacobian is trivial.</p>
</div></blockquote>
<ul class="simple">
<li><p>Subclasses MUST follow the convention that the returned Jacobian be
consistent with the evaluation direction. Let’s make this more precise:
Let $f$ be the function that the subclass represents. Then:
$$$
J = log det</p></li>
</ul>
</div></blockquote>
<dl>
<dt>rac{partial f}{partial x} </dt><dd><p>-J = log det</p>
</dd>
<dt>rac{partial f^{-1}}{partial z}.</dt><dd><blockquote>
<div><p>$$$
Any subclass MUST return $J$ for forward evaluation (<cite>rev=False</cite>),
and $-J$ for backward evaluation (<cite>rev=True</cite>).</p>
</div></blockquote>
<dl class="simple">
<dt>Parameters:</dt><dd><p>x_or_z: input data (array-like of one or more tensors)
c:      conditioning data (array-like of none or more tensors)
rev:    perform backward pass
jac:    return Jacobian associated to the direction</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="FrEIA.modules.InvertibleModule.jacobian">
<code class="sig-name descname"><span class="pre">jacobian</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/base.html#InvertibleModule.jacobian"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#FrEIA.modules.InvertibleModule.jacobian" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="FrEIA.modules.InvertibleModule.output_dims">
<code class="sig-name descname"><span class="pre">output_dims</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_dims</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><a class="reference internal" href="_modules/FrEIA/modules/base.html#InvertibleModule.output_dims"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#FrEIA.modules.InvertibleModule.output_dims" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="FrEIA.modules.InvertibleModule.training">
<code class="sig-name descname"><span class="pre">training</span></code><em class="property"><span class="pre">:</span> <span class="pre">bool</span></em><a class="headerlink" href="#FrEIA.modules.InvertibleModule.training" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="FrEIA.modules.LearnedElementwiseScaling">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">FrEIA.modules.</span></code><code class="sig-name descname"><span class="pre">LearnedElementwiseScaling</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dims_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dims_c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/inv_auto_layers.html#LearnedElementwiseScaling"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#FrEIA.modules.LearnedElementwiseScaling" title="Permalink to this definition">¶</a></dt>
<dd><dl class="py method">
<dt id="FrEIA.modules.LearnedElementwiseScaling.__init__">
<code class="sig-name descname"><span class="pre">__init__</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dims_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dims_c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/inv_auto_layers.html#LearnedElementwiseScaling.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#FrEIA.modules.LearnedElementwiseScaling.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Parameters:
dims_in: list of tuples specifying the shape of the inputs to this</p>
<blockquote>
<div><p>operator: dims_in = [shape_x_0, shape_x_1, …]</p>
</div></blockquote>
<dl class="simple">
<dt>dims_c:  list of tuples specifying the shape of the conditions to</dt><dd><p>this operator.</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="FrEIA.modules.LearnedElementwiseScaling.__module__">
<code class="sig-name descname"><span class="pre">__module__</span></code><em class="property"> <span class="pre">=</span> <span class="pre">'FrEIA.modules.inv_auto_layers'</span></em><a class="headerlink" href="#FrEIA.modules.LearnedElementwiseScaling.__module__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="FrEIA.modules.LearnedElementwiseScaling.forward">
<code class="sig-name descname"><span class="pre">forward</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jac</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/inv_auto_layers.html#LearnedElementwiseScaling.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#FrEIA.modules.LearnedElementwiseScaling.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform a forward (default, <cite>rev=False</cite>) or backward pass (<cite>rev=True</cite>)
through this module/operator.</p>
<p><em>Note to implementers:</em>
- Subclasses MUST return a Jacobian when jac=True, but CAN return a</p>
<blockquote>
<div><p>valid Jacobian when jac=False (not punished). The latter is only recommended
if the computation of the Jacobian is trivial.</p>
</div></blockquote>
<ul class="simple">
<li><p>Subclasses MUST follow the convention that the returned Jacobian be
consistent with the evaluation direction. Let’s make this more precise:
Let $f$ be the function that the subclass represents. Then:
$$$
J = log det</p></li>
</ul>
<dl class="simple">
<dt>rac{partial f}{partial x} </dt><dd><p>-J = log det</p>
</dd>
<dt>rac{partial f^{-1}}{partial z}.</dt><dd><p>$$$
Any subclass MUST return $J$ for forward evaluation (<cite>rev=False</cite>),
and $-J$ for backward evaluation (<cite>rev=True</cite>).</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x_or_z</strong> – input data (array-like of one or more tensors)</p></li>
<li><p><strong>c</strong> – conditioning data (array-like of none or more tensors)</p></li>
<li><p><strong>rev</strong> – perform backward pass</p></li>
<li><p><strong>jac</strong> – return Jacobian associated to the direction</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="FrEIA.modules.LearnedElementwiseScaling.output_dims">
<code class="sig-name descname"><span class="pre">output_dims</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_dims</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/inv_auto_layers.html#LearnedElementwiseScaling.output_dims"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#FrEIA.modules.LearnedElementwiseScaling.output_dims" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="FrEIA.modules.LearnedElementwiseScaling.training">
<code class="sig-name descname"><span class="pre">training</span></code><em class="property"><span class="pre">:</span> <span class="pre">bool</span></em><a class="headerlink" href="#FrEIA.modules.LearnedElementwiseScaling.training" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="FrEIA.modules.NICECouplingBlock">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">FrEIA.modules.</span></code><code class="sig-name descname"><span class="pre">NICECouplingBlock</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dims_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dims_c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subnet_constructor</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">callable</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/coupling_layers.html#NICECouplingBlock"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#FrEIA.modules.NICECouplingBlock" title="Permalink to this definition">¶</a></dt>
<dd><p>Coupling Block following the NICE (Dinh et al, 2015) design.
The inputs are split in two halves. For 2D, 3D, 4D inputs, the split is
performed along the channel dimension. Then, residual coefficients are
predicted by two subnetworks that are added to each half in turn.</p>
<dl class="py method">
<dt id="FrEIA.modules.NICECouplingBlock.__init__">
<code class="sig-name descname"><span class="pre">__init__</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dims_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dims_c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subnet_constructor</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">callable</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/coupling_layers.html#NICECouplingBlock.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#FrEIA.modules.NICECouplingBlock.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Additional args in docstring of base class.
:param subnet_constructor: Callable function, class, or factory object, with signature</p>
<blockquote>
<div><p>constructor(dims_in, dims_out). The result should be a torch
nn.Module, that takes dims_in input channels, and dims_out output
channels. See tutorial for examples.
Two of these subnetworks will be initialized inside the block.</p>
</div></blockquote>
</dd></dl>

<dl class="py attribute">
<dt id="FrEIA.modules.NICECouplingBlock.__module__">
<code class="sig-name descname"><span class="pre">__module__</span></code><em class="property"> <span class="pre">=</span> <span class="pre">'FrEIA.modules.coupling_layers'</span></em><a class="headerlink" href="#FrEIA.modules.NICECouplingBlock.__module__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="FrEIA.modules.NICECouplingBlock.training">
<code class="sig-name descname"><span class="pre">training</span></code><em class="property"><span class="pre">:</span> <span class="pre">bool</span></em><a class="headerlink" href="#FrEIA.modules.NICECouplingBlock.training" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="FrEIA.modules.OrthogonalTransform">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">FrEIA.modules.</span></code><code class="sig-name descname"><span class="pre">OrthogonalTransform</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dims_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dims_c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">correction_interval</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">256</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clamp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/orthogonal.html#OrthogonalTransform"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#FrEIA.modules.OrthogonalTransform" title="Permalink to this definition">¶</a></dt>
<dd><dl class="py method">
<dt id="FrEIA.modules.OrthogonalTransform.__init__">
<code class="sig-name descname"><span class="pre">__init__</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dims_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dims_c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">correction_interval</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">256</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clamp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/orthogonal.html#OrthogonalTransform.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#FrEIA.modules.OrthogonalTransform.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Parameters:
dims_in: list of tuples specifying the shape of the inputs to this</p>
<blockquote>
<div><p>operator: dims_in = [shape_x_0, shape_x_1, …]</p>
</div></blockquote>
<dl class="simple">
<dt>dims_c:  list of tuples specifying the shape of the conditions to</dt><dd><p>this operator.</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="FrEIA.modules.OrthogonalTransform.__module__">
<code class="sig-name descname"><span class="pre">__module__</span></code><em class="property"> <span class="pre">=</span> <span class="pre">'FrEIA.modules.orthogonal'</span></em><a class="headerlink" href="#FrEIA.modules.OrthogonalTransform.__module__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="FrEIA.modules.OrthogonalTransform.e">
<code class="sig-name descname"><span class="pre">e</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/orthogonal.html#OrthogonalTransform.e"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#FrEIA.modules.OrthogonalTransform.e" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="FrEIA.modules.OrthogonalTransform.forward">
<code class="sig-name descname"><span class="pre">forward</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jac</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/orthogonal.html#OrthogonalTransform.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#FrEIA.modules.OrthogonalTransform.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform a forward (default, <cite>rev=False</cite>) or backward pass (<cite>rev=True</cite>)
through this module/operator.</p>
<p><em>Note to implementers:</em>
- Subclasses MUST return a Jacobian when jac=True, but CAN return a</p>
<blockquote>
<div><p>valid Jacobian when jac=False (not punished). The latter is only recommended
if the computation of the Jacobian is trivial.</p>
</div></blockquote>
<ul class="simple">
<li><p>Subclasses MUST follow the convention that the returned Jacobian be
consistent with the evaluation direction. Let’s make this more precise:
Let $f$ be the function that the subclass represents. Then:
$$$
J = log det</p></li>
</ul>
<dl class="simple">
<dt>rac{partial f}{partial x} </dt><dd><p>-J = log det</p>
</dd>
<dt>rac{partial f^{-1}}{partial z}.</dt><dd><p>$$$
Any subclass MUST return $J$ for forward evaluation (<cite>rev=False</cite>),
and $-J$ for backward evaluation (<cite>rev=True</cite>).</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x_or_z</strong> – input data (array-like of one or more tensors)</p></li>
<li><p><strong>c</strong> – conditioning data (array-like of none or more tensors)</p></li>
<li><p><strong>rev</strong> – perform backward pass</p></li>
<li><p><strong>jac</strong> – return Jacobian associated to the direction</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="FrEIA.modules.OrthogonalTransform.log_e">
<code class="sig-name descname"><span class="pre">log_e</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/orthogonal.html#OrthogonalTransform.log_e"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#FrEIA.modules.OrthogonalTransform.log_e" title="Permalink to this definition">¶</a></dt>
<dd><p>log of the nonlinear function e</p>
</dd></dl>

<dl class="py method">
<dt id="FrEIA.modules.OrthogonalTransform.output_dims">
<code class="sig-name descname"><span class="pre">output_dims</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_dims</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/orthogonal.html#OrthogonalTransform.output_dims"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#FrEIA.modules.OrthogonalTransform.output_dims" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="FrEIA.modules.OrthogonalTransform.training">
<code class="sig-name descname"><span class="pre">training</span></code><em class="property"><span class="pre">:</span> <span class="pre">bool</span></em><a class="headerlink" href="#FrEIA.modules.OrthogonalTransform.training" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="FrEIA.modules.PermuteRandom">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">FrEIA.modules.</span></code><code class="sig-name descname"><span class="pre">PermuteRandom</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dims_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dims_c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/fixed_transforms.html#PermuteRandom"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#FrEIA.modules.PermuteRandom" title="Permalink to this definition">¶</a></dt>
<dd><p>permutes input vector in a random but fixed way</p>
<dl class="py method">
<dt id="FrEIA.modules.PermuteRandom.__init__">
<code class="sig-name descname"><span class="pre">__init__</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dims_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dims_c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/fixed_transforms.html#PermuteRandom.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#FrEIA.modules.PermuteRandom.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Parameters:
dims_in: list of tuples specifying the shape of the inputs to this</p>
<blockquote>
<div><p>operator: dims_in = [shape_x_0, shape_x_1, …]</p>
</div></blockquote>
<dl class="simple">
<dt>dims_c:  list of tuples specifying the shape of the conditions to</dt><dd><p>this operator.</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="FrEIA.modules.PermuteRandom.__module__">
<code class="sig-name descname"><span class="pre">__module__</span></code><em class="property"> <span class="pre">=</span> <span class="pre">'FrEIA.modules.fixed_transforms'</span></em><a class="headerlink" href="#FrEIA.modules.PermuteRandom.__module__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="FrEIA.modules.PermuteRandom.forward">
<code class="sig-name descname"><span class="pre">forward</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jac</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/fixed_transforms.html#PermuteRandom.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#FrEIA.modules.PermuteRandom.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform a forward (default, <cite>rev=False</cite>) or backward pass (<cite>rev=True</cite>)
through this module/operator.</p>
<p><em>Note to implementers:</em>
- Subclasses MUST return a Jacobian when jac=True, but CAN return a</p>
<blockquote>
<div><p>valid Jacobian when jac=False (not punished). The latter is only recommended
if the computation of the Jacobian is trivial.</p>
</div></blockquote>
<ul class="simple">
<li><p>Subclasses MUST follow the convention that the returned Jacobian be
consistent with the evaluation direction. Let’s make this more precise:
Let $f$ be the function that the subclass represents. Then:
$$$
J = log det</p></li>
</ul>
<dl class="simple">
<dt>rac{partial f}{partial x} </dt><dd><p>-J = log det</p>
</dd>
<dt>rac{partial f^{-1}}{partial z}.</dt><dd><p>$$$
Any subclass MUST return $J$ for forward evaluation (<cite>rev=False</cite>),
and $-J$ for backward evaluation (<cite>rev=True</cite>).</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x_or_z</strong> – input data (array-like of one or more tensors)</p></li>
<li><p><strong>c</strong> – conditioning data (array-like of none or more tensors)</p></li>
<li><p><strong>rev</strong> – perform backward pass</p></li>
<li><p><strong>jac</strong> – return Jacobian associated to the direction</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="FrEIA.modules.PermuteRandom.output_dims">
<code class="sig-name descname"><span class="pre">output_dims</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_dims</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/fixed_transforms.html#PermuteRandom.output_dims"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#FrEIA.modules.PermuteRandom.output_dims" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="FrEIA.modules.PermuteRandom.training">
<code class="sig-name descname"><span class="pre">training</span></code><em class="property"><span class="pre">:</span> <span class="pre">bool</span></em><a class="headerlink" href="#FrEIA.modules.PermuteRandom.training" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="FrEIA.modules.RNVPCouplingBlock">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">FrEIA.modules.</span></code><code class="sig-name descname"><span class="pre">RNVPCouplingBlock</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dims_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dims_c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subnet_constructor</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Callable</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clamp</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">2.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clamp_activation</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span> </span><span class="pre">Callable</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">'ATAN'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/coupling_layers.html#RNVPCouplingBlock"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#FrEIA.modules.RNVPCouplingBlock" title="Permalink to this definition">¶</a></dt>
<dd><p>Coupling Block following the RealNVP design (Dinh et al, 2017) with some
minor differences. The inputs are split in two halves. For 2D, 3D, 4D
inputs, the split is performed along the channel dimension. For
checkerboard-splitting, prepend an i_RevNet_downsampling module. Two affine
coupling operations are performed in turn on both halves of the input.</p>
<dl class="py method">
<dt id="FrEIA.modules.RNVPCouplingBlock.__init__">
<code class="sig-name descname"><span class="pre">__init__</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dims_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dims_c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subnet_constructor</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Callable</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clamp</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">2.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clamp_activation</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span> </span><span class="pre">Callable</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">'ATAN'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/coupling_layers.html#RNVPCouplingBlock.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#FrEIA.modules.RNVPCouplingBlock.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Additional args in docstring of base class.
:param subnet_constructor: function or class, with signature</p>
<blockquote>
<div><p>constructor(dims_in, dims_out).  The result should be a torch
nn.Module, that takes dims_in input channels, and dims_out output
channels. See tutorial for examples. Four of these subnetworks will be
initialized in the block.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>clamp</strong> – Soft clamping for the multiplicative component. The
amplification or attenuation of each input dimension can be at most
exp(±clamp).</p></li>
<li><p><strong>clamp_activation</strong> – Function to perform the clamping. String values
“ATAN”, “TANH”, and “SIGMOID” are recognized, or a function of
object can be passed. TANH behaves like the original realNVP paper.
A custom function should take tensors and map -inf to -1 and +inf to +1.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="FrEIA.modules.RNVPCouplingBlock.__module__">
<code class="sig-name descname"><span class="pre">__module__</span></code><em class="property"> <span class="pre">=</span> <span class="pre">'FrEIA.modules.coupling_layers'</span></em><a class="headerlink" href="#FrEIA.modules.RNVPCouplingBlock.__module__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="FrEIA.modules.RNVPCouplingBlock.training">
<code class="sig-name descname"><span class="pre">training</span></code><em class="property"><span class="pre">:</span> <span class="pre">bool</span></em><a class="headerlink" href="#FrEIA.modules.RNVPCouplingBlock.training" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="FrEIA.modules.Reshape">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">FrEIA.modules.</span></code><code class="sig-name descname"><span class="pre">Reshape</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dims_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dims_c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_dims</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Iterable</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/reshapes.html#Reshape"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#FrEIA.modules.Reshape" title="Permalink to this definition">¶</a></dt>
<dd><p>Reshapes N-D tensors into target dim tensors. Note that the reshape resulting from
e.g. (3, 32, 32) -&gt; (12, 16, 16) will not necessarily be spatially sensible.
See IRevNetDownsampling, IRevNetUpsampling, HaarDownsampling, HaarUpsampling
for spatially meaningful reshaping operations.</p>
<dl class="py method">
<dt id="FrEIA.modules.Reshape.__init__">
<code class="sig-name descname"><span class="pre">__init__</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dims_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dims_c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_dims</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Iterable</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/reshapes.html#Reshape.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#FrEIA.modules.Reshape.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>See docstring of base class (FrEIA.modules.InvertibleModule) for more.
:param output_dims: The shape the reshaped output is supposed to have (not</p>
<blockquote>
<div><p>including batch dimension)</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>target_dim</strong> – Deprecated name for output_dims</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="FrEIA.modules.Reshape.__module__">
<code class="sig-name descname"><span class="pre">__module__</span></code><em class="property"> <span class="pre">=</span> <span class="pre">'FrEIA.modules.reshapes'</span></em><a class="headerlink" href="#FrEIA.modules.Reshape.__module__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="FrEIA.modules.Reshape.forward">
<code class="sig-name descname"><span class="pre">forward</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jac</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/reshapes.html#Reshape.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#FrEIA.modules.Reshape.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>See docstring of base class (FrEIA.modules.InvertibleModule).</p>
</dd></dl>

<dl class="py method">
<dt id="FrEIA.modules.Reshape.output_dims">
<code class="sig-name descname"><span class="pre">output_dims</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dim</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/reshapes.html#Reshape.output_dims"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#FrEIA.modules.Reshape.output_dims" title="Permalink to this definition">¶</a></dt>
<dd><p>See docstring of base class (FrEIA.modules.InvertibleModule).</p>
</dd></dl>

<dl class="py attribute">
<dt id="FrEIA.modules.Reshape.training">
<code class="sig-name descname"><span class="pre">training</span></code><em class="property"><span class="pre">:</span> <span class="pre">bool</span></em><a class="headerlink" href="#FrEIA.modules.Reshape.training" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="FrEIA.modules.Split">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">FrEIA.modules.</span></code><code class="sig-name descname"><span class="pre">Split</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dims_in</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">section_sizes</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span> </span><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_sections</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/graph_topology.html#Split"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#FrEIA.modules.Split" title="Permalink to this definition">¶</a></dt>
<dd><p>Invertible split operation.</p>
<p>Splits the incoming tensor along the given dimension, and returns a list of
separate output tensors. The inverse is the corresponding merge operation.</p>
<dl class="py attribute">
<dt id="FrEIA.modules.Split.dims_in">
<code class="sig-name descname"><span class="pre">dims_in</span></code><a class="headerlink" href="#FrEIA.modules.Split.dims_in" title="Permalink to this definition">¶</a></dt>
<dd><p>A list of tuples containing the non-batch dimensionality of all
incoming tensors. Handled automatically during compute graph setup.
Split only takes one input tensor.</p>
</dd></dl>

<dl class="py attribute">
<dt id="FrEIA.modules.Split.section_sizes">
<code class="sig-name descname"><span class="pre">section_sizes</span></code><a class="headerlink" href="#FrEIA.modules.Split.section_sizes" title="Permalink to this definition">¶</a></dt>
<dd><p>If set, takes precedence over ‘n_sections’ and behaves like the
argument in torch.split(), except when a list of section sizes is given
that doesn’t add up to the size of ‘dim’, an additional split section is
created to take the slack. Defaults to None.</p>
</dd></dl>

<dl class="py attribute">
<dt id="FrEIA.modules.Split.n_sections">
<code class="sig-name descname"><span class="pre">n_sections</span></code><a class="headerlink" href="#FrEIA.modules.Split.n_sections" title="Permalink to this definition">¶</a></dt>
<dd><p>If ‘section_sizes’ is None, the tensor is split into ‘n_sections’
parts of equal size or close to it. This mode behaves like
numpy.array_split(). Defaults to 2, i.e. splitting the data into two
equal halves.</p>
</dd></dl>

<dl class="py attribute">
<dt id="FrEIA.modules.Split.dim">
<code class="sig-name descname"><span class="pre">dim</span></code><a class="headerlink" href="#FrEIA.modules.Split.dim" title="Permalink to this definition">¶</a></dt>
<dd><p>Index of the dimension along which to split, not counting the batch
dimension. Defaults to 0, i.e. the channel dimension in structured data.</p>
</dd></dl>

<dl class="py method">
<dt id="FrEIA.modules.Split.__init__">
<code class="sig-name descname"><span class="pre">__init__</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dims_in</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">section_sizes</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span> </span><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_sections</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/graph_topology.html#Split.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#FrEIA.modules.Split.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Inits the Split module with the attributes described above and
checks that split sizes and dimensionality are compatible.</p>
</dd></dl>

<dl class="py attribute">
<dt id="FrEIA.modules.Split.__module__">
<code class="sig-name descname"><span class="pre">__module__</span></code><em class="property"> <span class="pre">=</span> <span class="pre">'FrEIA.modules.graph_topology'</span></em><a class="headerlink" href="#FrEIA.modules.Split.__module__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="FrEIA.modules.Split.forward">
<code class="sig-name descname"><span class="pre">forward</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jac</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/graph_topology.html#Split.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#FrEIA.modules.Split.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>See super class InvertibleModule.
Jacobian log-det of splitting is always zero.</p>
</dd></dl>

<dl class="py method">
<dt id="FrEIA.modules.Split.output_dims">
<code class="sig-name descname"><span class="pre">output_dims</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_dims</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/graph_topology.html#Split.output_dims"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#FrEIA.modules.Split.output_dims" title="Permalink to this definition">¶</a></dt>
<dd><p>See super class InvertibleModule.</p>
</dd></dl>

<dl class="py attribute">
<dt id="FrEIA.modules.Split.training">
<code class="sig-name descname"><span class="pre">training</span></code><em class="property"><span class="pre">:</span> <span class="pre">bool</span></em><a class="headerlink" href="#FrEIA.modules.Split.training" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py attribute">
<dt id="FrEIA.modules.SplitChannel">
<code class="sig-prename descclassname"><span class="pre">FrEIA.modules.</span></code><code class="sig-name descname"><span class="pre">SplitChannel</span></code><a class="headerlink" href="#FrEIA.modules.SplitChannel" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of <code class="xref py py-class docutils literal notranslate"><span class="pre">FrEIA.modules.graph_topology._deprecated_by.&lt;locals&gt;.deprecated_class</span></code></p>
</dd></dl>

<div class="section" id="abstract-template">
<h2>Abstract template<a class="headerlink" href="#abstract-template" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="id0">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">FrEIA.modules.</span></code><code class="sig-name descname"><span class="pre">InvertibleModule</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dims_in</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Iterable</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dims_c</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Iterable</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/base.html#InvertibleModule"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id0" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Base class for all invertible modules in FrEIA.</p>
<p>Given <cite>module</cite>, an instance of some InvertibleOperator.
This <cite>module</cite> shall be invertible in its input dimensions,
so that the input can be recovered by applying the module
in backwards mode (<cite>rev=True</cite>), not to be confused with
<cite>pytorch.backward()</cite> which computes the gradient of an operation.
<a href="#id5"><span class="problematic" id="id6">``</span></a>`
x = torch.randn(BATCH_SIZE, DIM_COUNT)
c = torch.randn(BATCH_SIZE, CONDITION_DIM)</p>
<p># Forward mode
z, jac = module([x], [c], jac=True)</p>
<p># Backward mode
x_rev, jac_rev = module(z, [c], rev=True, jac=True)
<a href="#id7"><span class="problematic" id="id8">``</span></a>`
The <cite>module</cite> returns $log det J = log det</p>
</div></blockquote>
<dl class="simple">
<dt>rac{partial f}{partial x}$</dt><dd><p>of the operation in forward mode, and
$-log det J = log det</p>
</dd>
</dl>
<p>rac{partial f^{-1}}{partial z} = -log det
rac{partial f}{partial x}$</p>
<blockquote>
<div><p>in backward mode (<cite>rev=True</cite>).</p>
<p>Then, <cite>torch.allclose(x, x_rev[0]) == True</cite> and <cite>jac == -jac_rev</cite>.</p>
</div></blockquote>
<dl class="py attribute">
<dt id="FrEIA.modules.InvertibleModule.__annotations__">
<code class="sig-name descname"><span class="pre">__annotations__</span></code><em class="property"> <span class="pre">=</span> <span class="pre">{'__call__':</span> <span class="pre">typing.Callable[...,</span> <span class="pre">typing.Any],</span> <span class="pre">'_version':</span> <span class="pre">&lt;class</span> <span class="pre">'int'&gt;,</span> <span class="pre">'dump_patches':</span> <span class="pre">&lt;class</span> <span class="pre">'bool'&gt;,</span> <span class="pre">'forward':</span> <span class="pre">typing.Callable[...,</span> <span class="pre">typing.Any],</span> <span class="pre">'training':</span> <span class="pre">&lt;class</span> <span class="pre">'bool'&gt;}</span></em><a class="headerlink" href="#FrEIA.modules.InvertibleModule.__annotations__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="id9">
<code class="sig-name descname"><span class="pre">__init__</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dims_in</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Iterable</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dims_c</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Iterable</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/base.html#InvertibleModule.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id9" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dims_in</strong> – list of tuples specifying the shape of the inputs to this
operator: dims_in = [shape_x_0, shape_x_1, …]</p></li>
<li><p><strong>dims_c</strong> – list of tuples specifying the shape of the conditions to
this operator.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="id10">
<code class="sig-name descname"><span class="pre">__module__</span></code><em class="property"> <span class="pre">=</span> <span class="pre">'FrEIA.modules.base'</span></em><a class="headerlink" href="#id10" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="id11">
<code class="sig-name descname"><span class="pre">forward</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_or_z</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Iterable</span><span class="p"><span class="pre">[</span></span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Iterable</span><span class="p"><span class="pre">[</span></span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rev</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jac</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span> </span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span><a class="reference internal" href="_modules/FrEIA/modules/base.html#InvertibleModule.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id11" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Perform a forward (default, <cite>rev=False</cite>) or backward pass (<cite>rev=True</cite>)
through this module/operator.</p>
<p><em>Note to implementers:</em>
- Subclasses MUST return a Jacobian when jac=True, but CAN return a</p>
<blockquote>
<div><p>valid Jacobian when jac=False (not punished). The latter is only recommended
if the computation of the Jacobian is trivial.</p>
</div></blockquote>
<ul class="simple">
<li><p>Subclasses MUST follow the convention that the returned Jacobian be
consistent with the evaluation direction. Let’s make this more precise:
Let $f$ be the function that the subclass represents. Then:
$$$
J = log det</p></li>
</ul>
</div></blockquote>
<dl>
<dt>rac{partial f}{partial x} </dt><dd><p>-J = log det</p>
</dd>
<dt>rac{partial f^{-1}}{partial z}.</dt><dd><blockquote>
<div><p>$$$
Any subclass MUST return $J$ for forward evaluation (<cite>rev=False</cite>),
and $-J$ for backward evaluation (<cite>rev=True</cite>).</p>
</div></blockquote>
<dl class="simple">
<dt>Parameters:</dt><dd><p>x_or_z: input data (array-like of one or more tensors)
c:      conditioning data (array-like of none or more tensors)
rev:    perform backward pass
jac:    return Jacobian associated to the direction</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="id12">
<code class="sig-name descname"><span class="pre">jacobian</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/base.html#InvertibleModule.jacobian"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id12" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="id13">
<code class="sig-name descname"><span class="pre">output_dims</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_dims</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><a class="reference internal" href="_modules/FrEIA/modules/base.html#InvertibleModule.output_dims"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id13" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="id14">
<code class="sig-name descname"><span class="pre">training</span></code><em class="property"><span class="pre">:</span> <span class="pre">bool</span></em><a class="headerlink" href="#id14" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="coupling-blocks">
<h2>Coupling blocks<a class="headerlink" href="#coupling-blocks" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="id15">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">FrEIA.modules.</span></code><code class="sig-name descname"><span class="pre">InvertibleModule</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dims_in</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Iterable</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dims_c</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Iterable</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/base.html#InvertibleModule"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id15" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Base class for all invertible modules in FrEIA.</p>
<p>Given <cite>module</cite>, an instance of some InvertibleOperator.
This <cite>module</cite> shall be invertible in its input dimensions,
so that the input can be recovered by applying the module
in backwards mode (<cite>rev=True</cite>), not to be confused with
<cite>pytorch.backward()</cite> which computes the gradient of an operation.
<a href="#id16"><span class="problematic" id="id17">``</span></a>`
x = torch.randn(BATCH_SIZE, DIM_COUNT)
c = torch.randn(BATCH_SIZE, CONDITION_DIM)</p>
<p># Forward mode
z, jac = module([x], [c], jac=True)</p>
<p># Backward mode
x_rev, jac_rev = module(z, [c], rev=True, jac=True)
<a href="#id18"><span class="problematic" id="id19">``</span></a>`
The <cite>module</cite> returns $log det J = log det</p>
</div></blockquote>
<dl class="simple">
<dt>rac{partial f}{partial x}$</dt><dd><p>of the operation in forward mode, and
$-log det J = log det</p>
</dd>
</dl>
<p>rac{partial f^{-1}}{partial z} = -log det
rac{partial f}{partial x}$</p>
<blockquote>
<div><p>in backward mode (<cite>rev=True</cite>).</p>
<p>Then, <cite>torch.allclose(x, x_rev[0]) == True</cite> and <cite>jac == -jac_rev</cite>.</p>
</div></blockquote>
<dl class="py attribute">
<dt id="id20">
<code class="sig-name descname"><span class="pre">__annotations__</span></code><em class="property"> <span class="pre">=</span> <span class="pre">{'__call__':</span> <span class="pre">typing.Callable[...,</span> <span class="pre">typing.Any],</span> <span class="pre">'_version':</span> <span class="pre">&lt;class</span> <span class="pre">'int'&gt;,</span> <span class="pre">'dump_patches':</span> <span class="pre">&lt;class</span> <span class="pre">'bool'&gt;,</span> <span class="pre">'forward':</span> <span class="pre">typing.Callable[...,</span> <span class="pre">typing.Any],</span> <span class="pre">'training':</span> <span class="pre">&lt;class</span> <span class="pre">'bool'&gt;}</span></em><a class="headerlink" href="#id20" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="id21">
<code class="sig-name descname"><span class="pre">__init__</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dims_in</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Iterable</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dims_c</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Iterable</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/base.html#InvertibleModule.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id21" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dims_in</strong> – list of tuples specifying the shape of the inputs to this
operator: dims_in = [shape_x_0, shape_x_1, …]</p></li>
<li><p><strong>dims_c</strong> – list of tuples specifying the shape of the conditions to
this operator.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="id22">
<code class="sig-name descname"><span class="pre">__module__</span></code><em class="property"> <span class="pre">=</span> <span class="pre">'FrEIA.modules.base'</span></em><a class="headerlink" href="#id22" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="id23">
<code class="sig-name descname"><span class="pre">forward</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_or_z</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Iterable</span><span class="p"><span class="pre">[</span></span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Iterable</span><span class="p"><span class="pre">[</span></span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rev</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jac</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span> </span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span><a class="reference internal" href="_modules/FrEIA/modules/base.html#InvertibleModule.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id23" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Perform a forward (default, <cite>rev=False</cite>) or backward pass (<cite>rev=True</cite>)
through this module/operator.</p>
<p><em>Note to implementers:</em>
- Subclasses MUST return a Jacobian when jac=True, but CAN return a</p>
<blockquote>
<div><p>valid Jacobian when jac=False (not punished). The latter is only recommended
if the computation of the Jacobian is trivial.</p>
</div></blockquote>
<ul class="simple">
<li><p>Subclasses MUST follow the convention that the returned Jacobian be
consistent with the evaluation direction. Let’s make this more precise:
Let $f$ be the function that the subclass represents. Then:
$$$
J = log det</p></li>
</ul>
</div></blockquote>
<dl>
<dt>rac{partial f}{partial x} </dt><dd><p>-J = log det</p>
</dd>
<dt>rac{partial f^{-1}}{partial z}.</dt><dd><blockquote>
<div><p>$$$
Any subclass MUST return $J$ for forward evaluation (<cite>rev=False</cite>),
and $-J$ for backward evaluation (<cite>rev=True</cite>).</p>
</div></blockquote>
<dl class="simple">
<dt>Parameters:</dt><dd><p>x_or_z: input data (array-like of one or more tensors)
c:      conditioning data (array-like of none or more tensors)
rev:    perform backward pass
jac:    return Jacobian associated to the direction</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="id24">
<code class="sig-name descname"><span class="pre">jacobian</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/base.html#InvertibleModule.jacobian"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id24" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="id25">
<code class="sig-name descname"><span class="pre">output_dims</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_dims</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><a class="reference internal" href="_modules/FrEIA/modules/base.html#InvertibleModule.output_dims"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id25" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="id26">
<code class="sig-name descname"><span class="pre">training</span></code><em class="property"><span class="pre">:</span> <span class="pre">bool</span></em><a class="headerlink" href="#id26" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="id27">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">FrEIA.modules.</span></code><code class="sig-name descname"><span class="pre">AllInOneBlock</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dims_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dims_c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subnet_constructor</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Callable</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">affine_clamping</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">2.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gin_block</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">global_affine_init</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">global_affine_type</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">'SOFTPLUS'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">permute_soft</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">learned_householder_permutation</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reverse_permutation</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/all_in_one_block.html#AllInOneBlock"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id27" title="Permalink to this definition">¶</a></dt>
<dd><p>Module combining the most common operations in a normalizing flow or similar model.</p>
<p>It combines affine coupling, permutation, and global affine transformation
(‘ActNorm’). It can also be used as GIN coupling block, perform learned
householder permutations, and use an inverted pre-permutation (see
constructor docstring for details).</p>
<dl class="py attribute">
<dt id="FrEIA.modules.AllInOneBlock.__annotations__">
<code class="sig-name descname"><span class="pre">__annotations__</span></code><em class="property"> <span class="pre">=</span> <span class="pre">{'__call__':</span> <span class="pre">typing.Callable[...,</span> <span class="pre">typing.Any],</span> <span class="pre">'_version':</span> <span class="pre">&lt;class</span> <span class="pre">'int'&gt;,</span> <span class="pre">'dump_patches':</span> <span class="pre">&lt;class</span> <span class="pre">'bool'&gt;,</span> <span class="pre">'forward':</span> <span class="pre">typing.Callable[...,</span> <span class="pre">typing.Any],</span> <span class="pre">'training':</span> <span class="pre">&lt;class</span> <span class="pre">'bool'&gt;}</span></em><a class="headerlink" href="#FrEIA.modules.AllInOneBlock.__annotations__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="id28">
<code class="sig-name descname"><span class="pre">__init__</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dims_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dims_c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subnet_constructor</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Callable</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">affine_clamping</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">2.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gin_block</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">global_affine_init</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">global_affine_type</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">'SOFTPLUS'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">permute_soft</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">learned_householder_permutation</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reverse_permutation</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/all_in_one_block.html#AllInOneBlock.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id28" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>subnet_constructor</strong> – class or callable f, called as f(channels_in, channels_out) and
should return a torch.nn.Module</p></li>
<li><p><strong>affine_clamping</strong> – clamp the output of the multiplicative coefficients (before
exponentiation) to +/- affine_clamping.</p></li>
<li><p><strong>gin_block</strong> – Turn the block into a GIN block from Sorrenson et al, 2019</p></li>
<li><p><strong>global_affine_init</strong> – Initial value for the global affine scaling beta</p></li>
<li><p><strong>global_affine_init</strong> – ‘SIGMOID’, ‘SOFTPLUS’, or ‘EXP’. Defines the activation to be used
on the beta for the global affine scaling.</p></li>
<li><p><strong>permute_soft</strong> – bool, whether to sample the permutation matrices from SO(N), or to
use hard permutations in stead. Note, permute_soft=True is very slow
when working with &gt;512 dimensions.</p></li>
<li><p><strong>learned_householder_permutation</strong> – Int, if &gt;0,  use that many learned householder reflections. Slow if
large number. Dubious whether it actually helps.</p></li>
<li><p><strong>reverse_permutation</strong> – Reverse the permutation before the block, as introduced by Putzky
et al, 2019.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="id29">
<code class="sig-name descname"><span class="pre">__module__</span></code><em class="property"> <span class="pre">=</span> <span class="pre">'FrEIA.modules.all_in_one_block'</span></em><a class="headerlink" href="#id29" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="id30">
<code class="sig-name descname"><span class="pre">forward</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jac</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/all_in_one_block.html#AllInOneBlock.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id30" title="Permalink to this definition">¶</a></dt>
<dd><p>See base class docstring</p>
</dd></dl>

<dl class="py method">
<dt id="id31">
<code class="sig-name descname"><span class="pre">output_dims</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_dims</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/all_in_one_block.html#AllInOneBlock.output_dims"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id31" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="id32">
<code class="sig-name descname"><span class="pre">training</span></code><em class="property"><span class="pre">:</span> <span class="pre">bool</span></em><a class="headerlink" href="#id32" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="id33">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">FrEIA.modules.</span></code><code class="sig-name descname"><span class="pre">NICECouplingBlock</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dims_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dims_c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subnet_constructor</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">callable</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/coupling_layers.html#NICECouplingBlock"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id33" title="Permalink to this definition">¶</a></dt>
<dd><p>Coupling Block following the NICE (Dinh et al, 2015) design.
The inputs are split in two halves. For 2D, 3D, 4D inputs, the split is
performed along the channel dimension. Then, residual coefficients are
predicted by two subnetworks that are added to each half in turn.</p>
<dl class="py attribute">
<dt id="FrEIA.modules.NICECouplingBlock.__annotations__">
<code class="sig-name descname"><span class="pre">__annotations__</span></code><em class="property"> <span class="pre">=</span> <span class="pre">{'__call__':</span> <span class="pre">typing.Callable[...,</span> <span class="pre">typing.Any],</span> <span class="pre">'_version':</span> <span class="pre">&lt;class</span> <span class="pre">'int'&gt;,</span> <span class="pre">'dump_patches':</span> <span class="pre">&lt;class</span> <span class="pre">'bool'&gt;,</span> <span class="pre">'forward':</span> <span class="pre">typing.Callable[...,</span> <span class="pre">typing.Any],</span> <span class="pre">'training':</span> <span class="pre">&lt;class</span> <span class="pre">'bool'&gt;}</span></em><a class="headerlink" href="#FrEIA.modules.NICECouplingBlock.__annotations__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="id34">
<code class="sig-name descname"><span class="pre">__init__</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dims_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dims_c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subnet_constructor</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">callable</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/coupling_layers.html#NICECouplingBlock.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id34" title="Permalink to this definition">¶</a></dt>
<dd><p>Additional args in docstring of base class.
:param subnet_constructor: Callable function, class, or factory object, with signature</p>
<blockquote>
<div><p>constructor(dims_in, dims_out). The result should be a torch
nn.Module, that takes dims_in input channels, and dims_out output
channels. See tutorial for examples.
Two of these subnetworks will be initialized inside the block.</p>
</div></blockquote>
</dd></dl>

<dl class="py attribute">
<dt id="id35">
<code class="sig-name descname"><span class="pre">__module__</span></code><em class="property"> <span class="pre">=</span> <span class="pre">'FrEIA.modules.coupling_layers'</span></em><a class="headerlink" href="#id35" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="id36">
<code class="sig-name descname"><span class="pre">training</span></code><em class="property"><span class="pre">:</span> <span class="pre">bool</span></em><a class="headerlink" href="#id36" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="id37">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">FrEIA.modules.</span></code><code class="sig-name descname"><span class="pre">RNVPCouplingBlock</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dims_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dims_c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subnet_constructor</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Callable</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clamp</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">2.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clamp_activation</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span> </span><span class="pre">Callable</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">'ATAN'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/coupling_layers.html#RNVPCouplingBlock"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id37" title="Permalink to this definition">¶</a></dt>
<dd><p>Coupling Block following the RealNVP design (Dinh et al, 2017) with some
minor differences. The inputs are split in two halves. For 2D, 3D, 4D
inputs, the split is performed along the channel dimension. For
checkerboard-splitting, prepend an i_RevNet_downsampling module. Two affine
coupling operations are performed in turn on both halves of the input.</p>
<dl class="py attribute">
<dt id="FrEIA.modules.RNVPCouplingBlock.__annotations__">
<code class="sig-name descname"><span class="pre">__annotations__</span></code><em class="property"> <span class="pre">=</span> <span class="pre">{'__call__':</span> <span class="pre">typing.Callable[...,</span> <span class="pre">typing.Any],</span> <span class="pre">'_version':</span> <span class="pre">&lt;class</span> <span class="pre">'int'&gt;,</span> <span class="pre">'dump_patches':</span> <span class="pre">&lt;class</span> <span class="pre">'bool'&gt;,</span> <span class="pre">'forward':</span> <span class="pre">typing.Callable[...,</span> <span class="pre">typing.Any],</span> <span class="pre">'training':</span> <span class="pre">&lt;class</span> <span class="pre">'bool'&gt;}</span></em><a class="headerlink" href="#FrEIA.modules.RNVPCouplingBlock.__annotations__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="id38">
<code class="sig-name descname"><span class="pre">__init__</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dims_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dims_c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subnet_constructor</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Callable</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clamp</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">2.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clamp_activation</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span> </span><span class="pre">Callable</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">'ATAN'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/coupling_layers.html#RNVPCouplingBlock.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id38" title="Permalink to this definition">¶</a></dt>
<dd><p>Additional args in docstring of base class.
:param subnet_constructor: function or class, with signature</p>
<blockquote>
<div><p>constructor(dims_in, dims_out).  The result should be a torch
nn.Module, that takes dims_in input channels, and dims_out output
channels. See tutorial for examples. Four of these subnetworks will be
initialized in the block.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>clamp</strong> – Soft clamping for the multiplicative component. The
amplification or attenuation of each input dimension can be at most
exp(±clamp).</p></li>
<li><p><strong>clamp_activation</strong> – Function to perform the clamping. String values
“ATAN”, “TANH”, and “SIGMOID” are recognized, or a function of
object can be passed. TANH behaves like the original realNVP paper.
A custom function should take tensors and map -inf to -1 and +inf to +1.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="id39">
<code class="sig-name descname"><span class="pre">__module__</span></code><em class="property"> <span class="pre">=</span> <span class="pre">'FrEIA.modules.coupling_layers'</span></em><a class="headerlink" href="#id39" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="id40">
<code class="sig-name descname"><span class="pre">training</span></code><em class="property"><span class="pre">:</span> <span class="pre">bool</span></em><a class="headerlink" href="#id40" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="id41">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">FrEIA.modules.</span></code><code class="sig-name descname"><span class="pre">GLOWCouplingBlock</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dims_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dims_c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subnet_constructor</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Callable</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clamp</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">2.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clamp_activation</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span> </span><span class="pre">Callable</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">'ATAN'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/coupling_layers.html#GLOWCouplingBlock"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id41" title="Permalink to this definition">¶</a></dt>
<dd><p>Coupling Block following the GLOW design. Note, this is only the coupling
part itself, and does not include ActNorm, invertible 1x1 convolutions, etc.
See AllInOneBlock for a block combining these functions at once.
The only difference to the RNVPCouplingBlock coupling blocks
is that it uses a single subnetwork to jointly predict [s_i, t_i], instead of two separate
subnetworks. This reduces computational cost and speeds up learning.</p>
<dl class="py attribute">
<dt id="FrEIA.modules.GLOWCouplingBlock.__annotations__">
<code class="sig-name descname"><span class="pre">__annotations__</span></code><em class="property"> <span class="pre">=</span> <span class="pre">{'__call__':</span> <span class="pre">typing.Callable[...,</span> <span class="pre">typing.Any],</span> <span class="pre">'_version':</span> <span class="pre">&lt;class</span> <span class="pre">'int'&gt;,</span> <span class="pre">'dump_patches':</span> <span class="pre">&lt;class</span> <span class="pre">'bool'&gt;,</span> <span class="pre">'forward':</span> <span class="pre">typing.Callable[...,</span> <span class="pre">typing.Any],</span> <span class="pre">'training':</span> <span class="pre">&lt;class</span> <span class="pre">'bool'&gt;}</span></em><a class="headerlink" href="#FrEIA.modules.GLOWCouplingBlock.__annotations__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="id42">
<code class="sig-name descname"><span class="pre">__init__</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dims_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dims_c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subnet_constructor</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Callable</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clamp</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">2.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clamp_activation</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span> </span><span class="pre">Callable</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">'ATAN'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/coupling_layers.html#GLOWCouplingBlock.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id42" title="Permalink to this definition">¶</a></dt>
<dd><p>Additional args in docstring of base class.
:param subnet_constructor: function or class, with signature</p>
<blockquote>
<div><p>constructor(dims_in, dims_out).  The result should be a torch
nn.Module, that takes dims_in input channels, and dims_out output
channels. See tutorial for examples. Two of these subnetworks will be
initialized in the block.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>clamp</strong> – Soft clamping for the multiplicative component. The
amplification or attenuation of each input dimension can be at most
exp(±clamp).</p></li>
<li><p><strong>clamp_activation</strong> – Function to perform the clamping. String values
“ATAN”, “TANH”, and “SIGMOID” are recognized, or a function of
object can be passed. TANH behaves like the original realNVP paper.
A custom function should take tensors and map -inf to -1 and +inf to +1.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="id43">
<code class="sig-name descname"><span class="pre">__module__</span></code><em class="property"> <span class="pre">=</span> <span class="pre">'FrEIA.modules.coupling_layers'</span></em><a class="headerlink" href="#id43" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="id44">
<code class="sig-name descname"><span class="pre">training</span></code><em class="property"><span class="pre">:</span> <span class="pre">bool</span></em><a class="headerlink" href="#id44" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="id45">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">FrEIA.modules.</span></code><code class="sig-name descname"><span class="pre">GINCouplingBlock</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dims_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dims_c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subnet_constructor</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Callable</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clamp</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">2.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clamp_activation</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span> </span><span class="pre">Callable</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">'ATAN'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/coupling_layers.html#GINCouplingBlock"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id45" title="Permalink to this definition">¶</a></dt>
<dd><p>Coupling Block following the GIN design. The difference from
GLOWCouplingBlock (and other affine coupling blocks) is that the Jacobian
determinant is constrained to be 1.  This constrains the block to be
volume-preserving. Volume preservation is achieved by subtracting the mean
of the output of the s subnetwork from itself.  While volume preserving, GIN
is still more powerful than NICE, as GIN is not volume preserving within
each dimension.
Note: this implementation differs slightly from the originally published
implementation, which scales the final component of the s subnetwork so the
sum of the outputs of s is zero. There was no difference found between the
implementations in practice, but subtracting the mean guarantees that all
outputs of s are at most ±exp(clamp), which might be more stable in certain
cases.</p>
<dl class="py attribute">
<dt id="FrEIA.modules.GINCouplingBlock.__annotations__">
<code class="sig-name descname"><span class="pre">__annotations__</span></code><em class="property"> <span class="pre">=</span> <span class="pre">{'__call__':</span> <span class="pre">typing.Callable[...,</span> <span class="pre">typing.Any],</span> <span class="pre">'_version':</span> <span class="pre">&lt;class</span> <span class="pre">'int'&gt;,</span> <span class="pre">'dump_patches':</span> <span class="pre">&lt;class</span> <span class="pre">'bool'&gt;,</span> <span class="pre">'forward':</span> <span class="pre">typing.Callable[...,</span> <span class="pre">typing.Any],</span> <span class="pre">'training':</span> <span class="pre">&lt;class</span> <span class="pre">'bool'&gt;}</span></em><a class="headerlink" href="#FrEIA.modules.GINCouplingBlock.__annotations__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="id46">
<code class="sig-name descname"><span class="pre">__init__</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dims_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dims_c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subnet_constructor</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Callable</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clamp</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">2.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clamp_activation</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span> </span><span class="pre">Callable</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">'ATAN'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/coupling_layers.html#GINCouplingBlock.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id46" title="Permalink to this definition">¶</a></dt>
<dd><p>Additional args in docstring of base class.
:param subnet_constructor: function or class, with signature</p>
<blockquote>
<div><p>constructor(dims_in, dims_out).  The result should be a torch
nn.Module, that takes dims_in input channels, and dims_out output
channels. See tutorial for examples. Two of these subnetworks will be
initialized in the block.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>clamp</strong> – Soft clamping for the multiplicative component. The
amplification or attenuation of each input dimension can be at most
exp(±clamp).</p></li>
<li><p><strong>clamp_activation</strong> – Function to perform the clamping. String values
“ATAN”, “TANH”, and “SIGMOID” are recognized, or a function of
object can be passed. TANH behaves like the original realNVP paper.
A custom function should take tensors and map -inf to -1 and +inf to +1.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="id47">
<code class="sig-name descname"><span class="pre">__module__</span></code><em class="property"> <span class="pre">=</span> <span class="pre">'FrEIA.modules.coupling_layers'</span></em><a class="headerlink" href="#id47" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="id48">
<code class="sig-name descname"><span class="pre">training</span></code><em class="property"><span class="pre">:</span> <span class="pre">bool</span></em><a class="headerlink" href="#id48" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="id49">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">FrEIA.modules.</span></code><code class="sig-name descname"><span class="pre">AffineCouplingOneSided</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dims_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dims_c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subnet_constructor</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Callable</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clamp</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">2.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clamp_activation</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span> </span><span class="pre">Callable</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">'ATAN'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/coupling_layers.html#AffineCouplingOneSided"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id49" title="Permalink to this definition">¶</a></dt>
<dd><p>Half of a coupling block following the GLOWCouplingBlock design.  This
means only one affine transformation on half the inputs.  In the case where
random permutations or orthogonal transforms are used after every block,
this is not a restriction and simplifies the design.</p>
<dl class="py attribute">
<dt id="FrEIA.modules.AffineCouplingOneSided.__annotations__">
<code class="sig-name descname"><span class="pre">__annotations__</span></code><em class="property"> <span class="pre">=</span> <span class="pre">{'__call__':</span> <span class="pre">typing.Callable[...,</span> <span class="pre">typing.Any],</span> <span class="pre">'_version':</span> <span class="pre">&lt;class</span> <span class="pre">'int'&gt;,</span> <span class="pre">'dump_patches':</span> <span class="pre">&lt;class</span> <span class="pre">'bool'&gt;,</span> <span class="pre">'forward':</span> <span class="pre">typing.Callable[...,</span> <span class="pre">typing.Any],</span> <span class="pre">'training':</span> <span class="pre">&lt;class</span> <span class="pre">'bool'&gt;}</span></em><a class="headerlink" href="#FrEIA.modules.AffineCouplingOneSided.__annotations__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="id50">
<code class="sig-name descname"><span class="pre">__init__</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dims_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dims_c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subnet_constructor</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Callable</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clamp</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">2.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clamp_activation</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span> </span><span class="pre">Callable</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">'ATAN'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/coupling_layers.html#AffineCouplingOneSided.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id50" title="Permalink to this definition">¶</a></dt>
<dd><p>Additional args in docstring of base class.
:param subnet_constructor: function or class, with signature</p>
<blockquote>
<div><p>constructor(dims_in, dims_out).  The result should be a torch
nn.Module, that takes dims_in input channels, and dims_out output
channels. See tutorial for examples. One subnetwork will be
initialized in the block.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>clamp</strong> – Soft clamping for the multiplicative component. The
amplification or attenuation of each input dimension can be at most
exp(±clamp).</p></li>
<li><p><strong>clamp_activation</strong> – Function to perform the clamping. String values
“ATAN”, “TANH”, and “SIGMOID” are recognized, or a function of
object can be passed. TANH behaves like the original realNVP paper.
A custom function should take tensors and map -inf to -1 and +inf to +1.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="id51">
<code class="sig-name descname"><span class="pre">__module__</span></code><em class="property"> <span class="pre">=</span> <span class="pre">'FrEIA.modules.coupling_layers'</span></em><a class="headerlink" href="#id51" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="id52">
<code class="sig-name descname"><span class="pre">forward</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jac</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/coupling_layers.html#AffineCouplingOneSided.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id52" title="Permalink to this definition">¶</a></dt>
<dd><p>See base class docstring</p>
</dd></dl>

<dl class="py attribute">
<dt id="id53">
<code class="sig-name descname"><span class="pre">training</span></code><em class="property"><span class="pre">:</span> <span class="pre">bool</span></em><a class="headerlink" href="#id53" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="id54">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">FrEIA.modules.</span></code><code class="sig-name descname"><span class="pre">ConditionalAffineTransform</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dims_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dims_c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subnet_constructor</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Callable</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clamp</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">2.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clamp_activation</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span> </span><span class="pre">Callable</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">'ATAN'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/coupling_layers.html#ConditionalAffineTransform"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id54" title="Permalink to this definition">¶</a></dt>
<dd><p>Similar to the conditioning layers from SPADE (Park et al, 2019): Perform
an affine transformation on the whole input, where the affine coefficients
are predicted from only the condition.</p>
<dl class="py attribute">
<dt id="FrEIA.modules.ConditionalAffineTransform.__annotations__">
<code class="sig-name descname"><span class="pre">__annotations__</span></code><em class="property"> <span class="pre">=</span> <span class="pre">{'__call__':</span> <span class="pre">typing.Callable[...,</span> <span class="pre">typing.Any],</span> <span class="pre">'_version':</span> <span class="pre">&lt;class</span> <span class="pre">'int'&gt;,</span> <span class="pre">'dump_patches':</span> <span class="pre">&lt;class</span> <span class="pre">'bool'&gt;,</span> <span class="pre">'forward':</span> <span class="pre">typing.Callable[...,</span> <span class="pre">typing.Any],</span> <span class="pre">'training':</span> <span class="pre">&lt;class</span> <span class="pre">'bool'&gt;}</span></em><a class="headerlink" href="#FrEIA.modules.ConditionalAffineTransform.__annotations__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="id55">
<code class="sig-name descname"><span class="pre">__init__</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dims_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dims_c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subnet_constructor</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Callable</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clamp</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">2.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clamp_activation</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span> </span><span class="pre">Callable</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">'ATAN'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/coupling_layers.html#ConditionalAffineTransform.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id55" title="Permalink to this definition">¶</a></dt>
<dd><p>Additional args in docstring of base class.
:param subnet_constructor: function or class, with signature</p>
<blockquote>
<div><p>constructor(dims_in, dims_out).  The result should be a torch
nn.Module, that takes dims_in input channels, and dims_out output
channels. See tutorial for examples. One subnetwork will be
initialized in the block.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>clamp</strong> – Soft clamping for the multiplicative component. The
amplification or attenuation of each input dimension can be at most
exp(±clamp).</p></li>
<li><p><strong>clamp_activation</strong> – Function to perform the clamping. String values
“ATAN”, “TANH”, and “SIGMOID” are recognized, or a function of
object can be passed. TANH behaves like the original realNVP paper.
A custom function should take tensors and map -inf to -1 and +inf to +1.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="id56">
<code class="sig-name descname"><span class="pre">__module__</span></code><em class="property"> <span class="pre">=</span> <span class="pre">'FrEIA.modules.coupling_layers'</span></em><a class="headerlink" href="#id56" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="id57">
<code class="sig-name descname"><span class="pre">forward</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jac</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/coupling_layers.html#ConditionalAffineTransform.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id57" title="Permalink to this definition">¶</a></dt>
<dd><p>See base class docstring</p>
</dd></dl>

<dl class="py attribute">
<dt id="id58">
<code class="sig-name descname"><span class="pre">training</span></code><em class="property"><span class="pre">:</span> <span class="pre">bool</span></em><a class="headerlink" href="#id58" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="other-learned-transforms">
<h2>Other learned transforms<a class="headerlink" href="#other-learned-transforms" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="id59">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">FrEIA.modules.</span></code><code class="sig-name descname"><span class="pre">ActNorm</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dims_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dims_c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/invertible_resnet.html#ActNorm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id59" title="Permalink to this definition">¶</a></dt>
<dd><dl class="py attribute">
<dt id="FrEIA.modules.ActNorm.__annotations__">
<code class="sig-name descname"><span class="pre">__annotations__</span></code><em class="property"> <span class="pre">=</span> <span class="pre">{'__call__':</span> <span class="pre">typing.Callable[...,</span> <span class="pre">typing.Any],</span> <span class="pre">'_version':</span> <span class="pre">&lt;class</span> <span class="pre">'int'&gt;,</span> <span class="pre">'dump_patches':</span> <span class="pre">&lt;class</span> <span class="pre">'bool'&gt;,</span> <span class="pre">'forward':</span> <span class="pre">typing.Callable[...,</span> <span class="pre">typing.Any],</span> <span class="pre">'training':</span> <span class="pre">&lt;class</span> <span class="pre">'bool'&gt;}</span></em><a class="headerlink" href="#FrEIA.modules.ActNorm.__annotations__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="id60">
<code class="sig-name descname"><span class="pre">__init__</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dims_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dims_c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/invertible_resnet.html#ActNorm.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id60" title="Permalink to this definition">¶</a></dt>
<dd><p>Parameters:
dims_in: list of tuples specifying the shape of the inputs to this</p>
<blockquote>
<div><p>operator: dims_in = [shape_x_0, shape_x_1, …]</p>
</div></blockquote>
<dl class="simple">
<dt>dims_c:  list of tuples specifying the shape of the conditions to</dt><dd><p>this operator.</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="id61">
<code class="sig-name descname"><span class="pre">__module__</span></code><em class="property"> <span class="pre">=</span> <span class="pre">'FrEIA.modules.invertible_resnet'</span></em><a class="headerlink" href="#id61" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="id62">
<code class="sig-name descname"><span class="pre">forward</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jac</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/invertible_resnet.html#ActNorm.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id62" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform a forward (default, <cite>rev=False</cite>) or backward pass (<cite>rev=True</cite>)
through this module/operator.</p>
<p><em>Note to implementers:</em>
- Subclasses MUST return a Jacobian when jac=True, but CAN return a</p>
<blockquote>
<div><p>valid Jacobian when jac=False (not punished). The latter is only recommended
if the computation of the Jacobian is trivial.</p>
</div></blockquote>
<ul class="simple">
<li><p>Subclasses MUST follow the convention that the returned Jacobian be
consistent with the evaluation direction. Let’s make this more precise:
Let $f$ be the function that the subclass represents. Then:
$$$
J = log det</p></li>
</ul>
<dl class="simple">
<dt>rac{partial f}{partial x} </dt><dd><p>-J = log det</p>
</dd>
<dt>rac{partial f^{-1}}{partial z}.</dt><dd><p>$$$
Any subclass MUST return $J$ for forward evaluation (<cite>rev=False</cite>),
and $-J$ for backward evaluation (<cite>rev=True</cite>).</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x_or_z</strong> – input data (array-like of one or more tensors)</p></li>
<li><p><strong>c</strong> – conditioning data (array-like of none or more tensors)</p></li>
<li><p><strong>rev</strong> – perform backward pass</p></li>
<li><p><strong>jac</strong> – return Jacobian associated to the direction</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="id63">
<code class="sig-name descname"><span class="pre">initialize_with_data</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/invertible_resnet.html#ActNorm.initialize_with_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id63" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="id64">
<code class="sig-name descname"><span class="pre">output_dims</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_dims</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/invertible_resnet.html#ActNorm.output_dims"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id64" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="id65">
<code class="sig-name descname"><span class="pre">training</span></code><em class="property"><span class="pre">:</span> <span class="pre">bool</span></em><a class="headerlink" href="#id65" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="id66">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">FrEIA.modules.</span></code><code class="sig-name descname"><span class="pre">IResNetLayer</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dims_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dims_c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">internal_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_internal_layers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jacobian_iterations</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hutchinson_samples</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fixed_point_iterations</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lipschitz_iterations</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lipschitz_batchsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spectral_norm_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.8</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/invertible_resnet.html#IResNetLayer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id66" title="Permalink to this definition">¶</a></dt>
<dd><p>Implementation of the i-ResNet architecture as proposed in
<a class="reference external" href="https://arxiv.org/pdf/1811.00995.pdf">https://arxiv.org/pdf/1811.00995.pdf</a></p>
<dl class="py attribute">
<dt id="FrEIA.modules.IResNetLayer.__annotations__">
<code class="sig-name descname"><span class="pre">__annotations__</span></code><em class="property"> <span class="pre">=</span> <span class="pre">{'__call__':</span> <span class="pre">typing.Callable[...,</span> <span class="pre">typing.Any],</span> <span class="pre">'_version':</span> <span class="pre">&lt;class</span> <span class="pre">'int'&gt;,</span> <span class="pre">'dump_patches':</span> <span class="pre">&lt;class</span> <span class="pre">'bool'&gt;,</span> <span class="pre">'forward':</span> <span class="pre">typing.Callable[...,</span> <span class="pre">typing.Any],</span> <span class="pre">'training':</span> <span class="pre">&lt;class</span> <span class="pre">'bool'&gt;}</span></em><a class="headerlink" href="#FrEIA.modules.IResNetLayer.__annotations__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="id67">
<code class="sig-name descname"><span class="pre">__init__</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dims_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dims_c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">internal_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_internal_layers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jacobian_iterations</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hutchinson_samples</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fixed_point_iterations</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lipschitz_iterations</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lipschitz_batchsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spectral_norm_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.8</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/invertible_resnet.html#IResNetLayer.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id67" title="Permalink to this definition">¶</a></dt>
<dd><p>Parameters:
dims_in: list of tuples specifying the shape of the inputs to this</p>
<blockquote>
<div><p>operator: dims_in = [shape_x_0, shape_x_1, …]</p>
</div></blockquote>
<dl class="simple">
<dt>dims_c:  list of tuples specifying the shape of the conditions to</dt><dd><p>this operator.</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="id68">
<code class="sig-name descname"><span class="pre">__module__</span></code><em class="property"> <span class="pre">=</span> <span class="pre">'FrEIA.modules.invertible_resnet'</span></em><a class="headerlink" href="#id68" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="id69">
<code class="sig-name descname"><span class="pre">forward</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jac</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/invertible_resnet.html#IResNetLayer.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id69" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform a forward (default, <cite>rev=False</cite>) or backward pass (<cite>rev=True</cite>)
through this module/operator.</p>
<p><em>Note to implementers:</em>
- Subclasses MUST return a Jacobian when jac=True, but CAN return a</p>
<blockquote>
<div><p>valid Jacobian when jac=False (not punished). The latter is only recommended
if the computation of the Jacobian is trivial.</p>
</div></blockquote>
<ul class="simple">
<li><p>Subclasses MUST follow the convention that the returned Jacobian be
consistent with the evaluation direction. Let’s make this more precise:
Let $f$ be the function that the subclass represents. Then:
$$$
J = log det</p></li>
</ul>
<dl class="simple">
<dt>rac{partial f}{partial x} </dt><dd><p>-J = log det</p>
</dd>
<dt>rac{partial f^{-1}}{partial z}.</dt><dd><p>$$$
Any subclass MUST return $J$ for forward evaluation (<cite>rev=False</cite>),
and $-J$ for backward evaluation (<cite>rev=True</cite>).</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x_or_z</strong> – input data (array-like of one or more tensors)</p></li>
<li><p><strong>c</strong> – conditioning data (array-like of none or more tensors)</p></li>
<li><p><strong>rev</strong> – perform backward pass</p></li>
<li><p><strong>jac</strong> – return Jacobian associated to the direction</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="id70">
<code class="sig-name descname"><span class="pre">lipschitz_correction</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/invertible_resnet.html#IResNetLayer.lipschitz_correction"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id70" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="id71">
<code class="sig-name descname"><span class="pre">output_dims</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_dims</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/invertible_resnet.html#IResNetLayer.output_dims"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id71" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="id72">
<code class="sig-name descname"><span class="pre">training</span></code><em class="property"><span class="pre">:</span> <span class="pre">bool</span></em><a class="headerlink" href="#id72" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="id73">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">FrEIA.modules.</span></code><code class="sig-name descname"><span class="pre">InvAutoAct</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dims_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dims_c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/inv_auto_layers.html#InvAutoAct"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id73" title="Permalink to this definition">¶</a></dt>
<dd><dl class="py attribute">
<dt id="FrEIA.modules.InvAutoAct.__annotations__">
<code class="sig-name descname"><span class="pre">__annotations__</span></code><em class="property"> <span class="pre">=</span> <span class="pre">{'__call__':</span> <span class="pre">typing.Callable[...,</span> <span class="pre">typing.Any],</span> <span class="pre">'_version':</span> <span class="pre">&lt;class</span> <span class="pre">'int'&gt;,</span> <span class="pre">'dump_patches':</span> <span class="pre">&lt;class</span> <span class="pre">'bool'&gt;,</span> <span class="pre">'forward':</span> <span class="pre">typing.Callable[...,</span> <span class="pre">typing.Any],</span> <span class="pre">'training':</span> <span class="pre">&lt;class</span> <span class="pre">'bool'&gt;}</span></em><a class="headerlink" href="#FrEIA.modules.InvAutoAct.__annotations__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="id74">
<code class="sig-name descname"><span class="pre">__init__</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dims_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dims_c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/inv_auto_layers.html#InvAutoAct.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id74" title="Permalink to this definition">¶</a></dt>
<dd><p>Parameters:
dims_in: list of tuples specifying the shape of the inputs to this</p>
<blockquote>
<div><p>operator: dims_in = [shape_x_0, shape_x_1, …]</p>
</div></blockquote>
<dl class="simple">
<dt>dims_c:  list of tuples specifying the shape of the conditions to</dt><dd><p>this operator.</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="id75">
<code class="sig-name descname"><span class="pre">__module__</span></code><em class="property"> <span class="pre">=</span> <span class="pre">'FrEIA.modules.inv_auto_layers'</span></em><a class="headerlink" href="#id75" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="id76">
<code class="sig-name descname"><span class="pre">forward</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jac</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/inv_auto_layers.html#InvAutoAct.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id76" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform a forward (default, <cite>rev=False</cite>) or backward pass (<cite>rev=True</cite>)
through this module/operator.</p>
<p><em>Note to implementers:</em>
- Subclasses MUST return a Jacobian when jac=True, but CAN return a</p>
<blockquote>
<div><p>valid Jacobian when jac=False (not punished). The latter is only recommended
if the computation of the Jacobian is trivial.</p>
</div></blockquote>
<ul class="simple">
<li><p>Subclasses MUST follow the convention that the returned Jacobian be
consistent with the evaluation direction. Let’s make this more precise:
Let $f$ be the function that the subclass represents. Then:
$$$
J = log det</p></li>
</ul>
<dl class="simple">
<dt>rac{partial f}{partial x} </dt><dd><p>-J = log det</p>
</dd>
<dt>rac{partial f^{-1}}{partial z}.</dt><dd><p>$$$
Any subclass MUST return $J$ for forward evaluation (<cite>rev=False</cite>),
and $-J$ for backward evaluation (<cite>rev=True</cite>).</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x_or_z</strong> – input data (array-like of one or more tensors)</p></li>
<li><p><strong>c</strong> – conditioning data (array-like of none or more tensors)</p></li>
<li><p><strong>rev</strong> – perform backward pass</p></li>
<li><p><strong>jac</strong> – return Jacobian associated to the direction</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="id77">
<code class="sig-name descname"><span class="pre">output_dims</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_dims</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/inv_auto_layers.html#InvAutoAct.output_dims"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id77" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="id78">
<code class="sig-name descname"><span class="pre">training</span></code><em class="property"><span class="pre">:</span> <span class="pre">bool</span></em><a class="headerlink" href="#id78" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="id79">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">FrEIA.modules.</span></code><code class="sig-name descname"><span class="pre">InvAutoActFixed</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dims_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dims_c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/inv_auto_layers.html#InvAutoActFixed"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id79" title="Permalink to this definition">¶</a></dt>
<dd><dl class="py attribute">
<dt id="FrEIA.modules.InvAutoActFixed.__annotations__">
<code class="sig-name descname"><span class="pre">__annotations__</span></code><em class="property"> <span class="pre">=</span> <span class="pre">{'__call__':</span> <span class="pre">typing.Callable[...,</span> <span class="pre">typing.Any],</span> <span class="pre">'_version':</span> <span class="pre">&lt;class</span> <span class="pre">'int'&gt;,</span> <span class="pre">'dump_patches':</span> <span class="pre">&lt;class</span> <span class="pre">'bool'&gt;,</span> <span class="pre">'forward':</span> <span class="pre">typing.Callable[...,</span> <span class="pre">typing.Any],</span> <span class="pre">'training':</span> <span class="pre">&lt;class</span> <span class="pre">'bool'&gt;}</span></em><a class="headerlink" href="#FrEIA.modules.InvAutoActFixed.__annotations__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="id80">
<code class="sig-name descname"><span class="pre">__init__</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dims_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dims_c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/inv_auto_layers.html#InvAutoActFixed.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id80" title="Permalink to this definition">¶</a></dt>
<dd><p>Initializes internal Module state, shared by both nn.Module and ScriptModule.</p>
</dd></dl>

<dl class="py attribute">
<dt id="id81">
<code class="sig-name descname"><span class="pre">__module__</span></code><em class="property"> <span class="pre">=</span> <span class="pre">'FrEIA.modules.inv_auto_layers'</span></em><a class="headerlink" href="#id81" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="id82">
<code class="sig-name descname"><span class="pre">forward</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jac</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/inv_auto_layers.html#InvAutoActFixed.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id82" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

<dl class="py method">
<dt id="id83">
<code class="sig-name descname"><span class="pre">output_dims</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_dims</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/inv_auto_layers.html#InvAutoActFixed.output_dims"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id83" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="id84">
<code class="sig-name descname"><span class="pre">training</span></code><em class="property"><span class="pre">:</span> <span class="pre">bool</span></em><a class="headerlink" href="#id84" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="id85">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">FrEIA.modules.</span></code><code class="sig-name descname"><span class="pre">InvAutoActTwoSided</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dims_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dims_c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clamp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/inv_auto_layers.html#InvAutoActTwoSided"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id85" title="Permalink to this definition">¶</a></dt>
<dd><dl class="py attribute">
<dt id="FrEIA.modules.InvAutoActTwoSided.__annotations__">
<code class="sig-name descname"><span class="pre">__annotations__</span></code><em class="property"> <span class="pre">=</span> <span class="pre">{'__call__':</span> <span class="pre">typing.Callable[...,</span> <span class="pre">typing.Any],</span> <span class="pre">'_version':</span> <span class="pre">&lt;class</span> <span class="pre">'int'&gt;,</span> <span class="pre">'dump_patches':</span> <span class="pre">&lt;class</span> <span class="pre">'bool'&gt;,</span> <span class="pre">'forward':</span> <span class="pre">typing.Callable[...,</span> <span class="pre">typing.Any],</span> <span class="pre">'training':</span> <span class="pre">&lt;class</span> <span class="pre">'bool'&gt;}</span></em><a class="headerlink" href="#FrEIA.modules.InvAutoActTwoSided.__annotations__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="id86">
<code class="sig-name descname"><span class="pre">__init__</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dims_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dims_c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clamp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/inv_auto_layers.html#InvAutoActTwoSided.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id86" title="Permalink to this definition">¶</a></dt>
<dd><p>Parameters:
dims_in: list of tuples specifying the shape of the inputs to this</p>
<blockquote>
<div><p>operator: dims_in = [shape_x_0, shape_x_1, …]</p>
</div></blockquote>
<dl class="simple">
<dt>dims_c:  list of tuples specifying the shape of the conditions to</dt><dd><p>this operator.</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="id87">
<code class="sig-name descname"><span class="pre">__module__</span></code><em class="property"> <span class="pre">=</span> <span class="pre">'FrEIA.modules.inv_auto_layers'</span></em><a class="headerlink" href="#id87" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="id88">
<code class="sig-name descname"><span class="pre">e</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/inv_auto_layers.html#InvAutoActTwoSided.e"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id88" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="id89">
<code class="sig-name descname"><span class="pre">forward</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jac</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/inv_auto_layers.html#InvAutoActTwoSided.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id89" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform a forward (default, <cite>rev=False</cite>) or backward pass (<cite>rev=True</cite>)
through this module/operator.</p>
<p><em>Note to implementers:</em>
- Subclasses MUST return a Jacobian when jac=True, but CAN return a</p>
<blockquote>
<div><p>valid Jacobian when jac=False (not punished). The latter is only recommended
if the computation of the Jacobian is trivial.</p>
</div></blockquote>
<ul class="simple">
<li><p>Subclasses MUST follow the convention that the returned Jacobian be
consistent with the evaluation direction. Let’s make this more precise:
Let $f$ be the function that the subclass represents. Then:
$$$
J = log det</p></li>
</ul>
<dl class="simple">
<dt>rac{partial f}{partial x} </dt><dd><p>-J = log det</p>
</dd>
<dt>rac{partial f^{-1}}{partial z}.</dt><dd><p>$$$
Any subclass MUST return $J$ for forward evaluation (<cite>rev=False</cite>),
and $-J$ for backward evaluation (<cite>rev=True</cite>).</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x_or_z</strong> – input data (array-like of one or more tensors)</p></li>
<li><p><strong>c</strong> – conditioning data (array-like of none or more tensors)</p></li>
<li><p><strong>rev</strong> – perform backward pass</p></li>
<li><p><strong>jac</strong> – return Jacobian associated to the direction</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="id90">
<code class="sig-name descname"><span class="pre">log_e</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/inv_auto_layers.html#InvAutoActTwoSided.log_e"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id90" title="Permalink to this definition">¶</a></dt>
<dd><p>log of the nonlinear function e</p>
</dd></dl>

<dl class="py method">
<dt id="id91">
<code class="sig-name descname"><span class="pre">output_dims</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_dims</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/inv_auto_layers.html#InvAutoActTwoSided.output_dims"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id91" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="id92">
<code class="sig-name descname"><span class="pre">training</span></code><em class="property"><span class="pre">:</span> <span class="pre">bool</span></em><a class="headerlink" href="#id92" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="id93">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">FrEIA.modules.</span></code><code class="sig-name descname"><span class="pre">InvAutoConv2D</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dims_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dims_c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dims_out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padding</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/inv_auto_layers.html#InvAutoConv2D"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id93" title="Permalink to this definition">¶</a></dt>
<dd><dl class="py attribute">
<dt id="FrEIA.modules.InvAutoConv2D.__annotations__">
<code class="sig-name descname"><span class="pre">__annotations__</span></code><em class="property"> <span class="pre">=</span> <span class="pre">{'__call__':</span> <span class="pre">typing.Callable[...,</span> <span class="pre">typing.Any],</span> <span class="pre">'_version':</span> <span class="pre">&lt;class</span> <span class="pre">'int'&gt;,</span> <span class="pre">'dump_patches':</span> <span class="pre">&lt;class</span> <span class="pre">'bool'&gt;,</span> <span class="pre">'forward':</span> <span class="pre">typing.Callable[...,</span> <span class="pre">typing.Any],</span> <span class="pre">'training':</span> <span class="pre">&lt;class</span> <span class="pre">'bool'&gt;}</span></em><a class="headerlink" href="#FrEIA.modules.InvAutoConv2D.__annotations__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="id94">
<code class="sig-name descname"><span class="pre">__init__</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dims_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dims_c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dims_out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padding</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/inv_auto_layers.html#InvAutoConv2D.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id94" title="Permalink to this definition">¶</a></dt>
<dd><p>Parameters:
dims_in: list of tuples specifying the shape of the inputs to this</p>
<blockquote>
<div><p>operator: dims_in = [shape_x_0, shape_x_1, …]</p>
</div></blockquote>
<dl class="simple">
<dt>dims_c:  list of tuples specifying the shape of the conditions to</dt><dd><p>this operator.</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="id95">
<code class="sig-name descname"><span class="pre">__module__</span></code><em class="property"> <span class="pre">=</span> <span class="pre">'FrEIA.modules.inv_auto_layers'</span></em><a class="headerlink" href="#id95" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="id96">
<code class="sig-name descname"><span class="pre">forward</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jac</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/inv_auto_layers.html#InvAutoConv2D.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id96" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform a forward (default, <cite>rev=False</cite>) or backward pass (<cite>rev=True</cite>)
through this module/operator.</p>
<p><em>Note to implementers:</em>
- Subclasses MUST return a Jacobian when jac=True, but CAN return a</p>
<blockquote>
<div><p>valid Jacobian when jac=False (not punished). The latter is only recommended
if the computation of the Jacobian is trivial.</p>
</div></blockquote>
<ul class="simple">
<li><p>Subclasses MUST follow the convention that the returned Jacobian be
consistent with the evaluation direction. Let’s make this more precise:
Let $f$ be the function that the subclass represents. Then:
$$$
J = log det</p></li>
</ul>
<dl class="simple">
<dt>rac{partial f}{partial x} </dt><dd><p>-J = log det</p>
</dd>
<dt>rac{partial f^{-1}}{partial z}.</dt><dd><p>$$$
Any subclass MUST return $J$ for forward evaluation (<cite>rev=False</cite>),
and $-J$ for backward evaluation (<cite>rev=True</cite>).</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x_or_z</strong> – input data (array-like of one or more tensors)</p></li>
<li><p><strong>c</strong> – conditioning data (array-like of none or more tensors)</p></li>
<li><p><strong>rev</strong> – perform backward pass</p></li>
<li><p><strong>jac</strong> – return Jacobian associated to the direction</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="id97">
<code class="sig-name descname"><span class="pre">output_dims</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_dims</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/inv_auto_layers.html#InvAutoConv2D.output_dims"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id97" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="id98">
<code class="sig-name descname"><span class="pre">training</span></code><em class="property"><span class="pre">:</span> <span class="pre">bool</span></em><a class="headerlink" href="#id98" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="id99">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">FrEIA.modules.</span></code><code class="sig-name descname"><span class="pre">InvAutoFC</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dims_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dims_c</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dims_out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/inv_auto_layers.html#InvAutoFC"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id99" title="Permalink to this definition">¶</a></dt>
<dd><dl class="py attribute">
<dt id="FrEIA.modules.InvAutoFC.__annotations__">
<code class="sig-name descname"><span class="pre">__annotations__</span></code><em class="property"> <span class="pre">=</span> <span class="pre">{'__call__':</span> <span class="pre">typing.Callable[...,</span> <span class="pre">typing.Any],</span> <span class="pre">'_version':</span> <span class="pre">&lt;class</span> <span class="pre">'int'&gt;,</span> <span class="pre">'dump_patches':</span> <span class="pre">&lt;class</span> <span class="pre">'bool'&gt;,</span> <span class="pre">'forward':</span> <span class="pre">typing.Callable[...,</span> <span class="pre">typing.Any],</span> <span class="pre">'training':</span> <span class="pre">&lt;class</span> <span class="pre">'bool'&gt;}</span></em><a class="headerlink" href="#FrEIA.modules.InvAutoFC.__annotations__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="id100">
<code class="sig-name descname"><span class="pre">__init__</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dims_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dims_c</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dims_out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/inv_auto_layers.html#InvAutoFC.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id100" title="Permalink to this definition">¶</a></dt>
<dd><p>Parameters:
dims_in: list of tuples specifying the shape of the inputs to this</p>
<blockquote>
<div><p>operator: dims_in = [shape_x_0, shape_x_1, …]</p>
</div></blockquote>
<dl class="simple">
<dt>dims_c:  list of tuples specifying the shape of the conditions to</dt><dd><p>this operator.</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="id101">
<code class="sig-name descname"><span class="pre">__module__</span></code><em class="property"> <span class="pre">=</span> <span class="pre">'FrEIA.modules.inv_auto_layers'</span></em><a class="headerlink" href="#id101" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="id102">
<code class="sig-name descname"><span class="pre">forward</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jac</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/inv_auto_layers.html#InvAutoFC.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id102" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform a forward (default, <cite>rev=False</cite>) or backward pass (<cite>rev=True</cite>)
through this module/operator.</p>
<p><em>Note to implementers:</em>
- Subclasses MUST return a Jacobian when jac=True, but CAN return a</p>
<blockquote>
<div><p>valid Jacobian when jac=False (not punished). The latter is only recommended
if the computation of the Jacobian is trivial.</p>
</div></blockquote>
<ul class="simple">
<li><p>Subclasses MUST follow the convention that the returned Jacobian be
consistent with the evaluation direction. Let’s make this more precise:
Let $f$ be the function that the subclass represents. Then:
$$$
J = log det</p></li>
</ul>
<dl class="simple">
<dt>rac{partial f}{partial x} </dt><dd><p>-J = log det</p>
</dd>
<dt>rac{partial f^{-1}}{partial z}.</dt><dd><p>$$$
Any subclass MUST return $J$ for forward evaluation (<cite>rev=False</cite>),
and $-J$ for backward evaluation (<cite>rev=True</cite>).</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x_or_z</strong> – input data (array-like of one or more tensors)</p></li>
<li><p><strong>c</strong> – conditioning data (array-like of none or more tensors)</p></li>
<li><p><strong>rev</strong> – perform backward pass</p></li>
<li><p><strong>jac</strong> – return Jacobian associated to the direction</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="id103">
<code class="sig-name descname"><span class="pre">output_dims</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_dims</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/inv_auto_layers.html#InvAutoFC.output_dims"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id103" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="id104">
<code class="sig-name descname"><span class="pre">training</span></code><em class="property"><span class="pre">:</span> <span class="pre">bool</span></em><a class="headerlink" href="#id104" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="id105">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">FrEIA.modules.</span></code><code class="sig-name descname"><span class="pre">LearnedElementwiseScaling</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dims_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dims_c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/inv_auto_layers.html#LearnedElementwiseScaling"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id105" title="Permalink to this definition">¶</a></dt>
<dd><dl class="py attribute">
<dt id="FrEIA.modules.LearnedElementwiseScaling.__annotations__">
<code class="sig-name descname"><span class="pre">__annotations__</span></code><em class="property"> <span class="pre">=</span> <span class="pre">{'__call__':</span> <span class="pre">typing.Callable[...,</span> <span class="pre">typing.Any],</span> <span class="pre">'_version':</span> <span class="pre">&lt;class</span> <span class="pre">'int'&gt;,</span> <span class="pre">'dump_patches':</span> <span class="pre">&lt;class</span> <span class="pre">'bool'&gt;,</span> <span class="pre">'forward':</span> <span class="pre">typing.Callable[...,</span> <span class="pre">typing.Any],</span> <span class="pre">'training':</span> <span class="pre">&lt;class</span> <span class="pre">'bool'&gt;}</span></em><a class="headerlink" href="#FrEIA.modules.LearnedElementwiseScaling.__annotations__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="id106">
<code class="sig-name descname"><span class="pre">__init__</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dims_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dims_c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/inv_auto_layers.html#LearnedElementwiseScaling.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id106" title="Permalink to this definition">¶</a></dt>
<dd><p>Parameters:
dims_in: list of tuples specifying the shape of the inputs to this</p>
<blockquote>
<div><p>operator: dims_in = [shape_x_0, shape_x_1, …]</p>
</div></blockquote>
<dl class="simple">
<dt>dims_c:  list of tuples specifying the shape of the conditions to</dt><dd><p>this operator.</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="id107">
<code class="sig-name descname"><span class="pre">__module__</span></code><em class="property"> <span class="pre">=</span> <span class="pre">'FrEIA.modules.inv_auto_layers'</span></em><a class="headerlink" href="#id107" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="id108">
<code class="sig-name descname"><span class="pre">forward</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jac</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/inv_auto_layers.html#LearnedElementwiseScaling.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id108" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform a forward (default, <cite>rev=False</cite>) or backward pass (<cite>rev=True</cite>)
through this module/operator.</p>
<p><em>Note to implementers:</em>
- Subclasses MUST return a Jacobian when jac=True, but CAN return a</p>
<blockquote>
<div><p>valid Jacobian when jac=False (not punished). The latter is only recommended
if the computation of the Jacobian is trivial.</p>
</div></blockquote>
<ul class="simple">
<li><p>Subclasses MUST follow the convention that the returned Jacobian be
consistent with the evaluation direction. Let’s make this more precise:
Let $f$ be the function that the subclass represents. Then:
$$$
J = log det</p></li>
</ul>
<dl class="simple">
<dt>rac{partial f}{partial x} </dt><dd><p>-J = log det</p>
</dd>
<dt>rac{partial f^{-1}}{partial z}.</dt><dd><p>$$$
Any subclass MUST return $J$ for forward evaluation (<cite>rev=False</cite>),
and $-J$ for backward evaluation (<cite>rev=True</cite>).</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x_or_z</strong> – input data (array-like of one or more tensors)</p></li>
<li><p><strong>c</strong> – conditioning data (array-like of none or more tensors)</p></li>
<li><p><strong>rev</strong> – perform backward pass</p></li>
<li><p><strong>jac</strong> – return Jacobian associated to the direction</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="id109">
<code class="sig-name descname"><span class="pre">output_dims</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_dims</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/inv_auto_layers.html#LearnedElementwiseScaling.output_dims"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id109" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="id110">
<code class="sig-name descname"><span class="pre">training</span></code><em class="property"><span class="pre">:</span> <span class="pre">bool</span></em><a class="headerlink" href="#id110" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="id111">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">FrEIA.modules.</span></code><code class="sig-name descname"><span class="pre">OrthogonalTransform</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dims_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dims_c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">correction_interval</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">256</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clamp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/orthogonal.html#OrthogonalTransform"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id111" title="Permalink to this definition">¶</a></dt>
<dd><dl class="py attribute">
<dt id="FrEIA.modules.OrthogonalTransform.__annotations__">
<code class="sig-name descname"><span class="pre">__annotations__</span></code><em class="property"> <span class="pre">=</span> <span class="pre">{'__call__':</span> <span class="pre">typing.Callable[...,</span> <span class="pre">typing.Any],</span> <span class="pre">'_version':</span> <span class="pre">&lt;class</span> <span class="pre">'int'&gt;,</span> <span class="pre">'dump_patches':</span> <span class="pre">&lt;class</span> <span class="pre">'bool'&gt;,</span> <span class="pre">'forward':</span> <span class="pre">typing.Callable[...,</span> <span class="pre">typing.Any],</span> <span class="pre">'training':</span> <span class="pre">&lt;class</span> <span class="pre">'bool'&gt;}</span></em><a class="headerlink" href="#FrEIA.modules.OrthogonalTransform.__annotations__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="id112">
<code class="sig-name descname"><span class="pre">__init__</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dims_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dims_c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">correction_interval</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">256</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clamp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/orthogonal.html#OrthogonalTransform.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id112" title="Permalink to this definition">¶</a></dt>
<dd><p>Parameters:
dims_in: list of tuples specifying the shape of the inputs to this</p>
<blockquote>
<div><p>operator: dims_in = [shape_x_0, shape_x_1, …]</p>
</div></blockquote>
<dl class="simple">
<dt>dims_c:  list of tuples specifying the shape of the conditions to</dt><dd><p>this operator.</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="id113">
<code class="sig-name descname"><span class="pre">__module__</span></code><em class="property"> <span class="pre">=</span> <span class="pre">'FrEIA.modules.orthogonal'</span></em><a class="headerlink" href="#id113" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="id114">
<code class="sig-name descname"><span class="pre">e</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/orthogonal.html#OrthogonalTransform.e"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id114" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="id115">
<code class="sig-name descname"><span class="pre">forward</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jac</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/orthogonal.html#OrthogonalTransform.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id115" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform a forward (default, <cite>rev=False</cite>) or backward pass (<cite>rev=True</cite>)
through this module/operator.</p>
<p><em>Note to implementers:</em>
- Subclasses MUST return a Jacobian when jac=True, but CAN return a</p>
<blockquote>
<div><p>valid Jacobian when jac=False (not punished). The latter is only recommended
if the computation of the Jacobian is trivial.</p>
</div></blockquote>
<ul class="simple">
<li><p>Subclasses MUST follow the convention that the returned Jacobian be
consistent with the evaluation direction. Let’s make this more precise:
Let $f$ be the function that the subclass represents. Then:
$$$
J = log det</p></li>
</ul>
<dl class="simple">
<dt>rac{partial f}{partial x} </dt><dd><p>-J = log det</p>
</dd>
<dt>rac{partial f^{-1}}{partial z}.</dt><dd><p>$$$
Any subclass MUST return $J$ for forward evaluation (<cite>rev=False</cite>),
and $-J$ for backward evaluation (<cite>rev=True</cite>).</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x_or_z</strong> – input data (array-like of one or more tensors)</p></li>
<li><p><strong>c</strong> – conditioning data (array-like of none or more tensors)</p></li>
<li><p><strong>rev</strong> – perform backward pass</p></li>
<li><p><strong>jac</strong> – return Jacobian associated to the direction</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="id116">
<code class="sig-name descname"><span class="pre">log_e</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/orthogonal.html#OrthogonalTransform.log_e"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id116" title="Permalink to this definition">¶</a></dt>
<dd><p>log of the nonlinear function e</p>
</dd></dl>

<dl class="py method">
<dt id="id117">
<code class="sig-name descname"><span class="pre">output_dims</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_dims</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/orthogonal.html#OrthogonalTransform.output_dims"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id117" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="id118">
<code class="sig-name descname"><span class="pre">training</span></code><em class="property"><span class="pre">:</span> <span class="pre">bool</span></em><a class="headerlink" href="#id118" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="id119">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">FrEIA.modules.</span></code><code class="sig-name descname"><span class="pre">HouseholderPerm</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dims_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dims_c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_reflections</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fixed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/orthogonal.html#HouseholderPerm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id119" title="Permalink to this definition">¶</a></dt>
<dd><dl class="py attribute">
<dt id="FrEIA.modules.HouseholderPerm.__annotations__">
<code class="sig-name descname"><span class="pre">__annotations__</span></code><em class="property"> <span class="pre">=</span> <span class="pre">{'__call__':</span> <span class="pre">typing.Callable[...,</span> <span class="pre">typing.Any],</span> <span class="pre">'_version':</span> <span class="pre">&lt;class</span> <span class="pre">'int'&gt;,</span> <span class="pre">'dump_patches':</span> <span class="pre">&lt;class</span> <span class="pre">'bool'&gt;,</span> <span class="pre">'forward':</span> <span class="pre">typing.Callable[...,</span> <span class="pre">typing.Any],</span> <span class="pre">'training':</span> <span class="pre">&lt;class</span> <span class="pre">'bool'&gt;}</span></em><a class="headerlink" href="#FrEIA.modules.HouseholderPerm.__annotations__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="id120">
<code class="sig-name descname"><span class="pre">__init__</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dims_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dims_c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_reflections</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fixed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/orthogonal.html#HouseholderPerm.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id120" title="Permalink to this definition">¶</a></dt>
<dd><p>Parameters:
dims_in: list of tuples specifying the shape of the inputs to this</p>
<blockquote>
<div><p>operator: dims_in = [shape_x_0, shape_x_1, …]</p>
</div></blockquote>
<dl class="simple">
<dt>dims_c:  list of tuples specifying the shape of the conditions to</dt><dd><p>this operator.</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="id121">
<code class="sig-name descname"><span class="pre">__module__</span></code><em class="property"> <span class="pre">=</span> <span class="pre">'FrEIA.modules.orthogonal'</span></em><a class="headerlink" href="#id121" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="id122">
<code class="sig-name descname"><span class="pre">forward</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jac</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/orthogonal.html#HouseholderPerm.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id122" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform a forward (default, <cite>rev=False</cite>) or backward pass (<cite>rev=True</cite>)
through this module/operator.</p>
<p><em>Note to implementers:</em>
- Subclasses MUST return a Jacobian when jac=True, but CAN return a</p>
<blockquote>
<div><p>valid Jacobian when jac=False (not punished). The latter is only recommended
if the computation of the Jacobian is trivial.</p>
</div></blockquote>
<ul class="simple">
<li><p>Subclasses MUST follow the convention that the returned Jacobian be
consistent with the evaluation direction. Let’s make this more precise:
Let $f$ be the function that the subclass represents. Then:
$$$
J = log det</p></li>
</ul>
<dl class="simple">
<dt>rac{partial f}{partial x} </dt><dd><p>-J = log det</p>
</dd>
<dt>rac{partial f^{-1}}{partial z}.</dt><dd><p>$$$
Any subclass MUST return $J$ for forward evaluation (<cite>rev=False</cite>),
and $-J$ for backward evaluation (<cite>rev=True</cite>).</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x_or_z</strong> – input data (array-like of one or more tensors)</p></li>
<li><p><strong>c</strong> – conditioning data (array-like of none or more tensors)</p></li>
<li><p><strong>rev</strong> – perform backward pass</p></li>
<li><p><strong>jac</strong> – return Jacobian associated to the direction</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="id123">
<code class="sig-name descname"><span class="pre">output_dims</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_dims</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/orthogonal.html#HouseholderPerm.output_dims"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id123" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="id124">
<code class="sig-name descname"><span class="pre">training</span></code><em class="property"><span class="pre">:</span> <span class="pre">bool</span></em><a class="headerlink" href="#id124" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="id125">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">FrEIA.modules.</span></code><code class="sig-name descname"><span class="pre">GaussianMixtureModel</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dims_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dims_c</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/gaussian_mixture.html#GaussianMixtureModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id125" title="Permalink to this definition">¶</a></dt>
<dd><p>An invertible Gaussian mixture model. The weights, means, covariance
parameterization and component index must be supplied as conditional inputs
to the module and can come from an external feed-forward network, which may
be trained by backpropagating through the GMM. Weights should first be
normalized via GaussianMixtureModel.normalize_weights(w) and component
indices can be sampled via GaussianMixtureModel.pick_mixture_component(w).
If component indices are specified, the model reduces to that Gaussian
mixture component and maps between data x and standard normal latent
variable z. Components can also be chosen consistently at random, by
supplying an integer random seed instead of indices. If a None value is
supplied instead of indices, the model maps between K data points x and K
latent codes z simultaneously, where K is the number of mixture components.
Mathematical derivations are found in the technical report “Training Mixture
Density Networks with full covariance matrices” on arXiv.</p>
<dl class="py attribute">
<dt id="FrEIA.modules.GaussianMixtureModel.__annotations__">
<code class="sig-name descname"><span class="pre">__annotations__</span></code><em class="property"> <span class="pre">=</span> <span class="pre">{'__call__':</span> <span class="pre">typing.Callable[...,</span> <span class="pre">typing.Any],</span> <span class="pre">'_version':</span> <span class="pre">&lt;class</span> <span class="pre">'int'&gt;,</span> <span class="pre">'dump_patches':</span> <span class="pre">&lt;class</span> <span class="pre">'bool'&gt;,</span> <span class="pre">'forward':</span> <span class="pre">typing.Callable[...,</span> <span class="pre">typing.Any],</span> <span class="pre">'training':</span> <span class="pre">&lt;class</span> <span class="pre">'bool'&gt;}</span></em><a class="headerlink" href="#FrEIA.modules.GaussianMixtureModel.__annotations__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="id126">
<code class="sig-name descname"><span class="pre">__init__</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dims_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dims_c</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/gaussian_mixture.html#GaussianMixtureModel.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id126" title="Permalink to this definition">¶</a></dt>
<dd><p>Parameters:
dims_in: list of tuples specifying the shape of the inputs to this</p>
<blockquote>
<div><p>operator: dims_in = [shape_x_0, shape_x_1, …]</p>
</div></blockquote>
<dl class="simple">
<dt>dims_c:  list of tuples specifying the shape of the conditions to</dt><dd><p>this operator.</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="id127">
<code class="sig-name descname"><span class="pre">__module__</span></code><em class="property"> <span class="pre">=</span> <span class="pre">'FrEIA.modules.gaussian_mixture'</span></em><a class="headerlink" href="#id127" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="id128">
<code class="sig-name descname"><span class="pre">forward</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jac</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/gaussian_mixture.html#GaussianMixtureModel.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id128" title="Permalink to this definition">¶</a></dt>
<dd><p>Map between data distribution and standard normal latent distribution
of mixture components or entire mixture, in an invertible way.</p>
<dl class="simple">
<dt>x:  Data during forward pass or latent codes during backward pass. Size</dt><dd><p>must be [batch_size, n_dims] if component indices i are specified
and should be [batch_size, n_components, n_dims] if not.</p>
</dd>
</dl>
<p>The conditional input c must be a list [w, mu, U, i] of parameters for
the Gaussian mixture model with the following properties:</p>
<dl class="simple">
<dt>w:  Weights of the mixture components, must be positive and sum to one</dt><dd><p>and have size [batch_size, n_components].</p>
</dd>
<dt>mu: Means of the mixture components, must have size [batch_size,</dt><dd><p>n_components, n_dims].</p>
</dd>
<dt>U:  Entries for the (upper triangular) Cholesky factors for the</dt><dd><p>precision matrices of the mixture components. These are needed to
parameterize the covariance of the mixture components and must have
size [batch_size, n_components, n_dims * (n_dims + 1) / 2].</p>
</dd>
<dt>i:  Tensor of component indices (size [batch_size]), or a single integer</dt><dd><p>to be used as random number generator seed for component selection,
or None to indicate that all mixture components are modelled.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="id129">
<em class="property"><span class="pre">static</span> </em><code class="sig-name descname"><span class="pre">nll_loss</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">w</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_jacobian</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/gaussian_mixture.html#GaussianMixtureModel.nll_loss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id129" title="Permalink to this definition">¶</a></dt>
<dd><p>Negative log-likelihood loss for training a Mixture Density Network.</p>
<dl class="simple">
<dt>w:              Mixture component weights, must be positive and sum to</dt><dd><p>one. Tensor must be of size [batch_size, n_components].</p>
</dd>
<dt>z:              Latent codes for all mixture components. Tensor must be</dt><dd><p>of size [batch, n_components, n_dims].</p>
</dd>
<dt>log_jacobian:   Jacobian log-determinants for each precision matrix.</dt><dd><p>Tensor size must be [batch_size, n_components].</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="id130">
<em class="property"><span class="pre">static</span> </em><code class="sig-name descname"><span class="pre">nll_upper_bound</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">w</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_jacobian</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/gaussian_mixture.html#GaussianMixtureModel.nll_upper_bound"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id130" title="Permalink to this definition">¶</a></dt>
<dd><p>Numerically more stable upper bound of the negative log-likelihood
loss for training a Mixture Density Network.</p>
<dl class="simple">
<dt>w:              Mixture component weights, must be positive and sum to</dt><dd><p>one. Tensor must be of size [batch_size, n_components].</p>
</dd>
<dt>z:              Latent codes for all mixture components. Tensor must be</dt><dd><p>of size [batch, n_components, n_dims].</p>
</dd>
<dt>log_jacobian:   Jacobian log-determinants for each precision matrix.</dt><dd><p>Tensor size must be [batch_size, n_components].</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="id131">
<em class="property"><span class="pre">static</span> </em><code class="sig-name descname"><span class="pre">normalize_weights</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">w</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/gaussian_mixture.html#GaussianMixtureModel.normalize_weights"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id131" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply softmax to ensure component weights are positive and sum to
one. Works on batches of component weights.</p>
<dl class="simple">
<dt>w:  Unnormalized weights for Gaussian mixture components, must be of</dt><dd><p>size [batch_size, n_components]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="id132">
<code class="sig-name descname"><span class="pre">output_dims</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_dims</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/gaussian_mixture.html#GaussianMixtureModel.output_dims"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id132" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="id133">
<em class="property"><span class="pre">static</span> </em><code class="sig-name descname"><span class="pre">pick_mixture_component</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">w</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/gaussian_mixture.html#GaussianMixtureModel.pick_mixture_component"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id133" title="Permalink to this definition">¶</a></dt>
<dd><p>Randomly choose mixture component indices with probability given by
the component weights w. Works on batches of component weights.</p>
<p>w:      Weights of the mixture components, must be positive and sum to one
seed:   Optional RNG seed for consistent decisions</p>
</dd></dl>

<dl class="py attribute">
<dt id="id134">
<code class="sig-name descname"><span class="pre">training</span></code><em class="property"><span class="pre">:</span> <span class="pre">bool</span></em><a class="headerlink" href="#id134" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="fixed-non-learned-transforms">
<h2>Fixed (non-learned) transforms<a class="headerlink" href="#fixed-non-learned-transforms" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="id135">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">FrEIA.modules.</span></code><code class="sig-name descname"><span class="pre">PermuteRandom</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dims_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dims_c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/fixed_transforms.html#PermuteRandom"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id135" title="Permalink to this definition">¶</a></dt>
<dd><p>permutes input vector in a random but fixed way</p>
<dl class="py attribute">
<dt id="FrEIA.modules.PermuteRandom.__annotations__">
<code class="sig-name descname"><span class="pre">__annotations__</span></code><em class="property"> <span class="pre">=</span> <span class="pre">{'__call__':</span> <span class="pre">typing.Callable[...,</span> <span class="pre">typing.Any],</span> <span class="pre">'_version':</span> <span class="pre">&lt;class</span> <span class="pre">'int'&gt;,</span> <span class="pre">'dump_patches':</span> <span class="pre">&lt;class</span> <span class="pre">'bool'&gt;,</span> <span class="pre">'forward':</span> <span class="pre">typing.Callable[...,</span> <span class="pre">typing.Any],</span> <span class="pre">'training':</span> <span class="pre">&lt;class</span> <span class="pre">'bool'&gt;}</span></em><a class="headerlink" href="#FrEIA.modules.PermuteRandom.__annotations__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="id136">
<code class="sig-name descname"><span class="pre">__init__</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dims_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dims_c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/fixed_transforms.html#PermuteRandom.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id136" title="Permalink to this definition">¶</a></dt>
<dd><p>Parameters:
dims_in: list of tuples specifying the shape of the inputs to this</p>
<blockquote>
<div><p>operator: dims_in = [shape_x_0, shape_x_1, …]</p>
</div></blockquote>
<dl class="simple">
<dt>dims_c:  list of tuples specifying the shape of the conditions to</dt><dd><p>this operator.</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="id137">
<code class="sig-name descname"><span class="pre">__module__</span></code><em class="property"> <span class="pre">=</span> <span class="pre">'FrEIA.modules.fixed_transforms'</span></em><a class="headerlink" href="#id137" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="id138">
<code class="sig-name descname"><span class="pre">forward</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jac</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/fixed_transforms.html#PermuteRandom.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id138" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform a forward (default, <cite>rev=False</cite>) or backward pass (<cite>rev=True</cite>)
through this module/operator.</p>
<p><em>Note to implementers:</em>
- Subclasses MUST return a Jacobian when jac=True, but CAN return a</p>
<blockquote>
<div><p>valid Jacobian when jac=False (not punished). The latter is only recommended
if the computation of the Jacobian is trivial.</p>
</div></blockquote>
<ul class="simple">
<li><p>Subclasses MUST follow the convention that the returned Jacobian be
consistent with the evaluation direction. Let’s make this more precise:
Let $f$ be the function that the subclass represents. Then:
$$$
J = log det</p></li>
</ul>
<dl class="simple">
<dt>rac{partial f}{partial x} </dt><dd><p>-J = log det</p>
</dd>
<dt>rac{partial f^{-1}}{partial z}.</dt><dd><p>$$$
Any subclass MUST return $J$ for forward evaluation (<cite>rev=False</cite>),
and $-J$ for backward evaluation (<cite>rev=True</cite>).</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x_or_z</strong> – input data (array-like of one or more tensors)</p></li>
<li><p><strong>c</strong> – conditioning data (array-like of none or more tensors)</p></li>
<li><p><strong>rev</strong> – perform backward pass</p></li>
<li><p><strong>jac</strong> – return Jacobian associated to the direction</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="id139">
<code class="sig-name descname"><span class="pre">output_dims</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_dims</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/fixed_transforms.html#PermuteRandom.output_dims"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id139" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="id140">
<code class="sig-name descname"><span class="pre">training</span></code><em class="property"><span class="pre">:</span> <span class="pre">bool</span></em><a class="headerlink" href="#id140" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="id141">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">FrEIA.modules.</span></code><code class="sig-name descname"><span class="pre">FixedLinearTransform</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dims_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dims_c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">M</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/fixed_transforms.html#FixedLinearTransform"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id141" title="Permalink to this definition">¶</a></dt>
<dd><p>Fixed transformation according to y = Mx + b, with invertible
matrix M.</p>
<dl class="py attribute">
<dt id="FrEIA.modules.FixedLinearTransform.__annotations__">
<code class="sig-name descname"><span class="pre">__annotations__</span></code><em class="property"> <span class="pre">=</span> <span class="pre">{'__call__':</span> <span class="pre">typing.Callable[...,</span> <span class="pre">typing.Any],</span> <span class="pre">'_version':</span> <span class="pre">&lt;class</span> <span class="pre">'int'&gt;,</span> <span class="pre">'dump_patches':</span> <span class="pre">&lt;class</span> <span class="pre">'bool'&gt;,</span> <span class="pre">'forward':</span> <span class="pre">typing.Callable[...,</span> <span class="pre">typing.Any],</span> <span class="pre">'training':</span> <span class="pre">&lt;class</span> <span class="pre">'bool'&gt;}</span></em><a class="headerlink" href="#FrEIA.modules.FixedLinearTransform.__annotations__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="id142">
<code class="sig-name descname"><span class="pre">__init__</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dims_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dims_c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">M</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/fixed_transforms.html#FixedLinearTransform.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id142" title="Permalink to this definition">¶</a></dt>
<dd><p>Parameters:
dims_in: list of tuples specifying the shape of the inputs to this</p>
<blockquote>
<div><p>operator: dims_in = [shape_x_0, shape_x_1, …]</p>
</div></blockquote>
<dl class="simple">
<dt>dims_c:  list of tuples specifying the shape of the conditions to</dt><dd><p>this operator.</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="id143">
<code class="sig-name descname"><span class="pre">__module__</span></code><em class="property"> <span class="pre">=</span> <span class="pre">'FrEIA.modules.fixed_transforms'</span></em><a class="headerlink" href="#id143" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="id144">
<code class="sig-name descname"><span class="pre">forward</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jac</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/fixed_transforms.html#FixedLinearTransform.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id144" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform a forward (default, <cite>rev=False</cite>) or backward pass (<cite>rev=True</cite>)
through this module/operator.</p>
<p><em>Note to implementers:</em>
- Subclasses MUST return a Jacobian when jac=True, but CAN return a</p>
<blockquote>
<div><p>valid Jacobian when jac=False (not punished). The latter is only recommended
if the computation of the Jacobian is trivial.</p>
</div></blockquote>
<ul class="simple">
<li><p>Subclasses MUST follow the convention that the returned Jacobian be
consistent with the evaluation direction. Let’s make this more precise:
Let $f$ be the function that the subclass represents. Then:
$$$
J = log det</p></li>
</ul>
<dl class="simple">
<dt>rac{partial f}{partial x} </dt><dd><p>-J = log det</p>
</dd>
<dt>rac{partial f^{-1}}{partial z}.</dt><dd><p>$$$
Any subclass MUST return $J$ for forward evaluation (<cite>rev=False</cite>),
and $-J$ for backward evaluation (<cite>rev=True</cite>).</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x_or_z</strong> – input data (array-like of one or more tensors)</p></li>
<li><p><strong>c</strong> – conditioning data (array-like of none or more tensors)</p></li>
<li><p><strong>rev</strong> – perform backward pass</p></li>
<li><p><strong>jac</strong> – return Jacobian associated to the direction</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="id145">
<code class="sig-name descname"><span class="pre">output_dims</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_dims</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/fixed_transforms.html#FixedLinearTransform.output_dims"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id145" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="id146">
<code class="sig-name descname"><span class="pre">training</span></code><em class="property"><span class="pre">:</span> <span class="pre">bool</span></em><a class="headerlink" href="#id146" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="id147">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">FrEIA.modules.</span></code><code class="sig-name descname"><span class="pre">Fixed1x1Conv</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dims_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dims_c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">M</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/fixed_transforms.html#Fixed1x1Conv"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id147" title="Permalink to this definition">¶</a></dt>
<dd><p>Fixed 1x1 conv transformation with matrix M.</p>
<dl class="py attribute">
<dt id="FrEIA.modules.Fixed1x1Conv.__annotations__">
<code class="sig-name descname"><span class="pre">__annotations__</span></code><em class="property"> <span class="pre">=</span> <span class="pre">{'__call__':</span> <span class="pre">typing.Callable[...,</span> <span class="pre">typing.Any],</span> <span class="pre">'_version':</span> <span class="pre">&lt;class</span> <span class="pre">'int'&gt;,</span> <span class="pre">'dump_patches':</span> <span class="pre">&lt;class</span> <span class="pre">'bool'&gt;,</span> <span class="pre">'forward':</span> <span class="pre">typing.Callable[...,</span> <span class="pre">typing.Any],</span> <span class="pre">'training':</span> <span class="pre">&lt;class</span> <span class="pre">'bool'&gt;}</span></em><a class="headerlink" href="#FrEIA.modules.Fixed1x1Conv.__annotations__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="id148">
<code class="sig-name descname"><span class="pre">__init__</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dims_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dims_c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">M</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/fixed_transforms.html#Fixed1x1Conv.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id148" title="Permalink to this definition">¶</a></dt>
<dd><p>Parameters:
dims_in: list of tuples specifying the shape of the inputs to this</p>
<blockquote>
<div><p>operator: dims_in = [shape_x_0, shape_x_1, …]</p>
</div></blockquote>
<dl class="simple">
<dt>dims_c:  list of tuples specifying the shape of the conditions to</dt><dd><p>this operator.</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="id149">
<code class="sig-name descname"><span class="pre">__module__</span></code><em class="property"> <span class="pre">=</span> <span class="pre">'FrEIA.modules.fixed_transforms'</span></em><a class="headerlink" href="#id149" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="id150">
<code class="sig-name descname"><span class="pre">forward</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jac</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/fixed_transforms.html#Fixed1x1Conv.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id150" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform a forward (default, <cite>rev=False</cite>) or backward pass (<cite>rev=True</cite>)
through this module/operator.</p>
<p><em>Note to implementers:</em>
- Subclasses MUST return a Jacobian when jac=True, but CAN return a</p>
<blockquote>
<div><p>valid Jacobian when jac=False (not punished). The latter is only recommended
if the computation of the Jacobian is trivial.</p>
</div></blockquote>
<ul class="simple">
<li><p>Subclasses MUST follow the convention that the returned Jacobian be
consistent with the evaluation direction. Let’s make this more precise:
Let $f$ be the function that the subclass represents. Then:
$$$
J = log det</p></li>
</ul>
<dl class="simple">
<dt>rac{partial f}{partial x} </dt><dd><p>-J = log det</p>
</dd>
<dt>rac{partial f^{-1}}{partial z}.</dt><dd><p>$$$
Any subclass MUST return $J$ for forward evaluation (<cite>rev=False</cite>),
and $-J$ for backward evaluation (<cite>rev=True</cite>).</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x_or_z</strong> – input data (array-like of one or more tensors)</p></li>
<li><p><strong>c</strong> – conditioning data (array-like of none or more tensors)</p></li>
<li><p><strong>rev</strong> – perform backward pass</p></li>
<li><p><strong>jac</strong> – return Jacobian associated to the direction</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="id151">
<code class="sig-name descname"><span class="pre">output_dims</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_dims</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/fixed_transforms.html#Fixed1x1Conv.output_dims"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id151" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="id152">
<code class="sig-name descname"><span class="pre">training</span></code><em class="property"><span class="pre">:</span> <span class="pre">bool</span></em><a class="headerlink" href="#id152" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="graph-topology">
<h2>Graph topology<a class="headerlink" href="#graph-topology" title="Permalink to this headline">¶</a></h2>
<dl class="py attribute">
<dt id="id153">
<code class="sig-prename descclassname"><span class="pre">FrEIA.modules.</span></code><code class="sig-name descname"><span class="pre">SplitChannel</span></code><a class="headerlink" href="#id153" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of <code class="xref py py-class docutils literal notranslate"><span class="pre">FrEIA.modules.graph_topology._deprecated_by.&lt;locals&gt;.deprecated_class</span></code></p>
</dd></dl>

<dl class="py attribute">
<dt id="id154">
<code class="sig-prename descclassname"><span class="pre">FrEIA.modules.</span></code><code class="sig-name descname"><span class="pre">ConcatChannel</span></code><a class="headerlink" href="#id154" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of <code class="xref py py-class docutils literal notranslate"><span class="pre">FrEIA.modules.graph_topology._deprecated_by.&lt;locals&gt;.deprecated_class</span></code></p>
</dd></dl>

<dl class="py class">
<dt id="id155">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">FrEIA.modules.</span></code><code class="sig-name descname"><span class="pre">Split</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dims_in</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">section_sizes</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span> </span><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_sections</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/graph_topology.html#Split"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id155" title="Permalink to this definition">¶</a></dt>
<dd><p>Invertible split operation.</p>
<p>Splits the incoming tensor along the given dimension, and returns a list of
separate output tensors. The inverse is the corresponding merge operation.</p>
<dl class="py attribute">
<dt id="id156">
<code class="sig-name descname"><span class="pre">dims_in</span></code><a class="headerlink" href="#id156" title="Permalink to this definition">¶</a></dt>
<dd><p>A list of tuples containing the non-batch dimensionality of all
incoming tensors. Handled automatically during compute graph setup.
Split only takes one input tensor.</p>
</dd></dl>

<dl class="py attribute">
<dt id="id157">
<code class="sig-name descname"><span class="pre">section_sizes</span></code><a class="headerlink" href="#id157" title="Permalink to this definition">¶</a></dt>
<dd><p>If set, takes precedence over ‘n_sections’ and behaves like the
argument in torch.split(), except when a list of section sizes is given
that doesn’t add up to the size of ‘dim’, an additional split section is
created to take the slack. Defaults to None.</p>
</dd></dl>

<dl class="py attribute">
<dt id="id158">
<code class="sig-name descname"><span class="pre">n_sections</span></code><a class="headerlink" href="#id158" title="Permalink to this definition">¶</a></dt>
<dd><p>If ‘section_sizes’ is None, the tensor is split into ‘n_sections’
parts of equal size or close to it. This mode behaves like
numpy.array_split(). Defaults to 2, i.e. splitting the data into two
equal halves.</p>
</dd></dl>

<dl class="py attribute">
<dt id="id159">
<code class="sig-name descname"><span class="pre">dim</span></code><a class="headerlink" href="#id159" title="Permalink to this definition">¶</a></dt>
<dd><p>Index of the dimension along which to split, not counting the batch
dimension. Defaults to 0, i.e. the channel dimension in structured data.</p>
</dd></dl>

<dl class="py attribute">
<dt id="FrEIA.modules.Split.__annotations__">
<code class="sig-name descname"><span class="pre">__annotations__</span></code><em class="property"> <span class="pre">=</span> <span class="pre">{'__call__':</span> <span class="pre">typing.Callable[...,</span> <span class="pre">typing.Any],</span> <span class="pre">'_version':</span> <span class="pre">&lt;class</span> <span class="pre">'int'&gt;,</span> <span class="pre">'dump_patches':</span> <span class="pre">&lt;class</span> <span class="pre">'bool'&gt;,</span> <span class="pre">'forward':</span> <span class="pre">typing.Callable[...,</span> <span class="pre">typing.Any],</span> <span class="pre">'training':</span> <span class="pre">&lt;class</span> <span class="pre">'bool'&gt;}</span></em><a class="headerlink" href="#FrEIA.modules.Split.__annotations__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="id160">
<code class="sig-name descname"><span class="pre">__init__</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dims_in</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">section_sizes</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span> </span><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_sections</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/graph_topology.html#Split.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id160" title="Permalink to this definition">¶</a></dt>
<dd><p>Inits the Split module with the attributes described above and
checks that split sizes and dimensionality are compatible.</p>
</dd></dl>

<dl class="py attribute">
<dt id="id161">
<code class="sig-name descname"><span class="pre">__module__</span></code><em class="property"> <span class="pre">=</span> <span class="pre">'FrEIA.modules.graph_topology'</span></em><a class="headerlink" href="#id161" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="id162">
<code class="sig-name descname"><span class="pre">forward</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jac</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/graph_topology.html#Split.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id162" title="Permalink to this definition">¶</a></dt>
<dd><p>See super class InvertibleModule.
Jacobian log-det of splitting is always zero.</p>
</dd></dl>

<dl class="py method">
<dt id="id163">
<code class="sig-name descname"><span class="pre">output_dims</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_dims</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/graph_topology.html#Split.output_dims"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id163" title="Permalink to this definition">¶</a></dt>
<dd><p>See super class InvertibleModule.</p>
</dd></dl>

<dl class="py attribute">
<dt id="id164">
<code class="sig-name descname"><span class="pre">training</span></code><em class="property"><span class="pre">:</span> <span class="pre">bool</span></em><a class="headerlink" href="#id164" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="id165">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">FrEIA.modules.</span></code><code class="sig-name descname"><span class="pre">Concat</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dims_in</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/graph_topology.html#Concat"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id165" title="Permalink to this definition">¶</a></dt>
<dd><p>Invertible merge operation.</p>
<p>Concatenates a list of incoming tensors along a given dimension and passes
on the result. Inverse is the corresponding split operation.</p>
<dl class="py attribute">
<dt id="id166">
<code class="sig-name descname"><span class="pre">dims_in</span></code><a class="headerlink" href="#id166" title="Permalink to this definition">¶</a></dt>
<dd><p>A list of tuples containing the non-batch dimensionality of all
incoming tensors. Handled automatically during compute graph setup.
Dimensionality of incoming tensors must be identical, except in the
merge dimension <cite>dim</cite>. Concat only makes sense with multiple input
tensors.</p>
</dd></dl>

<dl class="py attribute">
<dt id="id167">
<code class="sig-name descname"><span class="pre">dim</span></code><a class="headerlink" href="#id167" title="Permalink to this definition">¶</a></dt>
<dd><p>Index of the dimension along which to concatenate, not counting the
batch dimension. Defaults to 0, i.e. the channel dimension in structured
data.</p>
</dd></dl>

<dl class="py attribute">
<dt id="FrEIA.modules.Concat.__annotations__">
<code class="sig-name descname"><span class="pre">__annotations__</span></code><em class="property"> <span class="pre">=</span> <span class="pre">{'__call__':</span> <span class="pre">typing.Callable[...,</span> <span class="pre">typing.Any],</span> <span class="pre">'_version':</span> <span class="pre">&lt;class</span> <span class="pre">'int'&gt;,</span> <span class="pre">'dump_patches':</span> <span class="pre">&lt;class</span> <span class="pre">'bool'&gt;,</span> <span class="pre">'forward':</span> <span class="pre">typing.Callable[...,</span> <span class="pre">typing.Any],</span> <span class="pre">'training':</span> <span class="pre">&lt;class</span> <span class="pre">'bool'&gt;}</span></em><a class="headerlink" href="#FrEIA.modules.Concat.__annotations__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="id168">
<code class="sig-name descname"><span class="pre">__init__</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dims_in</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/graph_topology.html#Concat.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id168" title="Permalink to this definition">¶</a></dt>
<dd><p>Inits the Concat module with the attributes described above and
checks that all dimensions are compatible.</p>
</dd></dl>

<dl class="py attribute">
<dt id="id169">
<code class="sig-name descname"><span class="pre">__module__</span></code><em class="property"> <span class="pre">=</span> <span class="pre">'FrEIA.modules.graph_topology'</span></em><a class="headerlink" href="#id169" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="id170">
<code class="sig-name descname"><span class="pre">forward</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jac</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/graph_topology.html#Concat.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id170" title="Permalink to this definition">¶</a></dt>
<dd><p>See super class InvertibleModule.
Jacobian log-det of concatenation is always zero.</p>
</dd></dl>

<dl class="py method">
<dt id="id171">
<code class="sig-name descname"><span class="pre">output_dims</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_dims</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/graph_topology.html#Concat.output_dims"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id171" title="Permalink to this definition">¶</a></dt>
<dd><p>See super class InvertibleModule.</p>
</dd></dl>

<dl class="py attribute">
<dt id="id172">
<code class="sig-name descname"><span class="pre">training</span></code><em class="property"><span class="pre">:</span> <span class="pre">bool</span></em><a class="headerlink" href="#id172" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="reshaping">
<h2>Reshaping<a class="headerlink" href="#reshaping" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="id173">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">FrEIA.modules.</span></code><code class="sig-name descname"><span class="pre">IRevNetDownsampling</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dims_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dims_c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">legacy_backend</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/reshapes.html#IRevNetDownsampling"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id173" title="Permalink to this definition">¶</a></dt>
<dd><p>The invertible spatial downsampling used in i-RevNet.
Each group of four neighboring pixels is reordered into one pixel with four times
the channels in a checkerboard-like pattern. See i-RevNet, Jacobsen 2018 et al.</p>
<dl class="py attribute">
<dt id="FrEIA.modules.IRevNetDownsampling.__annotations__">
<code class="sig-name descname"><span class="pre">__annotations__</span></code><em class="property"> <span class="pre">=</span> <span class="pre">{'__call__':</span> <span class="pre">typing.Callable[...,</span> <span class="pre">typing.Any],</span> <span class="pre">'_version':</span> <span class="pre">&lt;class</span> <span class="pre">'int'&gt;,</span> <span class="pre">'dump_patches':</span> <span class="pre">&lt;class</span> <span class="pre">'bool'&gt;,</span> <span class="pre">'forward':</span> <span class="pre">typing.Callable[...,</span> <span class="pre">typing.Any],</span> <span class="pre">'training':</span> <span class="pre">&lt;class</span> <span class="pre">'bool'&gt;}</span></em><a class="headerlink" href="#FrEIA.modules.IRevNetDownsampling.__annotations__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="id174">
<code class="sig-name descname"><span class="pre">__init__</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dims_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dims_c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">legacy_backend</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/reshapes.html#IRevNetDownsampling.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id174" title="Permalink to this definition">¶</a></dt>
<dd><p>See docstring of base class (FrEIA.modules.InvertibleModule) for more.
:param legacy_backend: If True, uses the splitting and concatenating method,</p>
<blockquote>
<div><p>adapted from
github.com/jhjacobsen/pytorch-i-revnet/blob/master/models/model_utils.py
for the use in FrEIA. Is usually slower on GPU.
If False, uses a 2d strided convolution with a kernel representing
the downsampling.  Note that the ordering of the output channels
will be different.  If pixels in each patch in channel 1
are a1, b1, …, and in channel 2 are a2, b2, …
Then the output channels will be the following:
legacy_backend=True: a1, a2, …, b1, b2, …, c1, c2, …
legacy_backend=False: a1, b1, …, a2, b2, …, a3, b3, …
(see also order_by_wavelet in module HaarDownsampling)
Usually this difference is completely irrelevant.</p>
</div></blockquote>
</dd></dl>

<dl class="py attribute">
<dt id="id175">
<code class="sig-name descname"><span class="pre">__module__</span></code><em class="property"> <span class="pre">=</span> <span class="pre">'FrEIA.modules.reshapes'</span></em><a class="headerlink" href="#id175" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="id176">
<code class="sig-name descname"><span class="pre">forward</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jac</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/reshapes.html#IRevNetDownsampling.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id176" title="Permalink to this definition">¶</a></dt>
<dd><p>See docstring of base class (FrEIA.modules.InvertibleModule).</p>
</dd></dl>

<dl class="py method">
<dt id="id177">
<code class="sig-name descname"><span class="pre">output_dims</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_dims</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/reshapes.html#IRevNetDownsampling.output_dims"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id177" title="Permalink to this definition">¶</a></dt>
<dd><p>See docstring of base class (FrEIA.modules.InvertibleModule).</p>
</dd></dl>

<dl class="py attribute">
<dt id="id178">
<code class="sig-name descname"><span class="pre">training</span></code><em class="property"><span class="pre">:</span> <span class="pre">bool</span></em><a class="headerlink" href="#id178" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="id179">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">FrEIA.modules.</span></code><code class="sig-name descname"><span class="pre">IRevNetUpsampling</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dims_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dims_c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">legacy_backend</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/reshapes.html#IRevNetUpsampling"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id179" title="Permalink to this definition">¶</a></dt>
<dd><p>The inverted operation of IRevNetDownsampling (see that docstring for details).</p>
<dl class="py attribute">
<dt id="FrEIA.modules.IRevNetUpsampling.__annotations__">
<code class="sig-name descname"><span class="pre">__annotations__</span></code><em class="property"> <span class="pre">=</span> <span class="pre">{'__call__':</span> <span class="pre">typing.Callable[...,</span> <span class="pre">typing.Any],</span> <span class="pre">'_version':</span> <span class="pre">&lt;class</span> <span class="pre">'int'&gt;,</span> <span class="pre">'dump_patches':</span> <span class="pre">&lt;class</span> <span class="pre">'bool'&gt;,</span> <span class="pre">'forward':</span> <span class="pre">typing.Callable[...,</span> <span class="pre">typing.Any],</span> <span class="pre">'training':</span> <span class="pre">&lt;class</span> <span class="pre">'bool'&gt;}</span></em><a class="headerlink" href="#FrEIA.modules.IRevNetUpsampling.__annotations__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="id180">
<code class="sig-name descname"><span class="pre">__init__</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dims_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dims_c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">legacy_backend</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/reshapes.html#IRevNetUpsampling.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id180" title="Permalink to this definition">¶</a></dt>
<dd><p>See docstring of base class (FrEIA.modules.InvertibleModule) for more.
:param legacy_backend: If True, uses the splitting and concatenating method,</p>
<blockquote>
<div><p>adapted from
github.com/jhjacobsen/pytorch-i-revnet/blob/master/models/model_utils.py
for the use in FrEIA. Is usually slower on GPU.
If False, uses a 2d strided convolution with a kernel representing
the downsampling.  Note that the ordering of the output channels
will be different.  If pixels in each patch in channel 1
are a1, b1, …, and in channel 2 are a2, b2, …
Then the output channels will be the following:
legacy_backend=True: a1, a2, …, b1, b2, …, c1, c2, …
legacy_backend=False: a1, b1, …, a2, b2, …, a3, b3, …
(see also order_by_wavelet in module HaarDownsampling)
Usually this difference is completely irrelevant.</p>
</div></blockquote>
</dd></dl>

<dl class="py attribute">
<dt id="id181">
<code class="sig-name descname"><span class="pre">__module__</span></code><em class="property"> <span class="pre">=</span> <span class="pre">'FrEIA.modules.reshapes'</span></em><a class="headerlink" href="#id181" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="id182">
<code class="sig-name descname"><span class="pre">forward</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jac</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/reshapes.html#IRevNetUpsampling.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id182" title="Permalink to this definition">¶</a></dt>
<dd><p>See docstring of base class (FrEIA.modules.InvertibleModule).</p>
</dd></dl>

<dl class="py method">
<dt id="id183">
<code class="sig-name descname"><span class="pre">output_dims</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_dims</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/reshapes.html#IRevNetUpsampling.output_dims"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id183" title="Permalink to this definition">¶</a></dt>
<dd><p>See docstring of base class (FrEIA.modules.InvertibleModule).</p>
</dd></dl>

<dl class="py attribute">
<dt id="id184">
<code class="sig-name descname"><span class="pre">training</span></code><em class="property"><span class="pre">:</span> <span class="pre">bool</span></em><a class="headerlink" href="#id184" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="id185">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">FrEIA.modules.</span></code><code class="sig-name descname"><span class="pre">HaarDownsampling</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dims_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dims_c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order_by_wavelet</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rebalance</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/reshapes.html#HaarDownsampling"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id185" title="Permalink to this definition">¶</a></dt>
<dd><p>Uses Haar wavelets to split each channel into 4 channels, with half the
width and height dimensions.</p>
<dl class="py attribute">
<dt id="FrEIA.modules.HaarDownsampling.__annotations__">
<code class="sig-name descname"><span class="pre">__annotations__</span></code><em class="property"> <span class="pre">=</span> <span class="pre">{'__call__':</span> <span class="pre">typing.Callable[...,</span> <span class="pre">typing.Any],</span> <span class="pre">'_version':</span> <span class="pre">&lt;class</span> <span class="pre">'int'&gt;,</span> <span class="pre">'dump_patches':</span> <span class="pre">&lt;class</span> <span class="pre">'bool'&gt;,</span> <span class="pre">'forward':</span> <span class="pre">typing.Callable[...,</span> <span class="pre">typing.Any],</span> <span class="pre">'training':</span> <span class="pre">&lt;class</span> <span class="pre">'bool'&gt;}</span></em><a class="headerlink" href="#FrEIA.modules.HaarDownsampling.__annotations__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="id186">
<code class="sig-name descname"><span class="pre">__init__</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dims_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dims_c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order_by_wavelet</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rebalance</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/reshapes.html#HaarDownsampling.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id186" title="Permalink to this definition">¶</a></dt>
<dd><p>See docstring of base class (FrEIA.modules.InvertibleModule) for more.
:param order_by_wavelet: Whether to group the output by original channels or</p>
<blockquote>
<div><p>by wavelet. E.g. if the average, vertical, horizontal and diagonal
wavelets for channel 1 are a1, v1, h1, d1, those for channel 2 are
a2, v2, h2, d2, etc, then the output channels will be structured as
follows:
set to True: a1, a2, …, v1, v2, …, h1, h2, …, d1, d2, …
set to False: a1, v1, h1, d1, a2, v2, h2, d2, …
The True option is slightly slower to compute than the False option.
The option is useful if e.g. the average channels should be split
off by a FrEIA.modules.Split. Then, setting order_by_wavelet=True
allows to split off the first quarter of channels to isolate the
average wavelets only.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>rebalance</strong> – Must !=0. There exist different conventions how to define
the Haar wavelets. The wavelet components in the forward direction
are multiplied with this factor, and those in the inverse direction
are adjusted accordingly, so that the module as a whole is
invertible.  Stability of the network may be increased for rebalance
&lt; 1 (e.g. 0.5).</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="id187">
<code class="sig-name descname"><span class="pre">__module__</span></code><em class="property"> <span class="pre">=</span> <span class="pre">'FrEIA.modules.reshapes'</span></em><a class="headerlink" href="#id187" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="id188">
<code class="sig-name descname"><span class="pre">forward</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jac</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/reshapes.html#HaarDownsampling.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id188" title="Permalink to this definition">¶</a></dt>
<dd><p>See docstring of base class (FrEIA.modules.InvertibleModule).</p>
</dd></dl>

<dl class="py method">
<dt id="id189">
<code class="sig-name descname"><span class="pre">output_dims</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_dims</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/reshapes.html#HaarDownsampling.output_dims"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id189" title="Permalink to this definition">¶</a></dt>
<dd><p>See docstring of base class (FrEIA.modules.InvertibleModule).</p>
</dd></dl>

<dl class="py attribute">
<dt id="id190">
<code class="sig-name descname"><span class="pre">training</span></code><em class="property"><span class="pre">:</span> <span class="pre">bool</span></em><a class="headerlink" href="#id190" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="id191">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">FrEIA.modules.</span></code><code class="sig-name descname"><span class="pre">Flatten</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dims_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dims_c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/reshapes.html#Flatten"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id191" title="Permalink to this definition">¶</a></dt>
<dd><p>Flattens N-D tensors into 1-D tensors.</p>
<dl class="py attribute">
<dt id="FrEIA.modules.Flatten.__annotations__">
<code class="sig-name descname"><span class="pre">__annotations__</span></code><em class="property"> <span class="pre">=</span> <span class="pre">{'__call__':</span> <span class="pre">typing.Callable[...,</span> <span class="pre">typing.Any],</span> <span class="pre">'_version':</span> <span class="pre">&lt;class</span> <span class="pre">'int'&gt;,</span> <span class="pre">'dump_patches':</span> <span class="pre">&lt;class</span> <span class="pre">'bool'&gt;,</span> <span class="pre">'forward':</span> <span class="pre">typing.Callable[...,</span> <span class="pre">typing.Any],</span> <span class="pre">'training':</span> <span class="pre">&lt;class</span> <span class="pre">'bool'&gt;}</span></em><a class="headerlink" href="#FrEIA.modules.Flatten.__annotations__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="id192">
<code class="sig-name descname"><span class="pre">__init__</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dims_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dims_c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/reshapes.html#Flatten.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id192" title="Permalink to this definition">¶</a></dt>
<dd><p>See docstring of base class (FrEIA.modules.InvertibleModule).</p>
</dd></dl>

<dl class="py attribute">
<dt id="id193">
<code class="sig-name descname"><span class="pre">__module__</span></code><em class="property"> <span class="pre">=</span> <span class="pre">'FrEIA.modules.reshapes'</span></em><a class="headerlink" href="#id193" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="id194">
<code class="sig-name descname"><span class="pre">forward</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jac</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/reshapes.html#Flatten.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id194" title="Permalink to this definition">¶</a></dt>
<dd><p>See docstring of base class (FrEIA.modules.InvertibleModule).</p>
</dd></dl>

<dl class="py method">
<dt id="id195">
<code class="sig-name descname"><span class="pre">output_dims</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_dims</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/reshapes.html#Flatten.output_dims"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id195" title="Permalink to this definition">¶</a></dt>
<dd><p>See docstring of base class (FrEIA.modules.InvertibleModule).</p>
</dd></dl>

<dl class="py attribute">
<dt id="id196">
<code class="sig-name descname"><span class="pre">training</span></code><em class="property"><span class="pre">:</span> <span class="pre">bool</span></em><a class="headerlink" href="#id196" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="id197">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">FrEIA.modules.</span></code><code class="sig-name descname"><span class="pre">Reshape</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dims_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dims_c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_dims</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Iterable</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/reshapes.html#Reshape"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id197" title="Permalink to this definition">¶</a></dt>
<dd><p>Reshapes N-D tensors into target dim tensors. Note that the reshape resulting from
e.g. (3, 32, 32) -&gt; (12, 16, 16) will not necessarily be spatially sensible.
See IRevNetDownsampling, IRevNetUpsampling, HaarDownsampling, HaarUpsampling
for spatially meaningful reshaping operations.</p>
<dl class="py attribute">
<dt id="FrEIA.modules.Reshape.__annotations__">
<code class="sig-name descname"><span class="pre">__annotations__</span></code><em class="property"> <span class="pre">=</span> <span class="pre">{'__call__':</span> <span class="pre">typing.Callable[...,</span> <span class="pre">typing.Any],</span> <span class="pre">'_version':</span> <span class="pre">&lt;class</span> <span class="pre">'int'&gt;,</span> <span class="pre">'dump_patches':</span> <span class="pre">&lt;class</span> <span class="pre">'bool'&gt;,</span> <span class="pre">'forward':</span> <span class="pre">typing.Callable[...,</span> <span class="pre">typing.Any],</span> <span class="pre">'training':</span> <span class="pre">&lt;class</span> <span class="pre">'bool'&gt;}</span></em><a class="headerlink" href="#FrEIA.modules.Reshape.__annotations__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="id198">
<code class="sig-name descname"><span class="pre">__init__</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dims_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dims_c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_dims</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Iterable</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/reshapes.html#Reshape.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id198" title="Permalink to this definition">¶</a></dt>
<dd><p>See docstring of base class (FrEIA.modules.InvertibleModule) for more.
:param output_dims: The shape the reshaped output is supposed to have (not</p>
<blockquote>
<div><p>including batch dimension)</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>target_dim</strong> – Deprecated name for output_dims</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="id199">
<code class="sig-name descname"><span class="pre">__module__</span></code><em class="property"> <span class="pre">=</span> <span class="pre">'FrEIA.modules.reshapes'</span></em><a class="headerlink" href="#id199" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="id200">
<code class="sig-name descname"><span class="pre">forward</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jac</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/reshapes.html#Reshape.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id200" title="Permalink to this definition">¶</a></dt>
<dd><p>See docstring of base class (FrEIA.modules.InvertibleModule).</p>
</dd></dl>

<dl class="py method">
<dt id="id201">
<code class="sig-name descname"><span class="pre">output_dims</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dim</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/FrEIA/modules/reshapes.html#Reshape.output_dims"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id201" title="Permalink to this definition">¶</a></dt>
<dd><p>See docstring of base class (FrEIA.modules.InvertibleModule).</p>
</dd></dl>

<dl class="py attribute">
<dt id="id202">
<code class="sig-name descname"><span class="pre">training</span></code><em class="property"><span class="pre">:</span> <span class="pre">bool</span></em><a class="headerlink" href="#id202" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
</div>


              </div>
              
              
              <div class='prev-next-bottom'>
                
    <a class='left-prev' id="prev-link" href="FrEIA.framework.html" title="previous page">FrEIA.framework package</a>

              </div>
              
          </main>
          

      </div>
    </div>

    
  <script src="_static/js/index.d3f166471bb80abb5163.js"></script>


    <footer class="footer mt-5 mt-md-0">
  <div class="container">
    <p>
          &copy; Copyright 2021, VLL-HD.<br/>
        Created using <a href="http://sphinx-doc.org/">Sphinx</a> 3.5.0.<br/>
    </p>
  </div>
</footer>
  </body>
</html>